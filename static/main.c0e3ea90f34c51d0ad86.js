!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=42)}([,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__)},function(module,exports,__webpack_require__){(function(){var __WEBPACK_AMD_DEFINE_RESULT__;!function(scope){"use strict";function F(arity,fun,wrapper){return wrapper.a=arity,wrapper.f=fun,wrapper}function F2(fun){return F(2,fun,(function(a){return function(b){return fun(a,b)}}))}function F3(fun){return F(3,fun,(function(a){return function(b){return function(c){return fun(a,b,c)}}}))}function F4(fun){return F(4,fun,(function(a){return function(b){return function(c){return function(d){return fun(a,b,c,d)}}}}))}function F5(fun){return F(5,fun,(function(a){return function(b){return function(c){return function(d){return function(e){return fun(a,b,c,d,e)}}}}}))}function F7(fun){return F(7,fun,(function(a){return function(b){return function(c){return function(d){return function(e){return function(f){return function(g){return fun(a,b,c,d,e,f,g)}}}}}}}))}function A2(fun,a,b){return 2===fun.a?fun.f(a,b):fun(a)(b)}function A3(fun,a,b,c){return 3===fun.a?fun.f(a,b,c):fun(a)(b)(c)}function A4(fun,a,b,c,d){return 4===fun.a?fun.f(a,b,c,d):fun(a)(b)(c)(d)}function A5(fun,a,b,c,d,e){return 5===fun.a?fun.f(a,b,c,d,e):fun(a)(b)(c)(d)(e)}function A7(fun,a,b,c,d,e,f,g){return 7===fun.a?fun.f(a,b,c,d,e,f,g):fun(a)(b)(c)(d)(e)(f)(g)}var _JsArray_initialize=F3((function(size,offset,func){for(var result=Array(size),i=0;size>i;i++)result[i]=func(offset+i);return result})),_JsArray_initializeFromList=F2((function(max,ls){for(var result=Array(max),i=0;max>i&&ls.b;i++)result[i]=ls.a,ls=ls.b;return result.length=i,_Utils_Tuple2(result,ls)})),_JsArray_unsafeGet=F2((function(index,array){return array[index]}));function _Debug_crash(identifier){throw Error("https://github.com/elm/core/blob/1.0.0/hints/"+identifier+".md")}function _Utils_eq(x,y){for(var pair,stack=[],isEqual=_Utils_eqHelp(x,y,0,stack);isEqual&&(pair=stack.pop());isEqual=_Utils_eqHelp(pair.a,pair.b,0,stack));return isEqual}function _Utils_eqHelp(x,y,depth,stack){if(x===y)return!0;if("object"!=typeof x||null===x||null===y)return"function"==typeof x&&_Debug_crash(5),!1;if(depth>100)return stack.push(_Utils_Tuple2(x,y)),!0;for(var key in 0>x.$&&(x=$elm$core$Dict$toList(x),y=$elm$core$Dict$toList(y)),x)if(!_Utils_eqHelp(x[key],y[key],depth+1,stack))return!1;return!0}var _Utils_equal=F2(_Utils_eq),_Utils_notEqual=F2((function(a,b){return!_Utils_eq(a,b)}));function _Utils_cmp(x,y,ord){if("object"!=typeof x)return x===y?0:y>x?-1:1;if(void 0===x.$)return(ord=_Utils_cmp(x.a,y.a))||(ord=_Utils_cmp(x.b,y.b))?ord:_Utils_cmp(x.c,y.c);for(;x.b&&y.b&&!(ord=_Utils_cmp(x.a,y.a));x=x.b,y=y.b);return ord||(x.b?1:y.b?-1:0)}var _Utils_compare=F2((function(x,y){var n=_Utils_cmp(x,y);return 0>n?$elm$core$Basics$LT:n?$elm$core$Basics$GT:$elm$core$Basics$EQ})),_Utils_Tuple0=0;function _Utils_Tuple2(a,b){return{a:a,b:b}}function _Utils_Tuple3(a,b,c){return{a:a,b:b,c:c}}function _Utils_update(oldRecord,updatedFields){var newRecord={};for(var key in oldRecord)newRecord[key]=oldRecord[key];for(var key in updatedFields)newRecord[key]=updatedFields[key];return newRecord}function _Utils_ap(xs,ys){if("string"==typeof xs)return xs+ys;if(!xs.b)return ys;var root=_List_Cons(xs.a,ys);xs=xs.b;for(var curr=root;xs.b;xs=xs.b)curr=curr.b=_List_Cons(xs.a,ys);return root}var _List_Nil={$:0};function _List_Cons(hd,tl){return{$:1,a:hd,b:tl}}var _List_cons=F2(_List_Cons);function _List_fromArray(arr){for(var out=_List_Nil,i=arr.length;i--;)out=_List_Cons(arr[i],out);return out}function _List_toArray(xs){for(var out=[];xs.b;xs=xs.b)out.push(xs.a);return out}var _List_sortBy=F2((function(f,xs){return _List_fromArray(_List_toArray(xs).sort((function(a,b){return _Utils_cmp(f(a),f(b))})))})),_Basics_add=F2((function(a,b){return a+b})),_Basics_modBy=F2((function(modulus,x){var answer=x%modulus;return 0===modulus?_Debug_crash(11):answer>0&&0>modulus||0>answer&&modulus>0?answer+modulus:answer}));var _Basics_ceiling=Math.ceil,_Basics_floor=Math.floor,_Basics_log=Math.log;var _String_split=F2((function(sep,str){return str.split(sep)})),_String_join=F2((function(sep,strs){return strs.join(sep)})),_String_slice=F3((function(start,end,str){return str.slice(start,end)}));var _String_contains=F2((function(sub,str){return str.indexOf(sub)>-1})),_String_startsWith=F2((function(sub,str){return 0===str.indexOf(sub)}));function _Json_decodePrim(decoder){return{$:2,b:decoder}}var _Json_decodeInt=_Json_decodePrim((function(value){return"number"!=typeof value?_Json_expecting("an INT",value):value>-2147483647&&2147483647>value&&(0|value)===value?$elm$core$Result$Ok(value):!isFinite(value)||value%1?_Json_expecting("an INT",value):$elm$core$Result$Ok(value)})),_Json_decodeBool=_Json_decodePrim((function(value){return"boolean"==typeof value?$elm$core$Result$Ok(value):_Json_expecting("a BOOL",value)})),_Json_decodeString=(_Json_decodePrim((function(value){return"number"==typeof value?$elm$core$Result$Ok(value):_Json_expecting("a FLOAT",value)})),_Json_decodePrim((function(value){return $elm$core$Result$Ok(value)})),_Json_decodePrim((function(value){return"string"==typeof value?$elm$core$Result$Ok(value):value instanceof String?$elm$core$Result$Ok(value+""):_Json_expecting("a STRING",value)})));var _Json_decodeField=F2((function(field,decoder){return{$:6,d:field,b:decoder}})),_Json_decodeIndex=F2((function(index,decoder){return{$:7,e:index,b:decoder}}));function _Json_mapMany(f,decoders){return{$:9,f:f,g:decoders}}var _Json_andThen=F2((function(callback,decoder){return{$:10,b:decoder,h:callback}}));var _Json_map1=F2((function(f,d1){return _Json_mapMany(f,[d1])})),_Json_run=F2((function(decoder,value){return _Json_runHelp(decoder,value)}));function _Json_runHelp(decoder,value){switch(decoder.$){case 2:return decoder.b(value);case 5:return null===value?$elm$core$Result$Ok(decoder.c):_Json_expecting("null",value);case 3:return _Json_isArray(value)?_Json_runArrayDecoder(decoder.b,value,_List_fromArray):_Json_expecting("a LIST",value);case 4:return _Json_isArray(value)?_Json_runArrayDecoder(decoder.b,value,_Json_toElmArray):_Json_expecting("an ARRAY",value);case 6:var field=decoder.d;if("object"!=typeof value||null===value||!(field in value))return _Json_expecting("an OBJECT with a field named `"+field+"`",value);var result=_Json_runHelp(decoder.b,value[field]);return $elm$core$Result$isOk(result)?result:$elm$core$Result$Err(A2($elm$json$Json$Decode$Field,field,result.a));case 7:var index=decoder.e;if(!_Json_isArray(value))return _Json_expecting("an ARRAY",value);if(index>=value.length)return _Json_expecting("a LONGER array. Need index "+index+" but only see "+value.length+" entries",value);result=_Json_runHelp(decoder.b,value[index]);return $elm$core$Result$isOk(result)?result:$elm$core$Result$Err(A2($elm$json$Json$Decode$Index,index,result.a));case 8:if("object"!=typeof value||null===value||_Json_isArray(value))return _Json_expecting("an OBJECT",value);var keyValuePairs=_List_Nil;for(var key in value)if(value.hasOwnProperty(key)){result=_Json_runHelp(decoder.b,value[key]);if(!$elm$core$Result$isOk(result))return $elm$core$Result$Err(A2($elm$json$Json$Decode$Field,key,result.a));keyValuePairs=_List_Cons(_Utils_Tuple2(key,result.a),keyValuePairs)}return $elm$core$Result$Ok($elm$core$List$reverse(keyValuePairs));case 9:for(var answer=decoder.f,decoders=decoder.g,i=0;decoders.length>i;i++){result=_Json_runHelp(decoders[i],value);if(!$elm$core$Result$isOk(result))return result;answer=answer(result.a)}return $elm$core$Result$Ok(answer);case 10:result=_Json_runHelp(decoder.b,value);return $elm$core$Result$isOk(result)?_Json_runHelp(decoder.h(result.a),value):result;case 11:for(var errors=_List_Nil,temp=decoder.g;temp.b;temp=temp.b){result=_Json_runHelp(temp.a,value);if($elm$core$Result$isOk(result))return result;errors=_List_Cons(result.a,errors)}return $elm$core$Result$Err($elm$json$Json$Decode$OneOf($elm$core$List$reverse(errors)));case 1:return $elm$core$Result$Err(A2($elm$json$Json$Decode$Failure,decoder.a,value));case 0:return $elm$core$Result$Ok(decoder.a)}}function _Json_runArrayDecoder(decoder,value,toElmValue){for(var len=value.length,array=Array(len),i=0;len>i;i++){var result=_Json_runHelp(decoder,value[i]);if(!$elm$core$Result$isOk(result))return $elm$core$Result$Err(A2($elm$json$Json$Decode$Index,i,result.a));array[i]=result.a}return $elm$core$Result$Ok(toElmValue(array))}function _Json_isArray(value){return Array.isArray(value)||"undefined"!=typeof FileList&&value instanceof FileList}function _Json_toElmArray(array){return A2($elm$core$Array$initialize,array.length,(function(i){return array[i]}))}function _Json_expecting(type,value){return $elm$core$Result$Err(A2($elm$json$Json$Decode$Failure,"Expecting "+type,value))}function _Json_equality(x,y){if(x===y)return!0;if(x.$!==y.$)return!1;switch(x.$){case 0:case 1:return x.a===y.a;case 2:return x.b===y.b;case 5:return x.c===y.c;case 3:case 4:case 8:return _Json_equality(x.b,y.b);case 6:return x.d===y.d&&_Json_equality(x.b,y.b);case 7:return x.e===y.e&&_Json_equality(x.b,y.b);case 9:return x.f===y.f&&_Json_listEquality(x.g,y.g);case 10:return x.h===y.h&&_Json_equality(x.b,y.b);case 11:return _Json_listEquality(x.g,y.g)}}function _Json_listEquality(aDecoders,bDecoders){var len=aDecoders.length;if(len!==bDecoders.length)return!1;for(var i=0;len>i;i++)if(!_Json_equality(aDecoders[i],bDecoders[i]))return!1;return!0}function _Json_wrap(value){return value}function _Scheduler_succeed(value){return{$:0,a:value}}function _Scheduler_binding(callback){return{$:2,b:callback,c:null}}var _Scheduler_andThen=F2((function(callback,task){return{$:3,b:callback,d:task}})),_Scheduler_onError=F2((function(callback,task){return{$:4,b:callback,d:task}}));var _Scheduler_guid=0;function _Scheduler_rawSpawn(task){var proc={$:0,e:_Scheduler_guid++,f:task,g:null,h:[]};return _Scheduler_enqueue(proc),proc}function _Scheduler_spawn(task){return _Scheduler_binding((function(callback){callback(_Scheduler_succeed(_Scheduler_rawSpawn(task)))}))}function _Scheduler_rawSend(proc,msg){proc.h.push(msg),_Scheduler_enqueue(proc)}var _Scheduler_working=!1,_Scheduler_queue=[];function _Scheduler_enqueue(proc){if(_Scheduler_queue.push(proc),!_Scheduler_working){for(_Scheduler_working=!0;proc=_Scheduler_queue.shift();)_Scheduler_step(proc);_Scheduler_working=!1}}function _Scheduler_step(proc){for(;proc.f;){var rootTag=proc.f.$;if(0===rootTag||1===rootTag){for(;proc.g&&proc.g.$!==rootTag;)proc.g=proc.g.i;if(!proc.g)return;proc.f=proc.g.b(proc.f.a),proc.g=proc.g.i}else{if(2===rootTag)return void(proc.f.c=proc.f.b((function(newRoot){proc.f=newRoot,_Scheduler_enqueue(proc)})));if(5===rootTag){if(0===proc.h.length)return;proc.f=proc.f.b(proc.h.shift())}else proc.g={$:3===rootTag?0:1,b:proc.f.b,i:proc.g},proc.f=proc.f.d}}}function _Process_sleep(time){return _Scheduler_binding((function(callback){var id=setTimeout((function(){callback(_Scheduler_succeed(_Utils_Tuple0))}),time);return function(){clearTimeout(id)}}))}function _Platform_initialize(flagDecoder,args,init,update,subscriptions,stepperBuilder){var result=A2(_Json_run,flagDecoder,args?args.flags:void 0);$elm$core$Result$isOk(result)||_Debug_crash(2);var managers={},model=(result=init(result.a)).a,stepper=stepperBuilder(sendToApp,model),ports=function(managers,sendToApp){var ports;for(var key in _Platform_effectManagers){var manager=_Platform_effectManagers[key];manager.a&&((ports=ports||{})[key]=manager.a(key,sendToApp)),managers[key]=_Platform_instantiateManager(manager,sendToApp)}return ports}(managers,sendToApp);function sendToApp(msg,viewMetadata){stepper(model=(result=A2(update,msg,model)).a,viewMetadata),_Platform_enqueueEffects(managers,result.b,subscriptions(model))}return _Platform_enqueueEffects(managers,result.b,subscriptions(model)),ports?{ports:ports}:{}}var _Platform_effectManagers={};function _Platform_instantiateManager(info,sendToApp){var router={g:sendToApp,h:void 0},onEffects=info.c,onSelfMsg=info.d,cmdMap=info.e,subMap=info.f;function loop(state){return A2(_Scheduler_andThen,loop,{$:5,b:function(msg){var value=msg.a;return 0===msg.$?A3(onSelfMsg,router,value,state):cmdMap&&subMap?A4(onEffects,router,value.i,value.j,state):A3(onEffects,router,cmdMap?value.i:value.j,state)}})}return router.h=_Scheduler_rawSpawn(A2(_Scheduler_andThen,loop,info.b))}var _Platform_sendToApp=F2((function(router,msg){return _Scheduler_binding((function(callback){router.g(msg),callback(_Scheduler_succeed(_Utils_Tuple0))}))}));function _Platform_leaf(home){return function(value){return{$:1,k:home,l:value}}}function _Platform_batch(list){return{$:2,m:list}}var _Platform_effectsQueue=[],_Platform_effectsActive=!1;function _Platform_enqueueEffects(managers,cmdBag,subBag){if(_Platform_effectsQueue.push({p:managers,q:cmdBag,r:subBag}),!_Platform_effectsActive){_Platform_effectsActive=!0;for(var fx;fx=_Platform_effectsQueue.shift();)_Platform_dispatchEffects(fx.p,fx.q,fx.r);_Platform_effectsActive=!1}}function _Platform_dispatchEffects(managers,cmdBag,subBag){var effectsDict={};for(var home in _Platform_gatherEffects(!0,cmdBag,effectsDict,null),_Platform_gatherEffects(!1,subBag,effectsDict,null),managers)_Scheduler_rawSend(managers[home],{$:"fx",a:effectsDict[home]||{i:_List_Nil,j:_List_Nil}})}function _Platform_gatherEffects(isCmd,bag,effectsDict,taggers){switch(bag.$){case 1:var home=bag.k,effect=function(isCmd,home,taggers,value){function applyTaggers(x){for(var temp=taggers;temp;temp=temp.t)x=temp.s(x);return x}var map=isCmd?_Platform_effectManagers[home].e:_Platform_effectManagers[home].f;return A2(map,applyTaggers,value)}(isCmd,home,taggers,bag.l);return void(effectsDict[home]=function(isCmd,newEffect,effects){return effects=effects||{i:_List_Nil,j:_List_Nil},isCmd?effects.i=_List_Cons(newEffect,effects.i):effects.j=_List_Cons(newEffect,effects.j),effects}(isCmd,effect,effectsDict[home]));case 2:for(var list=bag.m;list.b;list=list.b)_Platform_gatherEffects(isCmd,list.a,effectsDict,taggers);return;case 3:return void _Platform_gatherEffects(isCmd,bag.o,effectsDict,{s:bag.n,t:taggers})}}function _Platform_checkPortName(name){_Platform_effectManagers[name]&&_Debug_crash(3)}function _Platform_outgoingPort(name,converter){return _Platform_checkPortName(name),_Platform_effectManagers[name]={e:_Platform_outgoingPortMap,u:converter,a:_Platform_setupOutgoingPort},_Platform_leaf(name)}var _Platform_outgoingPortMap=F2((function(tagger,value){return value}));function _Platform_setupOutgoingPort(name){var subs=[],converter=_Platform_effectManagers[name].u,init=_Process_sleep(0);return _Platform_effectManagers[name].b=init,_Platform_effectManagers[name].c=F3((function(router,cmdList){for(;cmdList.b;cmdList=cmdList.b)for(var currentSubs=subs,value=converter(cmdList.a),i=0;currentSubs.length>i;i++)currentSubs[i](value);return init})),{subscribe:function(callback){subs.push(callback)},unsubscribe:function(callback){var index=(subs=subs.slice()).indexOf(callback);0>index||subs.splice(index,1)}}}function _Platform_incomingPort(name,converter){return _Platform_checkPortName(name),_Platform_effectManagers[name]={f:_Platform_incomingPortMap,u:converter,a:_Platform_setupIncomingPort},_Platform_leaf(name)}var _VirtualDom_divertHrefToApp,_Platform_incomingPortMap=F2((function(tagger,finalTagger){return function(value){return tagger(finalTagger(value))}}));function _Platform_setupIncomingPort(name,sendToApp){var subs=_List_Nil,converter=_Platform_effectManagers[name].u,init=_Scheduler_succeed(null);return _Platform_effectManagers[name].b=init,_Platform_effectManagers[name].c=F3((function(router,subList){return subs=subList,init})),{send:function(incomingValue){var result=A2(_Json_run,converter,incomingValue);$elm$core$Result$isOk(result)||_Debug_crash(4);for(var value=result.a,temp=subs;temp.b;temp=temp.b)sendToApp(temp.a(value))}}}function _Platform_mergeExportsProd(obj,exports){for(var name in exports)name in obj?"init"==name?_Debug_crash(6):_Platform_mergeExportsProd(obj[name],exports[name]):obj[name]=exports[name]}var _VirtualDom_doc="undefined"!=typeof document?document:{};function _VirtualDom_appendChild(parent,child){parent.appendChild(child)}function _VirtualDom_text(string){return{$:0,a:string}}var _VirtualDom_node=F2((function(namespace,tag){return F2((function(factList,kidList){for(var kids=[],descendantsCount=0;kidList.b;kidList=kidList.b){var kid=kidList.a;descendantsCount+=kid.b||0,kids.push(kid)}return descendantsCount+=kids.length,{$:1,c:tag,d:_VirtualDom_organizeFacts(factList),e:kids,f:namespace,b:descendantsCount}}))}))(void 0),_VirtualDom_keyedNode=F2((function(namespace,tag){return F2((function(factList,kidList){for(var kids=[],descendantsCount=0;kidList.b;kidList=kidList.b){var kid=kidList.a;descendantsCount+=kid.b.b||0,kids.push(kid)}return descendantsCount+=kids.length,{$:2,c:tag,d:_VirtualDom_organizeFacts(factList),e:kids,f:namespace,b:descendantsCount}}))}))(void 0);var _VirtualDom_on=F2((function(key,handler){return{$:"a0",n:key,o:handler}})),_VirtualDom_style=F2((function(key,value){return{$:"a1",n:key,o:value}})),_VirtualDom_property=F2((function(key,value){return{$:"a2",n:key,o:value}})),_VirtualDom_attribute=F2((function(key,value){return{$:"a3",n:key,o:value}}));var _VirtualDom_passiveSupported;function _VirtualDom_organizeFacts(factList){for(var facts={};factList.b;factList=factList.b){var entry=factList.a,tag=entry.$,key=entry.n,value=entry.o;if("a2"!==tag){var subFacts=facts[tag]||(facts[tag]={});"a3"===tag&&"class"===key?_VirtualDom_addClass(subFacts,key,value):subFacts[key]=value}else"className"===key?_VirtualDom_addClass(facts,key,value):facts[key]=value}return facts}function _VirtualDom_addClass(object,key,newClass){var classes=object[key];object[key]=classes?classes+" "+newClass:newClass}function _VirtualDom_render(vNode,eventNode){var tag=vNode.$;if(5===tag)return _VirtualDom_render(vNode.k||(vNode.k=vNode.m()),eventNode);if(0===tag)return _VirtualDom_doc.createTextNode(vNode.a);if(4===tag){for(var subNode=vNode.k,tagger=vNode.j;4===subNode.$;)"object"!=typeof tagger?tagger=[tagger,subNode.j]:tagger.push(subNode.j),subNode=subNode.k;var subEventRoot={j:tagger,p:eventNode};return(domNode=_VirtualDom_render(subNode,subEventRoot)).elm_event_node_ref=subEventRoot,domNode}if(3===tag)return _VirtualDom_applyFacts(domNode=vNode.h(vNode.g),eventNode,vNode.d),domNode;var domNode=vNode.f?_VirtualDom_doc.createElementNS(vNode.f,vNode.c):_VirtualDom_doc.createElement(vNode.c);_VirtualDom_divertHrefToApp&&"a"==vNode.c&&domNode.addEventListener("click",_VirtualDom_divertHrefToApp(domNode)),_VirtualDom_applyFacts(domNode,eventNode,vNode.d);for(var kids=vNode.e,i=0;kids.length>i;i++)_VirtualDom_appendChild(domNode,_VirtualDom_render(1===tag?kids[i]:kids[i].b,eventNode));return domNode}function _VirtualDom_applyFacts(domNode,eventNode,facts){for(var key in facts){var value=facts[key];"a1"===key?_VirtualDom_applyStyles(domNode,value):"a0"===key?_VirtualDom_applyEvents(domNode,eventNode,value):"a3"===key?_VirtualDom_applyAttrs(domNode,value):"a4"===key?_VirtualDom_applyAttrsNS(domNode,value):("value"!==key&&"checked"!==key||domNode[key]!==value)&&(domNode[key]=value)}}function _VirtualDom_applyStyles(domNode,styles){var domNodeStyle=domNode.style;for(var key in styles)domNodeStyle[key]=styles[key]}function _VirtualDom_applyAttrs(domNode,attrs){for(var key in attrs){var value=attrs[key];void 0!==value?domNode.setAttribute(key,value):domNode.removeAttribute(key)}}function _VirtualDom_applyAttrsNS(domNode,nsAttrs){for(var key in nsAttrs){var pair=nsAttrs[key],namespace=pair.f,value=pair.o;void 0!==value?domNode.setAttributeNS(namespace,key,value):domNode.removeAttributeNS(namespace,key)}}function _VirtualDom_applyEvents(domNode,eventNode,events){var allCallbacks=domNode.elmFs||(domNode.elmFs={});for(var key in events){var newHandler=events[key],oldCallback=allCallbacks[key];if(newHandler){if(oldCallback){if(oldCallback.q.$===newHandler.$){oldCallback.q=newHandler;continue}domNode.removeEventListener(key,oldCallback)}oldCallback=_VirtualDom_makeCallback(eventNode,newHandler),domNode.addEventListener(key,oldCallback,_VirtualDom_passiveSupported&&{passive:2>$elm$virtual_dom$VirtualDom$toHandlerInt(newHandler)}),allCallbacks[key]=oldCallback}else domNode.removeEventListener(key,oldCallback),allCallbacks[key]=void 0}}try{window.addEventListener("t",null,Object.defineProperty({},"passive",{get:function(){_VirtualDom_passiveSupported=!0}}))}catch(e){}function _VirtualDom_makeCallback(eventNode,initialHandler){function callback(event){var handler=callback.q,result=_Json_runHelp(handler.a,event);if($elm$core$Result$isOk(result)){for(var tagger,tag=$elm$virtual_dom$VirtualDom$toHandlerInt(handler),value=result.a,message=tag?3>tag?value.a:value.bK:value,stopPropagation=1==tag?value.b:3==tag&&value.b7,currentEventNode=(stopPropagation&&event.stopPropagation(),(2==tag?value.b:3==tag&&value.bV)&&event.preventDefault(),eventNode);tagger=currentEventNode.j;){if("function"==typeof tagger)message=tagger(message);else for(var i=tagger.length;i--;)message=tagger[i](message);currentEventNode=currentEventNode.p}currentEventNode(message,stopPropagation)}}return callback.q=initialHandler,callback}function _VirtualDom_equalEvents(x,y){return x.$==y.$&&_Json_equality(x.a,y.a)}function _VirtualDom_diff(x,y){var patches=[];return _VirtualDom_diffHelp(x,y,patches,0),patches}function _VirtualDom_pushPatch(patches,type,index,data){var patch={$:type,r:index,s:data,t:void 0,u:void 0};return patches.push(patch),patch}function _VirtualDom_diffHelp(x,y,patches,index){if(x!==y){var xType=x.$,yType=y.$;if(xType!==yType){if(1!==xType||2!==yType)return void _VirtualDom_pushPatch(patches,0,index,y);y=function(keyedNode){for(var keyedKids=keyedNode.e,len=keyedKids.length,kids=Array(len),i=0;len>i;i++)kids[i]=keyedKids[i].b;return{$:1,c:keyedNode.c,d:keyedNode.d,e:kids,f:keyedNode.f,b:keyedNode.b}}(y),yType=1}switch(yType){case 5:for(var xRefs=x.l,yRefs=y.l,i=xRefs.length,same=i===yRefs.length;same&&i--;)same=xRefs[i]===yRefs[i];if(same)return void(y.k=x.k);y.k=y.m();var subPatches=[];return _VirtualDom_diffHelp(x.k,y.k,subPatches,0),void(subPatches.length>0&&_VirtualDom_pushPatch(patches,1,index,subPatches));case 4:for(var xTaggers=x.j,yTaggers=y.j,nesting=!1,xSubNode=x.k;4===xSubNode.$;)nesting=!0,"object"!=typeof xTaggers?xTaggers=[xTaggers,xSubNode.j]:xTaggers.push(xSubNode.j),xSubNode=xSubNode.k;for(var ySubNode=y.k;4===ySubNode.$;)nesting=!0,"object"!=typeof yTaggers?yTaggers=[yTaggers,ySubNode.j]:yTaggers.push(ySubNode.j),ySubNode=ySubNode.k;return nesting&&xTaggers.length!==yTaggers.length?void _VirtualDom_pushPatch(patches,0,index,y):((nesting?function(as,bs){for(var i=0;as.length>i;i++)if(as[i]!==bs[i])return!1;return!0}(xTaggers,yTaggers):xTaggers===yTaggers)||_VirtualDom_pushPatch(patches,2,index,yTaggers),void _VirtualDom_diffHelp(xSubNode,ySubNode,patches,index+1));case 0:return void(x.a!==y.a&&_VirtualDom_pushPatch(patches,3,index,y.a));case 1:return void _VirtualDom_diffNodes(x,y,patches,index,_VirtualDom_diffKids);case 2:return void _VirtualDom_diffNodes(x,y,patches,index,_VirtualDom_diffKeyedKids);case 3:if(x.h!==y.h)return void _VirtualDom_pushPatch(patches,0,index,y);var factsDiff=_VirtualDom_diffFacts(x.d,y.d);factsDiff&&_VirtualDom_pushPatch(patches,4,index,factsDiff);var patch=y.i(x.g,y.g);return void(patch&&_VirtualDom_pushPatch(patches,5,index,patch))}}}function _VirtualDom_diffNodes(x,y,patches,index,diffKids){if(x.c===y.c&&x.f===y.f){var factsDiff=_VirtualDom_diffFacts(x.d,y.d);factsDiff&&_VirtualDom_pushPatch(patches,4,index,factsDiff),diffKids(x,y,patches,index)}else _VirtualDom_pushPatch(patches,0,index,y)}function _VirtualDom_diffFacts(x,y,category){var diff;for(var xKey in x)if("a1"!==xKey&&"a0"!==xKey&&"a3"!==xKey&&"a4"!==xKey)if(xKey in y){var xValue=x[xKey],yValue=y[xKey];xValue===yValue&&"value"!==xKey&&"checked"!==xKey||"a0"===category&&_VirtualDom_equalEvents(xValue,yValue)||((diff=diff||{})[xKey]=yValue)}else(diff=diff||{})[xKey]=category?"a1"===category?"":"a0"===category||"a3"===category?void 0:{f:x[xKey].f,o:void 0}:"string"==typeof x[xKey]?"":null;else{var subDiff=_VirtualDom_diffFacts(x[xKey],y[xKey]||{},xKey);subDiff&&((diff=diff||{})[xKey]=subDiff)}for(var yKey in y)yKey in x||((diff=diff||{})[yKey]=y[yKey]);return diff}function _VirtualDom_diffKids(xParent,yParent,patches,index){var xKids=xParent.e,yKids=yParent.e,xLen=xKids.length,yLen=yKids.length;xLen>yLen?_VirtualDom_pushPatch(patches,6,index,{v:yLen,i:xLen-yLen}):yLen>xLen&&_VirtualDom_pushPatch(patches,7,index,{v:xLen,e:yKids});for(var minLen=yLen>xLen?xLen:yLen,i=0;minLen>i;i++){var xKid=xKids[i];_VirtualDom_diffHelp(xKid,yKids[i],patches,++index),index+=xKid.b||0}}function _VirtualDom_diffKeyedKids(xParent,yParent,patches,rootIndex){for(var localPatches=[],changes={},inserts=[],xKids=xParent.e,yKids=yParent.e,xLen=xKids.length,yLen=yKids.length,xIndex=0,yIndex=0,index=rootIndex;xLen>xIndex&&yLen>yIndex;){var xKey=(x=xKids[xIndex]).a,yKey=(y=yKids[yIndex]).a,xNode=x.b,yNode=y.b,newMatch=void 0,oldMatch=void 0;if(xKey!==yKey){var xNext=xKids[xIndex+1],yNext=yKids[yIndex+1];if(xNext){var xNextKey=xNext.a,xNextNode=xNext.b;oldMatch=yKey===xNextKey}if(yNext){var yNextKey=yNext.a,yNextNode=yNext.b;newMatch=xKey===yNextKey}if(newMatch&&oldMatch)_VirtualDom_diffHelp(xNode,yNextNode,localPatches,++index),_VirtualDom_insertNode(changes,localPatches,xKey,yNode,yIndex,inserts),index+=xNode.b||0,_VirtualDom_removeNode(changes,localPatches,xKey,xNextNode,++index),index+=xNextNode.b||0,xIndex+=2,yIndex+=2;else if(newMatch)index++,_VirtualDom_insertNode(changes,localPatches,yKey,yNode,yIndex,inserts),_VirtualDom_diffHelp(xNode,yNextNode,localPatches,index),index+=xNode.b||0,xIndex+=1,yIndex+=2;else if(oldMatch)_VirtualDom_removeNode(changes,localPatches,xKey,xNode,++index),index+=xNode.b||0,_VirtualDom_diffHelp(xNextNode,yNode,localPatches,++index),index+=xNextNode.b||0,xIndex+=2,yIndex+=1;else{if(!xNext||xNextKey!==yNextKey)break;_VirtualDom_removeNode(changes,localPatches,xKey,xNode,++index),_VirtualDom_insertNode(changes,localPatches,yKey,yNode,yIndex,inserts),index+=xNode.b||0,_VirtualDom_diffHelp(xNextNode,yNextNode,localPatches,++index),index+=xNextNode.b||0,xIndex+=2,yIndex+=2}}else _VirtualDom_diffHelp(xNode,yNode,localPatches,++index),index+=xNode.b||0,xIndex++,yIndex++}for(;xLen>xIndex;){var x;index++,_VirtualDom_removeNode(changes,localPatches,(x=xKids[xIndex]).a,xNode=x.b,index),index+=xNode.b||0,xIndex++}for(;yLen>yIndex;){var y,endInserts=endInserts||[];_VirtualDom_insertNode(changes,localPatches,(y=yKids[yIndex]).a,y.b,void 0,endInserts),yIndex++}(localPatches.length>0||inserts.length>0||endInserts)&&_VirtualDom_pushPatch(patches,8,rootIndex,{w:localPatches,x:inserts,y:endInserts})}var _VirtualDom_POSTFIX="_elmW6BL";function _VirtualDom_insertNode(changes,localPatches,key,vnode,yIndex,inserts){var entry=changes[key];if(!entry)return inserts.push({r:yIndex,A:entry={c:0,z:vnode,r:yIndex,s:void 0}}),void(changes[key]=entry);if(1===entry.c){inserts.push({r:yIndex,A:entry}),entry.c=2;var subPatches=[];return _VirtualDom_diffHelp(entry.z,vnode,subPatches,entry.r),entry.r=yIndex,void(entry.s.s={w:subPatches,A:entry})}_VirtualDom_insertNode(changes,localPatches,key+_VirtualDom_POSTFIX,vnode,yIndex,inserts)}function _VirtualDom_removeNode(changes,localPatches,key,vnode,index){var entry=changes[key];if(entry){if(0===entry.c){entry.c=2;var subPatches=[];return _VirtualDom_diffHelp(vnode,entry.z,subPatches,index),void _VirtualDom_pushPatch(localPatches,9,index,{w:subPatches,A:entry})}_VirtualDom_removeNode(changes,localPatches,key+_VirtualDom_POSTFIX,vnode,index)}else{var patch=_VirtualDom_pushPatch(localPatches,9,index,void 0);changes[key]={c:1,z:vnode,r:index,s:patch}}}function _VirtualDom_addDomNodes(domNode,vNode,patches,eventNode){_VirtualDom_addDomNodesHelp(domNode,vNode,patches,0,0,vNode.b,eventNode)}function _VirtualDom_addDomNodesHelp(domNode,vNode,patches,i,low,high,eventNode){for(var patch=patches[i],index=patch.r;index===low;){var patchType=patch.$;if(1===patchType)_VirtualDom_addDomNodes(domNode,vNode.k,patch.s,eventNode);else if(8===patchType){patch.t=domNode,patch.u=eventNode,(subPatches=patch.s.w).length>0&&_VirtualDom_addDomNodesHelp(domNode,vNode,subPatches,0,low,high,eventNode)}else if(9===patchType){patch.t=domNode,patch.u=eventNode;var subPatches,data=patch.s;if(data)data.A.s=domNode,(subPatches=data.w).length>0&&_VirtualDom_addDomNodesHelp(domNode,vNode,subPatches,0,low,high,eventNode)}else patch.t=domNode,patch.u=eventNode;if(!(patch=patches[++i])||(index=patch.r)>high)return i}var tag=vNode.$;if(4===tag){for(var subNode=vNode.k;4===subNode.$;)subNode=subNode.k;return _VirtualDom_addDomNodesHelp(domNode,subNode,patches,i,low+1,high,domNode.elm_event_node_ref)}for(var vKids=vNode.e,childNodes=domNode.childNodes,j=0;vKids.length>j;j++){low++;var vKid=1===tag?vKids[j]:vKids[j].b,nextLow=low+(vKid.b||0);if(!(low>index||index>nextLow||(patch=patches[i=_VirtualDom_addDomNodesHelp(childNodes[j],vKid,patches,i,low,nextLow,eventNode)])&&(index=patch.r)<=high))return i;low=nextLow}return i}function _VirtualDom_applyPatches(rootDomNode,oldVirtualNode,patches,eventNode){return 0===patches.length?rootDomNode:(_VirtualDom_addDomNodes(rootDomNode,oldVirtualNode,patches,eventNode),_VirtualDom_applyPatchesHelp(rootDomNode,patches))}function _VirtualDom_applyPatchesHelp(rootDomNode,patches){for(var i=0;patches.length>i;i++){var patch=patches[i],localDomNode=patch.t,newNode=_VirtualDom_applyPatch(localDomNode,patch);localDomNode===rootDomNode&&(rootDomNode=newNode)}return rootDomNode}function _VirtualDom_applyPatch(domNode,patch){switch(patch.$){case 0:return function(domNode,vNode,eventNode){var parentNode=domNode.parentNode,newNode=_VirtualDom_render(vNode,eventNode);newNode.elm_event_node_ref||(newNode.elm_event_node_ref=domNode.elm_event_node_ref);parentNode&&newNode!==domNode&&parentNode.replaceChild(newNode,domNode);return newNode}(domNode,patch.s,patch.u);case 4:return _VirtualDom_applyFacts(domNode,patch.u,patch.s),domNode;case 3:return domNode.replaceData(0,domNode.length,patch.s),domNode;case 1:return _VirtualDom_applyPatchesHelp(domNode,patch.s);case 2:return domNode.elm_event_node_ref?domNode.elm_event_node_ref.j=patch.s:domNode.elm_event_node_ref={j:patch.s,p:patch.u},domNode;case 6:for(var data=patch.s,i=0;data.i>i;i++)domNode.removeChild(domNode.childNodes[data.v]);return domNode;case 7:for(var kids=(data=patch.s).e,theEnd=domNode.childNodes[i=data.v];kids.length>i;i++)domNode.insertBefore(_VirtualDom_render(kids[i],patch.u),theEnd);return domNode;case 9:if(!(data=patch.s))return domNode.parentNode.removeChild(domNode),domNode;var entry=data.A;return void 0!==entry.r&&domNode.parentNode.removeChild(domNode),entry.s=_VirtualDom_applyPatchesHelp(domNode,data.w),domNode;case 8:return function(domNode,patch){var data=patch.s,frag=function(endInserts,patch){if(!endInserts)return;for(var frag=_VirtualDom_doc.createDocumentFragment(),i=0;endInserts.length>i;i++){var entry=endInserts[i].A;_VirtualDom_appendChild(frag,2===entry.c?entry.s:_VirtualDom_render(entry.z,patch.u))}return frag}(data.y,patch);domNode=_VirtualDom_applyPatchesHelp(domNode,data.w);for(var inserts=data.x,i=0;inserts.length>i;i++){var insert=inserts[i],entry=insert.A,node=2===entry.c?entry.s:_VirtualDom_render(entry.z,patch.u);domNode.insertBefore(node,domNode.childNodes[insert.r])}frag&&_VirtualDom_appendChild(domNode,frag);return domNode}(domNode,patch);case 5:return patch.s(domNode);default:_Debug_crash(10)}}function _VirtualDom_virtualize(node){if(3===node.nodeType)return _VirtualDom_text(node.textContent);if(1!==node.nodeType)return _VirtualDom_text("");for(var attrList=_List_Nil,attrs=node.attributes,i=attrs.length;i--;){var attr=attrs[i];attrList=_List_Cons(A2(_VirtualDom_attribute,attr.name,attr.value),attrList)}var tag=node.tagName.toLowerCase(),kidList=_List_Nil,kids=node.childNodes;for(i=kids.length;i--;)kidList=_List_Cons(_VirtualDom_virtualize(kids[i]),kidList);return A3(_VirtualDom_node,tag,attrList,kidList)}var _Browser_document=F4((function(impl,flagDecoder,debugMetadata,args){return _Platform_initialize(flagDecoder,args,impl.bF,impl.cd,impl.b9,(function(sendToApp,initialModel){var divertHrefToApp=impl.al&&impl.al(sendToApp),view=impl.ce,title=_VirtualDom_doc.title,bodyNode=_VirtualDom_doc.body,currNode=_VirtualDom_virtualize(bodyNode);return _Browser_makeAnimator(initialModel,(function(model){_VirtualDom_divertHrefToApp=divertHrefToApp;var doc=view(model),nextNode=_VirtualDom_node("body")(_List_Nil)(doc.aq),patches=_VirtualDom_diff(currNode,nextNode);bodyNode=_VirtualDom_applyPatches(bodyNode,currNode,patches,sendToApp),currNode=nextNode,_VirtualDom_divertHrefToApp=0,title!==doc.a9&&(_VirtualDom_doc.title=title=doc.a9)}))}))})),_Browser_requestAnimationFrame=("undefined"!=typeof cancelAnimationFrame&&cancelAnimationFrame,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(callback){return setTimeout(callback,1e3/60)});function _Browser_makeAnimator(model,draw){draw(model);var state=0;function updateIfNeeded(){state=1===state?0:(_Browser_requestAnimationFrame(updateIfNeeded),draw(model),1)}return function(nextModel,isSync){model=nextModel,isSync?(draw(model),2===state&&(state=1)):(0===state&&_Browser_requestAnimationFrame(updateIfNeeded),state=2)}}var _Browser_fakeNode={addEventListener:function(){},removeEventListener:function(){}};"undefined"!=typeof document&&document,"undefined"!=typeof window&&window;function _Browser_withNode(id,doStuff){return _Scheduler_binding((function(callback){_Browser_requestAnimationFrame((function(){var node=document.getElementById(id);callback(node?_Scheduler_succeed(doStuff(node)):{$:1,a:$elm$browser$Browser$Dom$NotFound(id)})}))}))}var _Browser_call=F2((function(functionName,id){return _Browser_withNode(id,(function(node){return node[functionName](),_Utils_Tuple0}))}));var _Parser_isSubString=F5((function(smallString,offset,row,col,bigString){for(var smallLength=smallString.length,isGood=bigString.length>=offset+smallLength,i=0;isGood&&smallLength>i;){var code=bigString.charCodeAt(offset);isGood=smallString[i++]===bigString[offset++]&&(10===code?(row++,col=1):(col++,55296==(63488&code)?smallString[i++]===bigString[offset++]:1))}return _Utils_Tuple3(isGood?offset:-1,row,col)})),_Parser_isSubChar=F3((function(predicate,offset,string){return string.length>offset?55296==(63488&string.charCodeAt(offset))?predicate(string.substr(offset,2))?offset+2:-1:predicate(string[offset])?"\n"===string[offset]?-2:offset+1:-1:-1})),_Parser_findSubString=F5((function(smallString,offset,row,col,bigString){for(var newOffset=bigString.indexOf(smallString,offset),target=0>newOffset?bigString.length:newOffset+smallString.length;target>offset;){var code=bigString.charCodeAt(offset++);10===code?(col=1,row++):(col++,55296==(63488&code)&&offset++)}return _Utils_Tuple3(newOffset,row,col)}));var _Markdown_toHtml=F3((function(options,factList,rawMarkdown){return function(factList,model,render,diff){return{$:3,d:_VirtualDom_organizeFacts(factList),g:model,h:render,i:diff}}(factList,{a:options,b:rawMarkdown},_Markdown_render,_Markdown_diff)}));function _Markdown_render(model){return A2(_Markdown_replace,model,_VirtualDom_doc.createElement("div"))}function _Markdown_diff(x,y){return(x.b!==y.b||x.a!==y.a)&&_Markdown_replace(y)}var _Markdown_replace=F2((function(model,div){return div.innerHTML=_Markdown_marked(model.b,function(options){function toHighlight(code,lang){return!lang&&$elm$core$Maybe$isJust(options.av)&&(lang=options.av.a),"undefined"!=typeof hljs&&lang&&hljs.listLanguages().indexOf(lang)>=0?hljs.highlight(lang,code,!0).value:code}var gfm=options.bz.a;return{highlight:toHighlight,gfm:gfm,tables:gfm&&gfm.ca,breaks:gfm&&gfm.bl,sanitize:options.b_,smartypants:options.b5}}(model.a)),div})),_Markdown_marked=function(){var module={},exports=module.exports={};return function(){this||"undefined"!=typeof window&&window}(),function(){var block={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:noop,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:noop,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:noop,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};function Lexer(options){this.tokens=[],this.tokens.links={},this.options=options||marked.defaults,this.rules=block.normal,this.options.gfm&&(this.rules=this.options.tables?block.tables:block.gfm)}block.bullet=/(?:[*+-]|\d+\.)/,block.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,block.item=replace(block.item,"gm")(/bull/g,block.bullet)(),block.list=replace(block.list)(/bull/g,block.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+block.def.source+")")(),block.blockquote=replace(block.blockquote)("def",block.def)(),block._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",block.html=replace(block.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,block._tag)(),block.paragraph=replace(block.paragraph)("hr",block.hr)("heading",block.heading)("lheading",block.lheading)("blockquote",block.blockquote)("tag","<"+block._tag)("def",block.def)(),block.normal=merge({},block),block.gfm=merge({},block.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),block.gfm.paragraph=replace(block.paragraph)("(?!","(?!"+block.gfm.fences.source.replace("\\1","\\2")+"|"+block.list.source.replace("\\1","\\3")+"|")(),block.tables=merge({},block.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),Lexer.rules=block,Lexer.lex=function(src,options){return new Lexer(options).lex(src)},Lexer.prototype.lex=function(src){return src=src.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(src,!0)},Lexer.prototype.token=function(src,top,bq){var next,loose,cap,bull,b,item,space,i,l;for(src=src.replace(/^ +$/gm,"");src;)if((cap=this.rules.newline.exec(src))&&(src=src.substring(cap[0].length),cap[0].length>1&&this.tokens.push({type:"space"})),cap=this.rules.code.exec(src))src=src.substring(cap[0].length),cap=cap[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?cap:cap.replace(/\n+$/,"")});else if(cap=this.rules.fences.exec(src))src=src.substring(cap[0].length),this.tokens.push({type:"code",lang:cap[2],text:cap[3]||""});else if(cap=this.rules.heading.exec(src))src=src.substring(cap[0].length),this.tokens.push({type:"heading",depth:cap[1].length,text:cap[2]});else if(top&&(cap=this.rules.nptable.exec(src))){for(src=src.substring(cap[0].length),item={type:"table",header:cap[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:cap[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:cap[3].replace(/\n$/,"").split("\n")},i=0;item.align.length>i;i++)item.align[i]=/^ *-+: *$/.test(item.align[i])?"right":/^ *:-+: *$/.test(item.align[i])?"center":/^ *:-+ *$/.test(item.align[i])?"left":null;for(i=0;item.cells.length>i;i++)item.cells[i]=item.cells[i].split(/ *\| */);this.tokens.push(item)}else if(cap=this.rules.lheading.exec(src))src=src.substring(cap[0].length),this.tokens.push({type:"heading",depth:"="===cap[2]?1:2,text:cap[1]});else if(cap=this.rules.hr.exec(src))src=src.substring(cap[0].length),this.tokens.push({type:"hr"});else if(cap=this.rules.blockquote.exec(src))src=src.substring(cap[0].length),this.tokens.push({type:"blockquote_start"}),cap=cap[0].replace(/^ *> ?/gm,""),this.token(cap,top,!0),this.tokens.push({type:"blockquote_end"});else if(cap=this.rules.list.exec(src)){for(src=src.substring(cap[0].length),this.tokens.push({type:"list_start",ordered:(bull=cap[2]).length>1}),next=!1,l=(cap=cap[0].match(this.rules.item)).length,i=0;l>i;i++)space=(item=cap[i]).length,~(item=item.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(space-=item.length,item=item.replace(this.options.pedantic?/^ {1,4}/gm:RegExp("^ {1,"+space+"}","gm"),"")),this.options.smartLists&&i!==l-1&&(bull===(b=block.bullet.exec(cap[i+1])[0])||bull.length>1&&b.length>1||(src=cap.slice(i+1).join("\n")+src,i=l-1)),loose=next||/\n\n(?!\s*$)/.test(item),i!==l-1&&(next="\n"===item.charAt(item.length-1),loose||(loose=next)),this.tokens.push({type:loose?"loose_item_start":"list_item_start"}),this.token(item,!1,bq),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(cap=this.rules.html.exec(src))src=src.substring(cap[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===cap[1]||"script"===cap[1]||"style"===cap[1]),text:cap[0]});else if(!bq&&top&&(cap=this.rules.def.exec(src)))src=src.substring(cap[0].length),this.tokens.links[cap[1].toLowerCase()]={href:cap[2],title:cap[3]};else if(top&&(cap=this.rules.table.exec(src))){for(src=src.substring(cap[0].length),item={type:"table",header:cap[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:cap[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:cap[3].replace(/(?: *\| *)?\n$/,"").split("\n")},i=0;item.align.length>i;i++)item.align[i]=/^ *-+: *$/.test(item.align[i])?"right":/^ *:-+: *$/.test(item.align[i])?"center":/^ *:-+ *$/.test(item.align[i])?"left":null;for(i=0;item.cells.length>i;i++)item.cells[i]=item.cells[i].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(item)}else if(top&&(cap=this.rules.paragraph.exec(src)))src=src.substring(cap[0].length),this.tokens.push({type:"paragraph",text:"\n"===cap[1].charAt(cap[1].length-1)?cap[1].slice(0,-1):cap[1]});else if(cap=this.rules.text.exec(src))src=src.substring(cap[0].length),this.tokens.push({type:"text",text:cap[0]});else if(src)throw Error("Infinite loop on byte: "+src.charCodeAt(0));return this.tokens};var inline={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:noop,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^_\_([\s\S]+?)_\_(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|_\_)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:noop,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};function InlineLexer(links,options){if(this.options=options||marked.defaults,this.links=links,this.rules=inline.normal,this.renderer=this.options.renderer||new Renderer,this.renderer.options=this.options,!this.links)throw Error("Tokens array requires a `links` property.");this.options.gfm?this.rules=this.options.breaks?inline.breaks:inline.gfm:this.options.pedantic&&(this.rules=inline.pedantic)}function Renderer(options){this.options=options||{}}function Parser(options){this.tokens=[],this.token=null,this.options=options||marked.defaults,this.options.renderer=this.options.renderer||new Renderer,this.renderer=this.options.renderer,this.renderer.options=this.options}function escape(html,encode){return html.replace(encode?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function replace(regex,opt){return regex=regex.source,opt=opt||"",function self(name,val){return name?(val=(val=val.source||val).replace(/(^|[^\[])\^/g,"$1"),regex=regex.replace(name,val),self):RegExp(regex,opt)}}function noop(){}function merge(obj){for(var target,key,i=1;arguments.length>i;i++)for(key in target=arguments[i])Object.prototype.hasOwnProperty.call(target,key)&&(obj[key]=target[key]);return obj}function marked(src,opt,callback){if(callback||"function"==typeof opt){callback||(callback=opt,opt=null);var tokens,pending,highlight=(opt=merge({},marked.defaults,opt||{})).highlight,i=0;try{tokens=Lexer.lex(src,opt)}catch(e){return callback(e)}pending=tokens.length;var done=function(err){if(err)return opt.highlight=highlight,callback(err);var out;try{out=Parser.parse(tokens,opt)}catch(e){err=e}return opt.highlight=highlight,err?callback(err):callback(null,out)};if(!highlight||3>highlight.length)return done();if(delete opt.highlight,!pending)return done();for(;tokens.length>i;i++)!function(token){"code"!==token.type?--pending||done():highlight(token.text,token.lang,(function(err,code){return err?done(err):null==code||code===token.text?--pending||done():(token.text=code,token.escaped=!0,void(--pending||done()))}))}(tokens[i])}else try{return opt&&(opt=merge({},marked.defaults,opt)),Parser.parse(Lexer.lex(src,opt),opt)}catch(e){if(e.message+="\nPlease report this to https://github.com/chjj/marked.",(opt||marked.defaults).silent)return"<p>An error occured:</p><pre>"+escape(e.message+"",!0)+"</pre>";throw e}}inline._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,inline._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,inline.link=replace(inline.link)("inside",inline._inside)("href",inline._href)(),inline.reflink=replace(inline.reflink)("inside",inline._inside)(),inline.normal=merge({},inline),inline.pedantic=merge({},inline.normal,{strong:/^_\_(?=\S)([\s\S]*?\S)_\_(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),inline.gfm=merge({},inline.normal,{escape:replace(inline.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:replace(inline.text)("]|","~]|")("|","|https?://|")()}),inline.breaks=merge({},inline.gfm,{br:replace(inline.br)("{2,}","*")(),text:replace(inline.gfm.text)("{2,}","*")()}),InlineLexer.rules=inline,InlineLexer.output=function(src,links,options){return new InlineLexer(links,options).output(src)},InlineLexer.prototype.output=function(src){for(var link,text,href,cap,out="";src;)if(cap=this.rules.escape.exec(src))src=src.substring(cap[0].length),out+=cap[1];else if(cap=this.rules.autolink.exec(src))src=src.substring(cap[0].length),"@"===cap[2]?(text=":"===cap[1].charAt(6)?this.mangle(cap[1].substring(7)):this.mangle(cap[1]),href=this.mangle("mailto:")+text):href=text=escape(cap[1]),out+=this.renderer.link(href,null,text);else if(this.inLink||!(cap=this.rules.url.exec(src))){if(cap=this.rules.tag.exec(src))!this.inLink&&/^<a /i.test(cap[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(cap[0])&&(this.inLink=!1),src=src.substring(cap[0].length),out+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(cap[0]):escape(cap[0]):cap[0];else if(cap=this.rules.link.exec(src))src=src.substring(cap[0].length),this.inLink=!0,out+=this.outputLink(cap,{href:cap[2],title:cap[3]}),this.inLink=!1;else if((cap=this.rules.reflink.exec(src))||(cap=this.rules.nolink.exec(src))){if(src=src.substring(cap[0].length),link=(cap[2]||cap[1]).replace(/\s+/g," "),!(link=this.links[link.toLowerCase()])||!link.href){out+=cap[0].charAt(0),src=cap[0].substring(1)+src;continue}this.inLink=!0,out+=this.outputLink(cap,link),this.inLink=!1}else if(cap=this.rules.strong.exec(src))src=src.substring(cap[0].length),out+=this.renderer.strong(this.output(cap[2]||cap[1]));else if(cap=this.rules.em.exec(src))src=src.substring(cap[0].length),out+=this.renderer.em(this.output(cap[2]||cap[1]));else if(cap=this.rules.code.exec(src))src=src.substring(cap[0].length),out+=this.renderer.codespan(escape(cap[2],!0));else if(cap=this.rules.br.exec(src))src=src.substring(cap[0].length),out+=this.renderer.br();else if(cap=this.rules.del.exec(src))src=src.substring(cap[0].length),out+=this.renderer.del(this.output(cap[1]));else if(cap=this.rules.text.exec(src))src=src.substring(cap[0].length),out+=this.renderer.text(escape(this.smartypants(cap[0])));else if(src)throw Error("Infinite loop on byte: "+src.charCodeAt(0))}else src=src.substring(cap[0].length),text=escape(cap[1]),out+=this.renderer.link(href=text,null,text);return out},InlineLexer.prototype.outputLink=function(cap,link){var href=escape(link.href),title=link.title?escape(link.title):null;return"!"!==cap[0].charAt(0)?this.renderer.link(href,title,this.output(cap[1])):this.renderer.image(href,title,escape(cap[1]))},InlineLexer.prototype.smartypants=function(text){return this.options.smartypants?text.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014\/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014\/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):text},InlineLexer.prototype.mangle=function(text){if(!this.options.mangle)return text;for(var ch,out="",l=text.length,i=0;l>i;i++)ch=text.charCodeAt(i),Math.random()>.5&&(ch="x"+ch.toString(16)),out+="&#"+ch+";";return out},Renderer.prototype.code=function(code,lang,escaped){if(this.options.highlight){var out=this.options.highlight(code,lang);null!=out&&out!==code&&(escaped=!0,code=out)}return lang?'<pre><code class="'+this.options.langPrefix+escape(lang,!0)+'">'+(escaped?code:escape(code,!0))+"\n</code></pre>\n":"<pre><code>"+(escaped?code:escape(code,!0))+"\n</code></pre>"},Renderer.prototype.blockquote=function(quote){return"<blockquote>\n"+quote+"</blockquote>\n"},Renderer.prototype.html=function(html){return html},Renderer.prototype.heading=function(text,level,raw){return"<h"+level+' id="'+this.options.headerPrefix+raw.toLowerCase().replace(/[^\w]+/g,"-")+'">'+text+"</h"+level+">\n"},Renderer.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},Renderer.prototype.list=function(body,ordered){var type=ordered?"ol":"ul";return"<"+type+">\n"+body+"</"+type+">\n"},Renderer.prototype.listitem=function(text){return"<li>"+text+"</li>\n"},Renderer.prototype.paragraph=function(text){return"<p>"+text+"</p>\n"},Renderer.prototype.table=function(header,body){return"<table>\n<thead>\n"+header+"</thead>\n<tbody>\n"+body+"</tbody>\n</table>\n"},Renderer.prototype.tablerow=function(content){return"<tr>\n"+content+"</tr>\n"},Renderer.prototype.tablecell=function(content,flags){var type=flags.header?"th":"td";return(flags.align?"<"+type+' style="text-align:'+flags.align+'">':"<"+type+">")+content+"</"+type+">\n"},Renderer.prototype.strong=function(text){return"<strong>"+text+"</strong>"},Renderer.prototype.em=function(text){return"<em>"+text+"</em>"},Renderer.prototype.codespan=function(text){return"<code>"+text+"</code>"},Renderer.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},Renderer.prototype.del=function(text){return"<del>"+text+"</del>"},Renderer.prototype.link=function(href,title,text){if(this.options.sanitize){try{var prot=decodeURIComponent((html=href,html.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/g,(function(_,n){return"colon"===(n=n.toLowerCase())?":":"#"===n.charAt(0)?"x"===n.charAt(1)?String.fromCharCode(parseInt(n.substring(2),16)):String.fromCharCode(+n.substring(1)):""})))).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return""}if(0===prot.indexOf("javascript:")||0===prot.indexOf("vbscript:")||0===prot.indexOf("data:"))return""}var html,out='<a href="'+href+'"';return title&&(out+=' title="'+title+'"'),out+=">"+text+"</a>"},Renderer.prototype.image=function(href,title,text){var out='<img src="'+href+'" alt="'+text+'"';return title&&(out+=' title="'+title+'"'),out+=this.options.xhtml?"/>":">"},Renderer.prototype.text=function(text){return text},Parser.parse=function(src,options,renderer){return new Parser(options,renderer).parse(src)},Parser.prototype.parse=function(src){this.inline=new InlineLexer(src.links,this.options,this.renderer),this.tokens=src.reverse();for(var out="";this.next();)out+=this.tok();return out},Parser.prototype.next=function(){return this.token=this.tokens.pop()},Parser.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},Parser.prototype.parseText=function(){for(var body=this.token.text;"text"===this.peek().type;)body+="\n"+this.next().text;return this.inline.output(body)},Parser.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var i,row,cell,j,header="",body="";for(cell="",i=0;this.token.header.length>i;i++)({header:!0,align:this.token.align[i]}),cell+=this.renderer.tablecell(this.inline.output(this.token.header[i]),{header:!0,align:this.token.align[i]});for(header+=this.renderer.tablerow(cell),i=0;this.token.cells.length>i;i++){for(row=this.token.cells[i],cell="",j=0;row.length>j;j++)cell+=this.renderer.tablecell(this.inline.output(row[j]),{header:!1,align:this.token.align[j]});body+=this.renderer.tablerow(cell)}return this.renderer.table(header,body);case"blockquote_start":for(body="";"blockquote_end"!==this.next().type;)body+=this.tok();return this.renderer.blockquote(body);case"list_start":body="";for(var ordered=this.token.ordered;"list_end"!==this.next().type;)body+=this.tok();return this.renderer.list(body,ordered);case"list_item_start":for(body="";"list_item_end"!==this.next().type;)body+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(body);case"loose_item_start":for(body="";"list_item_end"!==this.next().type;)body+=this.tok();return this.renderer.listitem(body);case"html":var html=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(html);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},noop.exec=noop,marked.options=marked.setOptions=function(opt){return merge(marked.defaults,opt),marked},marked.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new Renderer,xhtml:!1},marked.Parser=Parser,marked.parser=Parser.parse,marked.Renderer=Renderer,marked.Lexer=Lexer,marked.lexer=Lexer.lex,marked.InlineLexer=InlineLexer,marked.inlineLexer=InlineLexer.output,marked.parse=marked,void 0!==module&&"object"==typeof exports?module.exports=marked:void 0===(__WEBPACK_AMD_DEFINE_RESULT__=marked)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(),module.exports}();var subMap,$elm$core$List$cons=_List_cons,$elm$core$Dict$foldr=F3((function(func,acc,t){for(;;){if(-2===t.$)return acc;var left=t.d,$temp$func=func,$temp$acc=A3(func,t.b,t.c,A3($elm$core$Dict$foldr,func,acc,t.e));func=$temp$func,acc=$temp$acc,t=left}})),$elm$core$Dict$toList=function(dict){return A3($elm$core$Dict$foldr,F3((function(key,value,list){return A2($elm$core$List$cons,_Utils_Tuple2(key,value),list)})),_List_Nil,dict)},$elm$core$Set$toList=function(_v0){return function(dict){return A3($elm$core$Dict$foldr,F3((function(key,value,keyList){return A2($elm$core$List$cons,key,keyList)})),_List_Nil,dict)}(_v0)},$elm$core$Basics$EQ=1,$elm$core$Basics$GT=2,$elm$core$Basics$LT=0,$elm$core$Result$Err=function(a){return{$:1,a:a}},$elm$json$Json$Decode$Failure=F2((function(a,b){return{$:3,a:a,b:b}})),$elm$json$Json$Decode$Field=F2((function(a,b){return{$:0,a:a,b:b}})),$elm$json$Json$Decode$Index=F2((function(a,b){return{$:1,a:a,b:b}})),$elm$core$Result$Ok=function(a){return{$:0,a:a}},$elm$json$Json$Decode$OneOf=function(a){return{$:2,a:a}},$elm$core$Basics$add=_Basics_add,$elm$core$Maybe$Just=function(a){return{$:0,a:a}},$elm$core$Maybe$Nothing={$:1},$elm$core$String$fromInt=function(number){return number+""},$elm$core$String$join=F2((function(sep,chunks){return A2(_String_join,sep,_List_toArray(chunks))})),$elm$core$String$split=F2((function(sep,string){return _List_fromArray(A2(_String_split,sep,string))})),$elm$core$List$foldl=F3((function(func,acc,list){for(;;){if(!list.b)return acc;var xs=list.b,$temp$func=func,$temp$acc=A2(func,list.a,acc);func=$temp$func,acc=$temp$acc,list=xs}})),$elm$core$List$length=function(xs){return A3($elm$core$List$foldl,F2((function(_v0,i){return i+1})),0,xs)},$elm$core$List$rangeHelp=F3((function(lo,hi,list){for(;;){if(_Utils_cmp(lo,hi)>=1)return list;var $temp$lo=lo,$temp$hi=hi-1,$temp$list=A2($elm$core$List$cons,hi,list);lo=$temp$lo,hi=$temp$hi,list=$temp$list}})),$elm$core$List$range=F2((function(lo,hi){return A3($elm$core$List$rangeHelp,lo,hi,_List_Nil)})),$elm$core$Char$toCode=function(char){var code=char.charCodeAt(0);return 55296>code||code>56319?code:1024*(code-55296)+char.charCodeAt(1)-56320+65536},$elm$core$Char$isLower=function(_char){var code=$elm$core$Char$toCode(_char);return code>=97&&122>=code},$elm$core$Char$isUpper=function(_char){var code=$elm$core$Char$toCode(_char);return 90>=code&&code>=65},$elm$core$Char$isAlpha=function(_char){return $elm$core$Char$isLower(_char)||$elm$core$Char$isUpper(_char)},$elm$core$Char$isDigit=function(_char){var code=$elm$core$Char$toCode(_char);return 57>=code&&code>=48},$elm$core$Char$isAlphaNum=function(_char){return $elm$core$Char$isLower(_char)||$elm$core$Char$isUpper(_char)||$elm$core$Char$isDigit(_char)},$elm$core$List$reverse=function(list){return A3($elm$core$List$foldl,$elm$core$List$cons,_List_Nil,list)},$elm$core$Array$Array_elm_builtin=F4((function(a,b,c,d){return{$:0,a:a,b:b,c:c,d:d}})),$elm$core$Elm$JsArray$empty=[],$elm$core$Basics$ceiling=_Basics_ceiling,$elm$core$Basics$logBase=F2((function(base,number){return _Basics_log(number)/_Basics_log(base)})),$elm$core$Array$shiftStep=$elm$core$Basics$ceiling(A2($elm$core$Basics$logBase,2,32)),$elm$core$Array$empty=A4($elm$core$Array$Array_elm_builtin,0,$elm$core$Array$shiftStep,$elm$core$Elm$JsArray$empty,$elm$core$Elm$JsArray$empty),$elm$core$Elm$JsArray$initialize=_JsArray_initialize,$elm$core$Array$Leaf=function(a){return{$:1,a:a}},$elm$core$Basics$apL=F2((function(f,x){return f(x)})),$elm$core$Basics$eq=_Utils_equal,$elm$core$Basics$floor=_Basics_floor,$elm$core$Elm$JsArray$length=function(array){return array.length},$elm$core$Basics$max=F2((function(x,y){return _Utils_cmp(x,y)>0?x:y})),$elm$core$Elm$JsArray$initializeFromList=_JsArray_initializeFromList,$elm$core$Array$compressNodes=F2((function(nodes,acc){for(;;){var _v0=A2($elm$core$Elm$JsArray$initializeFromList,32,nodes),remainingNodes=_v0.b,newAcc=A2($elm$core$List$cons,{$:0,a:_v0.a},acc);if(!remainingNodes.b)return $elm$core$List$reverse(newAcc);nodes=remainingNodes,acc=newAcc}})),$elm$core$Tuple$first=function(_v0){return _v0.a},$elm$core$Array$treeFromBuilder=F2((function(nodeList,nodeListSize){for(;;){var newNodeSize=$elm$core$Basics$ceiling(nodeListSize/32);if(1===newNodeSize)return A2($elm$core$Elm$JsArray$initializeFromList,32,nodeList).a;nodeList=A2($elm$core$Array$compressNodes,nodeList,_List_Nil),nodeListSize=newNodeSize}})),$elm$core$Array$builderToArray=F2((function(reverseNodeList,builder){if(builder.j){var treeLen=32*builder.j,depth=$elm$core$Basics$floor(A2($elm$core$Basics$logBase,32,treeLen-1)),correctNodeList=reverseNodeList?$elm$core$List$reverse(builder.m):builder.m,tree=A2($elm$core$Array$treeFromBuilder,correctNodeList,builder.j);return A4($elm$core$Array$Array_elm_builtin,$elm$core$Elm$JsArray$length(builder.l)+treeLen,A2($elm$core$Basics$max,5,depth*$elm$core$Array$shiftStep),tree,builder.l)}return A4($elm$core$Array$Array_elm_builtin,$elm$core$Elm$JsArray$length(builder.l),$elm$core$Array$shiftStep,$elm$core$Elm$JsArray$empty,builder.l)})),$elm$core$Array$initializeHelp=F5((function(fn,fromIndex,len,nodeList,tail){for(;;){if(0>fromIndex)return A2($elm$core$Array$builderToArray,!1,{m:nodeList,j:len/32|0,l:tail});var leaf=$elm$core$Array$Leaf(A3($elm$core$Elm$JsArray$initialize,32,fromIndex,fn));fn=fn,fromIndex=fromIndex-32,len=len,nodeList=A2($elm$core$List$cons,leaf,nodeList),tail=tail}})),$elm$core$Array$initialize=F2((function(len,fn){if(len>0){var tailLen=len%32;return A5($elm$core$Array$initializeHelp,fn,len-tailLen-32,len,_List_Nil,A3($elm$core$Elm$JsArray$initialize,tailLen,len-tailLen,fn))}return $elm$core$Array$empty})),$elm$core$Result$isOk=function(result){return!result.$},$elm$json$Json$Decode$andThen=_Json_andThen,$elm$json$Json$Decode$bool=_Json_decodeBool,$elm$json$Json$Decode$map=_Json_map1,$elm$json$Json$Decode$succeed=function(msg){return{$:0,a:msg}},$elm$virtual_dom$VirtualDom$toHandlerInt=function(handler){switch(handler.$){case 0:return 0;case 1:return 1;case 2:return 2;default:return 3}},$elm$core$Basics$identity=function(x){return x},$elm$browser$Browser$Dom$NotFound=$elm$core$Basics$identity,$elm$core$String$contains=_String_contains,$elm$core$String$length=function(str){return str.length},$elm$core$String$slice=_String_slice,$elm$core$String$isEmpty=function(string){return""===string},$elm$core$String$toInt=function(str){for(var total=0,code0=str.charCodeAt(0),start=43==code0||45==code0?1:0,i=start;str.length>i;++i){var code=str.charCodeAt(i);if(48>code||code>57)return $elm$core$Maybe$Nothing;total=10*total+code-48}return i==start?$elm$core$Maybe$Nothing:$elm$core$Maybe$Just(45==code0?-total:total)},$elm$core$String$startsWith=_String_startsWith,$elm$core$Task$succeed=_Scheduler_succeed,$elm$core$Task$init=$elm$core$Task$succeed(0),$elm$core$List$foldrHelper=F4((function(fn,acc,ctr,ls){if(ls.b){var a=ls.a,r1=ls.b;if(r1.b){var b=r1.a,r2=r1.b;if(r2.b){var c=r2.a,r3=r2.b;if(r3.b){var r4=r3.b;return A2(fn,a,A2(fn,b,A2(fn,c,A2(fn,r3.a,ctr>500?A3($elm$core$List$foldl,fn,acc,$elm$core$List$reverse(r4)):A4($elm$core$List$foldrHelper,fn,acc,ctr+1,r4)))))}return A2(fn,a,A2(fn,b,A2(fn,c,acc)))}return A2(fn,a,A2(fn,b,acc))}return A2(fn,a,acc)}return acc})),$elm$core$List$foldr=F3((function(fn,acc,ls){return A4($elm$core$List$foldrHelper,fn,acc,0,ls)})),$elm$core$List$map=F2((function(f,xs){return A3($elm$core$List$foldr,F2((function(x,acc){return A2($elm$core$List$cons,f(x),acc)})),_List_Nil,xs)})),$elm$core$Task$andThen=_Scheduler_andThen,$elm$core$Task$map=F2((function(func,taskA){return A2($elm$core$Task$andThen,(function(a){return $elm$core$Task$succeed(func(a))}),taskA)})),$elm$core$Task$map2=F3((function(func,taskA,taskB){return A2($elm$core$Task$andThen,(function(a){return A2($elm$core$Task$andThen,(function(b){return $elm$core$Task$succeed(A2(func,a,b))}),taskB)}),taskA)})),$elm$core$Platform$sendToApp=_Platform_sendToApp,$elm$core$Task$spawnCmd=F2((function(router,_v0){var task=_v0;return _Scheduler_spawn(A2($elm$core$Task$andThen,$elm$core$Platform$sendToApp(router),task))}));_Platform_effectManagers.Task={b:$elm$core$Task$init,c:F3((function(router,commands){return A2($elm$core$Task$map,(function(){return 0}),(tasks=A2($elm$core$List$map,$elm$core$Task$spawnCmd(router),commands),A3($elm$core$List$foldr,$elm$core$Task$map2($elm$core$List$cons),$elm$core$Task$succeed(_List_Nil),tasks)));var tasks})),d:F3((function(){return $elm$core$Task$succeed(0)})),e:F2((function(tagger,_v0){return A2($elm$core$Task$map,tagger,_v0)})),f:subMap};var x,int_,toComponent,$elm$core$Task$command=_Platform_leaf("Task"),$elm$core$Task$perform=F2((function(toMessage,task){return $elm$core$Task$command(A2($elm$core$Task$map,toMessage,task))})),$elm$browser$Browser$document=_Browser_document,$elm$core$Dict$RBEmpty_elm_builtin={$:-2},$elm$core$Dict$empty=$elm$core$Dict$RBEmpty_elm_builtin,$elm$json$Json$Decode$field=_Json_decodeField,$author$project$LocalTypes$Goals={$:0},$author$project$LocalTypes$MainTitle={$:1},$jschomay$elm_narrative_engine$NarrativeEngine$Debug$init={ag:"Start",ah:"Begin",ak:""},$elm$json$Json$Encode$list=F2((function(func,entries){return A3($elm$core$List$foldl,function(func){return F2((function(entry,array){return array.push(func(entry)),array}))}(func),[],entries)})),$elm$json$Json$Encode$string=_Json_wrap,$author$project$Main$persistSaveReq=_Platform_outgoingPort("persistSaveReq",(function($){var b=$.b;return A2($elm$json$Json$Encode$list,$elm$core$Basics$identity,_List_fromArray([$elm$json$Json$Encode$string($.a),$elm$json$Json$Encode$list($elm$json$Json$Encode$string)(b)]))})),$elm$core$Dict$RBNode_elm_builtin=F5((function(a,b,c,d,e){return{$:-1,a:a,b:b,c:c,d:d,e:e}})),$elm$core$Dict$balance=F5((function(color,key,value,left,right){if(-1!==right.$||right.a){if(-1!==left.$||left.a||-1!==left.d.$||left.d.a)return A5($elm$core$Dict$RBNode_elm_builtin,color,key,value,left,right);var _v6=left.d;lRight=left.e;return A5($elm$core$Dict$RBNode_elm_builtin,0,left.b,left.c,A5($elm$core$Dict$RBNode_elm_builtin,1,_v6.b,_v6.c,_v6.d,_v6.e),A5($elm$core$Dict$RBNode_elm_builtin,1,key,value,lRight,right))}var rK=right.b,rV=right.c,rLeft=right.d,rRight=right.e;if(-1!==left.$||left.a)return A5($elm$core$Dict$RBNode_elm_builtin,color,rK,rV,A5($elm$core$Dict$RBNode_elm_builtin,0,key,value,left,rLeft),rRight);var lRight;return A5($elm$core$Dict$RBNode_elm_builtin,0,key,value,A5($elm$core$Dict$RBNode_elm_builtin,1,left.b,left.c,left.d,lRight=left.e),A5($elm$core$Dict$RBNode_elm_builtin,1,rK,rV,rLeft,rRight))})),$elm$core$Basics$compare=_Utils_compare,$elm$core$Dict$insertHelp=F3((function(key,value,dict){if(-2===dict.$)return A5($elm$core$Dict$RBNode_elm_builtin,0,key,value,$elm$core$Dict$RBEmpty_elm_builtin,$elm$core$Dict$RBEmpty_elm_builtin);var nColor=dict.a,nKey=dict.b,nValue=dict.c,nLeft=dict.d,nRight=dict.e;switch(A2($elm$core$Basics$compare,key,nKey)){case 0:return A5($elm$core$Dict$balance,nColor,nKey,nValue,A3($elm$core$Dict$insertHelp,key,value,nLeft),nRight);case 1:return A5($elm$core$Dict$RBNode_elm_builtin,nColor,nKey,value,nLeft,nRight);default:return A5($elm$core$Dict$balance,nColor,nKey,nValue,nLeft,A3($elm$core$Dict$insertHelp,key,value,nRight))}})),$elm$core$Dict$insert=F3((function(key,value,dict){var _v0=A3($elm$core$Dict$insertHelp,key,value,dict);if(-1!==_v0.$||_v0.a)return _v0;return A5($elm$core$Dict$RBNode_elm_builtin,1,_v0.b,_v0.c,_v0.d,_v0.e)})),$author$project$NarrativeContent$content__________________________________=$elm$core$Dict$insert,$author$project$NarrativeContent$achievements=A3($author$project$NarrativeContent$content__________________________________,"f_the_system","\n_Achievement unlocked:_\nF&ast;&ast;&ast; the system\n",A3($author$project$NarrativeContent$content__________________________________,"freedom","\n_Achievement unlocked:_\nFree to roam\n",A3($author$project$NarrativeContent$content__________________________________,"transfer_station","\n_Achievement unlocked:_\nTransfer station\n",A3($author$project$NarrativeContent$content__________________________________,"fools_errand_achievement","\n_Achievement unlocked:_\nFool's errand\n",A3($author$project$NarrativeContent$content__________________________________,"get_caffeinated_quest_achievement","\n_Achievement unlocked:_\nGet caffeinated\n",$elm$core$Dict$empty))))),$author$project$NarrativeContent$Chapter1$content=A3($elm$core$Dict$insert,"meetConductorFirstTime",'\n"No one is supposed to be back here right now! What are you doing here?"\n\nNow that he\'s close up, he seems a lot different than the other security guards. His uniform even seems a little too big for him.  He does look flustered, though.\n---\n"I-I\'m sorry, sir. {INFRACTIONS_GREEN_BUTTON.pressed? The computer was turned off.  I just pressed the button to turn it on|I followed all of the steps like the poster said}, but the whole thing broke down."\n\nHe seems real upset.\n---\n"That\'s typical.  Everything around here is breaking down under too much load."\n\nHe looks in the room as if expecting to find someone else.\n---\n"I\'m sorry pal, I didn\'t mean to yell at you.  They aren\'t supposed to be taking people here today.  It\'s closed.  For, um... pest control spraying."\n\n"Spraying?"\n\n"Look, just go.  The exit is down the hallway behind me.  Three lefts and a right and you\'re out.  I\'ve got to take care of something."\n---\nI guess I got off easy.  I didn\'t see any rats or bugs or anything in there though.\n---\n"Hey, buddy!  Hang on a minute."\n\nUh oh.\n---\nHe holds something out to me.\n\n"Here, take this.  Don\'t want you to end up back here again."\n---\nIt\'s an Orange Line pass!  That\'s great.\n\nWhat a strange guy.\n',A3($elm$core$Dict$insert,"escapingInfractionRoom","\nIt's open! The reseting computer must have reset the locks. Seems like a flaw in the design, but I'll take it.\n---\nThe door opens up to the maze of hallways. I think I can remember the path back to the station platform.\n\nIt was left, left, right, straight till the water cooler, then another left, or was it right--\n---\n\"Hey, what are you doing back here?\"\n---\nShit, another security guard.\n\nHe's looking right at me.\n\nHe looks pissed...\n",A3($elm$core$Dict$insert,"pourSodaOnInfractionsMachine","\nThis damn system!\n\nIn an uncharacteristic moment of weakness, I pop open this can of soda I still have for some reason and pour it all over the damn machine.\n\nIt sizzles and sparks, and the whole thing goes off-line, then resets.\n",A3($elm$core$Dict$insert,"breakInfractionAutomationSystem","\nMaybe it will start if I press this.\n---\nNothing happens.\n---\n...\n---\nOh no.  The computer is making a terrible sound.\n---\nMaybe it's starting up.\n---\nNope.  It's rebooting.  But it looks like it froze.\n\nI'm stuck! What did I do? What did I do?\n",A3($elm$core$Dict$insert,"INFRACTIONS_PRINTER","\nIt's an old printer attached to the computer. It looks like it barely works.\n",A3($elm$core$Dict$insert,"infractionAutomationStep3","\n{Nothing's coming out! Did something break?\n---\nSomething must have went wrong because the computer seems to be rebooting!\n\nDamn it! Why isn't anything working!  What do I do now?\n|\nThe whole damn system is broken and I'm stuck!\n}\n",A3($elm$core$Dict$insert,"INFRACTIONS_COMPUTER","\n{INFRACTIONS_ROOM_DOOR.infraction_step=0?  The computer doesn't seem to be on. But there is a [green lit button](INFRACTIONS_GREEN_BUTTON) on it's front.}\n\n{INFRACTIONS_ROOM_DOOR.infraction_step=2?  Everything is sent and I just have to get my printed ticket. I wonder how much this is going to cost me.}\n\n{INFRACTIONS_ROOM_DOOR.infraction_step=3?  It's stuck on the blue screen of death! }\n",A3($elm$core$Dict$insert,"infractionAutomationStep2","\nI can see all of my personal info on the dusty computer monitor. My name, age, address. Everything. It all seems up to date, though that picture certainly isn't.\n\nI'll just going to hit send and get this over with.\n---\n...\n---\nThis thing is sure taking a long time.\n---\nThere it goes. Now it's asking me to select my violation. \"Fare Evasion\" sounds so official.  I hope this doesn't go on a permanent record. I don't know if I'll ever live this down.\n---\nThere. It's sent. How long will I have to wait now for this to print?\n",A3($elm$core$Dict$insert,"INFRACTIONS_CARD_READER","\n{INFRACTIONS_ROOM_DOOR.infraction_step=1?  I can already see my personal information on the computer screen.  No need to scan my Red Line Pass again. }\n\n{INFRACTIONS_ROOM_DOOR.infraction_step=2?  They already  have my info.  I don't want to get fined again! }\n\n{INFRACTIONS_ROOM_DOOR.infraction_step=3?  The computer is still rebooting and the whole system is broken. Damn it! Why isn't anything working!\n}\n",A3($elm$core$Dict$insert,"infractionAutomationStep1","\nWell, It's a card reader, and the only card I have on me is my Red Line Pass. It's worth a try.\n---\n*BEEP*\n---\nAha! The computer seems to be booting up... very slowly. Where did they dig up this antique? It makes our computers at the office look new. As long as it's working I guess.\n",A3($elm$core$Dict$insert,"readingInfrationsPoster","\n{_Violators of the law! Due to high volumes of fare evasion, vandalism, and littering, all minor infractions will be dealt with by our new automated system. Please read carefully the following instructions as Transit Authorities Fine Distribution has recently changed:_\n---\n_Step 1: Approach computer terminal in center of room (WARNING: Do not press the big green button)._\n---\n_Step 2:  Scan a state issued ID, Transit Line Pass, or input social security number and verify the listed personal information. System will power on after input._\n---\n_Step 3: Select minor infraction the violator is accused of (WARNING: you are being monitored, any attempt to supply misinformation will be met with harsh consequences!)._\n---\n_Step 4: Press send. The information provided will now be processed and verified by a member of Transit Authority. Whilst this is happening the violator may fill out a Violation Dispute Document on the computer or a Violation Apology Document (WARNING: All documents are subject to be read at Transit Authorities earliest convenience)._\n---\n_Step 5:  If all the information is correct, a fine ticket will print out next to the computer and the door will be unlocked. Once the ticket has been removed the violator may leave the Detention Room._\n---\n_Thank you and have a nice day!_\n---\nWow, this seems overly complicated. I'm never going to break the law again.\n|\n_Violators of the law! Due to high volumes of fare evasion..._\n\nBlah, blah blah... let's see, scan your pass... check the computer... print ticket.\n\nHmmm.\n}\n",A3($elm$core$Dict$insert,"INFRACTIONS_ROOM_DOOR","\n{It's locked. I'm trapped. What am I supposed to do? And how do I get out  of here? They can't keep me in here like this.\n---\nCan they?\n|{?\nIt's locked.\n|\nStill locked.\n|\nMaybe if I jiggle the handle a few more times...\n|\nNope. It's locked.\n|\nWait a second. I think I got it! Oh, no. Just kidding. Still locked.\n}}\n",A3($elm$core$Dict$insert,"TICKET_INSPECTOR",'\n"Where am I!?"\n\n"This is the Central Guard Station at St. Mark\'s. Follow the instructions on the poster."\n\n"But--"\n---\nThe steel door slams shut before I can get another word out and he is gone.\n',A3($elm$core$Dict$insert,"caughtOnOrangeLineHeadingToOther","\nOh no, I got on the wrong train!  Mark said 73rd Street Station, how did I mess this up?\n---\nIt's ok, take a few breaths.  I'll just get off at the next stop, then catch the right train.  Then I can grab my briefcase, hopefully everything is still in there, and I can buy a ticket back to my station and get to work and give the presesntation and get my promotion and everything will be fine.\n---\n\"Excuse me sir, can I see your ticket or pass please?\"\n---\n...\n---\nOh.  Shit.\n",A3($elm$core$Dict$insert,"caughtOnOrangeLineHeadingTo73rd","\nI'm so close.  This has been one crazy morning, but I'll just grab my briefcase now, hopefully everything is still in there, and I can buy a ticket back to my station and get to work and give the presesntation and get my promotion and everything will be fine.\n---\n\"Excuse me sir, can I see your ticket or pass please?\"\n---\n...\n---\nOh.  Shit.\n",A3($elm$core$Dict$insert,"jumpTurnstileAfterTaklingToMark","\nOk, I've done this once before, I'll just do it the same way the skater punk showed me.  Nice and easy...\n---\nMade it!  That wasn't so bad.  I'm starting to get the hang of it.\n",A3($elm$core$Dict$insert,"pleasantriesWithMark","\nHe's still describing the broom closet...\n",A3($elm$core$Dict$insert,"markTellsAboutBroomCloset",'\nHis clothes are covered in dirt and holes. He sits on the tile floor with a sign.\n\nThe sign reads, "Hi, I\'m Mark. Anything helps. God Ble$$."\n---\nWell, that was easy.\n---\nI quickly explain the situation, but he doesn\'t seem to be following any of it.\n\nThis was a waste of time!\n---\n"Did you say briefcase?"\n\n"Yeah, it was stolen.  I was told you might have found it."\n\nNow that I say it, it sounds really dumb.  Why did I think this would work?\n---\nHis eyes go blank for a few moments, then with a sudden jolt, he\'s back again.\n\n"Yeah, bout 10 minutes ago. One of the rail kiddies was lugging around this real fancy thing."\n\n"Oh my God, really?! Did you say rail kitty?  Never mind.  Tell me, where did he go?"\n---\n"Hold your horses. He hangs out with a real rough group, bunch of nabbers and grabbers. But ol\' Mark\'s seen where they horde their stash.  An old broom closet at 73rd Street Station, lock doesn\'t even work--"\n---\n"That\'s great, thanks!  Gotta go!"\n\nI leave the bum still talking to himself about the broom closet.\n',A3($elm$core$Dict$insert,"GREEN_SUIT_MAN","\nHis suit looks like it costs more than my rent.  I'm not going to bother him.\n",A3($elm$core$Dict$insert,"SPIKY_HAIR_GUY",'\n{{PLAYER.find_briefcase=2?"Excuse me, Mark?"\n\n"Sorry, bud. Wrong guy."\n|\nThat\'s not Mark.\n}\n|\nThat\'s not Mark.\n}\n',A3($elm$core$Dict$insert,"SHIFTY_MAN","\n{He stands in the shadows of the platform away from the crowds and he seems to jump at every loud noise. This guys has to be up to something.\n|\n{PLAYER.find_briefcase=2?\"Excuse me, sir? Your name wouldn't happen to be Mark would it?\"\n---\n\"Beat it, shit head. I'm waiting for someone.\"\n|\nHe's still up to no good.\n}\n|\nHe's still up to no good.\n}\n",A3($elm$core$Dict$insert,"ODD_KEY","\nI wonder what this is for. It's probably just junk.\n",A3($elm$core$Dict$insert,"findKeyInTrashCan","\nIt's just a trash can. Nothing important here.\n---\n...\n---\nWait. There's something inside.\n\nI better not regret this...\n---\nThis is a strange key.  I think I'll hold onto it. Just in case.\n",A3($elm$core$Dict$insert,"followSkaterDudeToCapitalHeights","\nI just broke the law. I'm riding without a ticket or a pass.  This isn't right.\n---\nIs that guy staring at me? He knows I jumped. He knows I did something wrong. Everyone knows. I have to get out of here, I can't breath. I--\n\n\"Hey, man. Chill the fuck out.  You don't want to draw attention to us.\"\n---\n\"Speaking of which... I can't be seen around Capitol Heights, so you're gonna have to do this next part alone.  Just look for Mark.  You got that?  Mark.\"\n\nThe train approaches our station.\n---\n\"Wait, how will I know what he looks like?\"\n\n\"I'll be waiting for you down at 104th Street Station.  Come find me there when you find your briefcase.  And don't try running off without paying me. I got eyes and ears everywhere down here, man. If you don't find me, I'll find you.\"\n---\nHe shoves me off the train onto the platform.\n",A3($elm$core$Dict$insert,"jumpTurnstileWithSkaterDude","\nHere goes nothing...\n",A3($elm$core$Dict$insert,"followSkaterDudeToOrangeLine","\n\"My guy's at Capitol Heights Station.\"\n\n\"But I don't have tickets for the orange line!\"\n---\n\"You don't need any of that. Just hop the stile. It don't cost a thing.\"\n\nWithout another word he's over the turnstile in one swift movement. No alarms sound, no security guards running.\n\nNothing.\n\n\"Come on, man. It ain't nothin. Hurry up, train's about to leave.\"\n---\nHe makes it sound so easy. But I can't just break the law.  This punk's used to it, but what if I get caught?\n\nThen again what if I don't get my proposal back?\n",A3($elm$core$Dict$insert,"forcePlayerToFollowSkaterDudeToCapitolHeights","\n\"Yo, that's the wrong train!  We're headed to Capitol Heights.\"\n",A3($elm$core$Dict$insert,"forcePlayerToFollowSkaterDudeOntoOrangeLine",'\n"Hey! Where you going? We gotta ride the orange line."\n\n"But I don\'t have a ticket."\n\n"So?"\n',A3($elm$core$Dict$insert,"helpFromSkaterDude",'\n{Aw damn!  It\'s that skater punk that\'s always goofing around my station.\n\nHe lights up a cigarette even though this is clearly a no smoking area, and gazes at me with smug amusement.\n---\n"I\'m not crying.  I\'m just... under a lot of stress."\n\n"Something of yours get snatched?"\n\n"Why would you say that?"\n---\nHe flicks ashes onto the floor.\n\n"Seen a few suits like you dragging around the pig sty. Not sure why, it\'s been closed all week.  None of \'em cried though."\n---\n"I wasn\'t-- never mind.  Did the others get any help?"\n\n"Nah, cops are never any help.  Especially today, they\'re all hung up at Broadway Station for some reason.  Your junk\'s probably been dumped in a trashcan somewhere.  That\'s what usually happens."\n\n"That\'s great!  Maybe we can still find it."\n---\nThe punk takes his time finishing off his cigarette before finally responding.\n\n"Doubt it, the bums will beat us to it.  What\'s so important about it anyway?  Just buy another one."\n\n"Damn!  No, I need to get it back at all costs. It\'s got a very important presentation in it."\n\nHe looks at me with a glimmer in his eye.\n---\n"Well...  I happen to know the bum\'s ringleader.  I could take you to him."\n\n"Yes!  Please!"\n\n"What\'s it worth to you?"\n---\n"What do you mean, you want cash?  I guess I could give you a hundred--"\n\n"A thousand."\n\n"No way, I--"\n\nHe jumps on his skate board and starts rolling away.\n\n"Wait!  OK, a thousand.  But not until I see some results.  Who do I talk to?"\n\n"Follow me. We got a train to catch."\n---\nHe rides off on his skateboard over to the orange line.\n|\n"Let\'s go, orange line\'s this way."\n}\n',A3($elm$core$Dict$insert,"findingSecurityDepotClosed","\nIt's closed. Of course it's closed! The one time I need the subway security and they're off doing God knows what.\n---\nWhat am I going to do? Everything was in that Briefcase.  My wallet, my reports, and worst of all my proposal! The key to finally turning my life around. Without it I may as well just walk in front of the next train.\n---\nI followed the rules. I pay my taxes on time. I make sure to do everything right. And people can still just up and break the law and nobody does a thing about it. Shitty people run rampant while people like me are left to suffer.\n---\nMr. Harris is going to kill me. What the hell am I going to do?\n---\n...\n---\n\"Hey, man. Are you crying?\"\n\nWho said that?\n",A3($elm$core$Dict$insert,"panic","\nWhy is this happening to me?!  I always follow the rules.  I work hard.  But I get walked over all my life.  And now some crook is going to make me miss my presentation and my promotion!  It's just not fair.\n---\nI'm going to have to take matters into my own hands.  Maybe I can find the thief and arrest him or something.\n---\nThis is a bad idea.\n\nI better just report this to the authorities somewhere.\n",A3($elm$core$Dict$insert,"ignoreGuardsAdvice","\nIf those guards at Metro Center can't help me, what are the chances that any of the other guards will be any better? Maybe I can find the thief on my own and make a citizens arrest. Or something.\n---\nThis is a bad idea.\n",A3($elm$core$Dict$insert,"followGuardsAdvice",'\n{"Someone at the Security Depot better be able to help me. I have to get my proposal back!"|}\n',A3($elm$core$Dict$insert,"SECURITY_OFFICERS",'\n"Have a nice day sir."\n',A3($elm$core$Dict$insert,"tellCommuter1AboutStolenBriefcase",'\n{COMMUTER_1.friendliness>0?\n{"Did you see a man run by with my briefcase I was carrying? He just robbed me."\n---\n"Oh my God, that\'s terrible! I think I saw someone with a briefcase like yours head for the trains. But it\'s hard to tell, there\'s so many of you business types with similar briefcases."\n\n"Oh man, I\'ve got to get it back somehow.  I\'m so screwed."\n\n"I hope you find it!"\n|\n"Did you find it yet?"\n}\n|\n{"Pardon me, miss! Did you see a man run through here with a briefcase?"\n\n"Um, yes? There\'s a lot of those around."\n---\n"No, he was a thief! He took my briefcase!"\n\n"Sorry, sir. I can\'t help you."\n---\nUseless!\n|\nShe\'s no help.\n}\n}\n',A3($elm$core$Dict$insert,"tellOfficersAboutStolenBriefcase",'\n{\n"Help! Help! I\'ve been robbed! Some crook just took my briefcase!"\n\n"I\'m sorry, but the exit is closed sir--"\n---\n"I don\'t care about that! My presentation is gone!  I need you to do something!"\n\n"Please calm down, sir. We need people to clear this station. Please take any concerns you have to the Security Depot at Spring Hill Station. We apologize for any inconvenience and hope you have a nice day."\n---\n"But I can\'t go to work with out it. My life will be over!"\n\n"Have a nice day, sir."\n---\nThey aren\'t even listening to me.  Why aren\'t they helping me?\n\nI guess I can check out the Security Depot.  Maybe they\'ll actually do something.\n|\n"Have a nice day sir."\n}\n',A3($elm$core$Dict$insert,"briefcaseStolen","\nJeez!  Someone just ran into me.\n\n\"Ow! Hey! Watch where you're going!\"\n---\nWait. Where's my briefcase?\n---\nNo. No no no no no no no no no. No.\n---\nI've been robbed... My presentation... It's gone!  I... I need to get help. Now.\n",A3($elm$core$Dict$insert,"noticeGirlInYellow","\nI can't help noticing this girl.  There's something about her, like she doesn't belong.  Her dress is the brightest thing down here.  She sticks out like a dandelion growing through the cracks in the sidewalk.\n---\nThe crowd closes around her for a second, blocking my view.  I wait for a minute, but she seems to have disappeared.\n---\nI only saw her for a split second.  Did I imagine her?\n",A3($elm$core$Dict$insert,"askCommuter1AboutDelay","\n{COMMUTER_1.friendliness>0?\n{It's that woman I saw on Monday.\n\n\"Excuse me, miss? What's going on? Why isn't anyone moving?\"\n\n\"Oh, Hi! Those security guards locked the gates. They're not budging. All they'll say is that there is some incident above ground and they're not letting anyone through.\"\n---\n\"But I can't stay here. I have to get to work.  I have an important presentation today.\"\n\n\"I know.  If I'm late one more time I'm bound to get fired.  I've got to figure out some other way out of here.\"\n|\nLooks like she's just as stuck as I am.\n}\n|\n{\"Excuse me, miss?\"\n|\nShe's ignoring me. The nerve of some people.}\n}\n",A3($elm$core$Dict$insert,"askOfficersAboutDelay",'\n{\nOh good, some officers are here.  I can find out what the hold up is.\n\n"Excuse me, ma\'am? I--"\n\nShe cuts me off mid sentence.\n---\n"This exit is closed sir. There\'s an incident going on above ground and we\'re not letting anyone through \'till we get the all clear. You will have to wait like all the others."\n---\n"But I work up there! I\'m going to be late if I don\'t--"\n\nAgain she cuts me off.\n|}\n"If you are unable to wait, take the train to the next stop and walk from there."\n\n"But I--"\n\n"Have a nice day sir."\n---\nWhy aren\'t these officers doing their jobs?\n',A3($elm$core$Dict$insert,"leavingBroadwayStationPrematurely","\nThis is my stop, where else would I need to go?\n",A3($elm$core$Dict$insert,"ANGRY_CROWD","\n{BRIEFCASE.location=PLAYER?\n{What's going on over here? No one seems to be moving and everyone seems pretty angry.\n\nSome people are shouting about the doors being locked.\n---\n|}\nI can't seem to push my way through all these angry people.  Now what?\n|\n{They haven't budged.  Apparently no one saw me get robbed.  Or they just don't care.\n---\nThe mob seems to be getting angrier. I hope they open those doors soon or this could get ugly.}\n}\n",A3($elm$core$Dict$insert,"EXIT","\n{ANGRY_CROWD.location=BROADWAY_STREET? There's a big crowd of people blocking my view, but it looks like the exits have their shutters down.  What the hell is going on here?|It's still locked.}\n",A3($elm$core$Dict$insert,"delaysAtBroadwayStreetStation",'\nEverything\'s fine. It was just a little detour, I\'ve still got time. At least I\'m wide awake now.\n---\nThe loud speaker buzzes.\n\n"Attention passengers, due to some unforeseen events you may experience delays at Broadway Street Station.  Thank you for your understanding and have a nice day."\n---\nWhat? What do they mean "delays?"\n',A3($elm$core$Dict$insert,"notGoingToWorkAgain","\nI've got to get to Broadway Street Station.  Any more wrong stops and I'm really going to be late.\n",A3($elm$core$Dict$insert,"getMap","\n{It's a map of the whole subway.{BRIEFCASE.location=PLAYER?   It's only 6:15. If I leave here now I should be able to make it to work on time.}\n---\nThere's also little map pamphlets here as well.  I'll take one with me just in case. Don't want to get lost again!\n\n(check MAP by pressing \"M\")\n|}\n",A3($elm$core$Dict$insert,"askMaintenanceManForDirections","\n{\"Excuse me, sir! How can I get to Broadway Street Station as quickly as possible?\"\n---\n\"Damn it, can't you see I'm busy?  Go and check the damn map if you're lost. It's that big map looking thing on the wall over there.\"\n---\n\"Uh, okay. Thank you.\"\n|\nHe's busy and I don't want to get yelled at again.\n}\n",$elm$core$Dict$empty))))))))))))))))))))))))))))))))))))))))))))))),$author$project$NarrativeContent$Chapter2$content=A3($elm$core$Dict$insert,"workersComplainingAboutClosuresOnTrain",'\nThree men in construction worker uniforms huddle over their coffee thermoses looking really frustrated.\n\n"How could they shut down a whole damn station? No warnin\' or nothin\'!"\n---\n"Not sure. And it\'s a big station too. Musta been pretty serious to be worth pissing off half the city. We won\'t be the only ones walking to work."\n---\n"I heard someone walked in front of a train!"\n\n"Shut up, Donny. That ain\'t true."\n\nThey all curse in unison.\n',A3($elm$core$Dict$insert,"womenTalkingAboutHotdogManOnTrain",'\n"Oh, God, what do you mean?"\n\nTwo women are speaking rather loudly in the seat behind me. Don\'t they know they\'re bugging people?\n---\n"Just like I said! I was at Twin Brooks Station and as I was boarding the train I saw a giant hot dog sitting on one of the benches, crying his eye\'s out. Such an odd thing."\n\n"What do you suppose he was crying about?"\n---\n"I don\'t know. I guess you could say I hadn\'t \'mustard\' up the courage to ask! HA!"\n\n"Oh, Hannah, you\'re terrible."\n---\nJesus Christ.\n',A3($elm$core$Dict$insert,"check_wet_jeans","\n{But maybe someone left something in there. Desperate times call for desperate measures.\n---\nUgh... They're warm...\n---\nHey, there's a quarter in the front pocket.  Jackpot!\n\nNot sure that was worth it, though. I should probably burn my hands.\n|\nWell, it worked the first time, maybe these have some money too...\n---\nYup.  The subway delivers again.\n}\n",A3($elm$core$Dict$insert,"wetPantsOnTrain","\n{The car is empty. Just me, empty seats... and what looks to be a wet pair of discarded [jeans](check_wet_jeans) lying in the seat in across from me. Ick.\n|\nThe car is empty. Just me, empty seats... and what looks to be a wet pair of discarded [jeans](check_wet_jeans)....\n\nWait a minute!  Is that the same pair?  Or are there multiple wet people without pants down here...\n|\nOh no... more wet [jeans](check_wet_jeans)!\n|\n}\n",A3($elm$core$Dict$insert,"persist_sitting_in_saved_seat",'\nI\'m tired of being pushed around! I\'m sitting down!\n\n"Out of the way, Ma\'am!"\n---\nOnce she sees that I\'m going to sit whether she\'s there or not, she slinks back into her seat and presses her back hard against the window. Her eye\'s are wide.\n\nIt pays to be a little assertive sometimes.\n---\n"You\'re sitting on him."\n---\n"YOU\'RE SITTING ON HIM!"\n\nHer screech fills the car and everyone is staring at us. Actually I think they\'re staring at me...\n---\n"HE CAN"T BREATHE, GET OFF OF HIM NOW!"\n---\nThe other passengers chime in.\n\n"C\'mon man, just move."\n"Yeah, leave her alone."\n"Just fuck off so she\'ll shut up.\nShe wasn\'t hurting anyone."\n"What an asshole."\n---\nJeesh, I just wanted to sit down, and now I\'m the bad guy?\n\nThe train stops at my stop and I run out as fast as I can.\n\nI just wanted to sit down...\n',A3($elm$core$Dict$insert,"attempt_to_sit_in_saved_seat","\n\"Pardon me, Ma'am. You're not aloud to save seats. So if you'll excuse me, I'd like to sit down.\"\n\n\"This seat's taken!  He's here!\"\n\nWho's here?  I don't see anyone in the seat.\n\n\"Get out of here!  Leave us alone.\"\n---\nHer eye's look everywhere but at me, and she now lays sprawled out over both seats. I don't think this is going anywhere.\n\nThis isn't fair though. I've a [right](persist_sitting_in_saved_seat) to that seat as much as she does.\n---\nBut in this case, it's best to slowly walk away...\n\nMy stop's coming up anyways.\n",A3($elm$core$Dict$insert,"savedSeatOnTrain","\nWow, this car is packed. There isn't a single place to sit. Just my luck.\n\nOh, there's an empty seat back there!\n---\nA strange looking woman is covering it with her hands for some reason.\n\nBut you're not supposed to save seats, so I'll just [sit down](attempt_to_sit_in_saved_seat).\n---\nOh, well. I'll just stand. I'd rather not make a scene. My stop's coming up anyways.\n",A3($elm$core$Dict$insert,"jumpTurnstileFortySecondStreet","\nOkay, the first time didn't go so hot, but maybe I can do it this time.\n\nThis is it, Steve. No turning back. It's either get this proposal back, or get fired.\n---\nNo one's looking. No guards in sight. Don't think about the consequences. Just jump and run.\n---\nHere.\n---\nWe.\n---\nGo!\n",A3($elm$core$Dict$insert,"questionJumpingTurnstiles","\nI'm not the type to jump turnstiles.\n---\nWell...\n---\nMaybe I should [jump anyway](just_do_it).\n",A3($elm$core$Dict$insert,"tryToJumpTurnstileWithRepairManWatching","\nI can't jump it with that repair guy here, he'll report me.\n",A3($elm$core$Dict$insert,"passageLocked","\nI guess it locked behind me. No going back now.\n",A3($elm$core$Dict$insert,"confrontConductor",'\nI know what it is, he looks like the security guard who yelled at me before.  But now he\'s a repair man?\n\nI shout out to him.  "Hey, excuse me!"\n---\nHe doesn\'t turn around.  I call out again.\n---\nHe stops what he is doing and looks around.\n\nI do know this guy.\n\n"Aren\'t you that guy from Central Security?"\n\n"Nope."\n---\n"You bailed me out, remember? Gave me an Orange pass and everything?"\n\n"Nope."\n---\nWhat\'s going on here?  There\'s no mistaking it. This is him.  It\'s hard not to remember that grizzle.\n\n"What are you doing here? And what\'s up with the uniform?"\n---\nHe finally looks me in the eye and his expression changes.\n\n"You ever think about what runs these trains?"\n\n"Uh, no. Not really."\n---\n"Well maybe you should."\n\nWith that he takes off, heading deeper into the tunnel for the oncoming train.\n---\nWhat the hell just happened?\n',A3($elm$core$Dict$insert,"catchConductorMessingWithPanel","\nHe tinkers away on an electric panel on the wall.\n---\n...\n---\nThere's [something](confront_repairman) about that guy...\n",A3($elm$core$Dict$insert,"SECURITY_CAMERA_FORTY_SECOND_STREET","\n{You know, I'm surprised I never noticed these before.\n|}\nThey must have this whole place under surveillance.\n{---\nMaybe I can locate the thief and see where he goes if I can find the security footage.  They must have a surveillance room down here somewhere.|}\n",A3($elm$core$Dict$insert,"ELECTRIC_PANEL","\nHmm... the lock is busted.  Lots of wires and blinking lights inside.  This is the panel that odd repairman-slash-security guard was messing with...\n",A3($elm$core$Dict$insert,"exitPassagewayAtFortySecondStreet","\nThis passageway lets out in a different station.\n\nI don't see the thief anywhere though.  Maybe he outran me?  Or took a different turn?\n",A3($elm$core$Dict$insert,"chaseThiefAgain","\nThere's a big \"DO NOT ENTER\" sign.  But the door is unlocked...\n---\n*Creak*\n---\nThis leads to a dark, dank, twisty passage.\n---\nWhat the hell, I'm going for it.\n",A3($elm$core$Dict$insert,"collectedEnoughChangeToCallBoss",'\nI have the change. Guess there\'s no more avoiding it.\nHere we go.\n---\n*Ring* *Ring*\n---\n"Hello, this is In your Hands Insurance Agency, how may I direct your call?"\n\n"Hey Paula, this is Steve. Can I-"\n---\n"Steve? Steve who? You\'re going to have to be a little more specific, sir."\n\n"Steve. Steve Kerry. Insurance agent, office 213. We talked about your cat for like, twenty minutes in the break room last week."\n---\n"Okay Mr. Perry. How may I direct your call?"\n\n"Can I speak to Mr. Harris please? It\'s very urgent."\n\n"Mr. Harris is very busy, sir. What is the nature of the call?"\n---\n"Dammit Paula, just put Jason on the phone, will you?"\n\nShe murmurs something unpleasant, but makes the transfer.\n---\nOkay, so what do I say? My briefcase and proposal were stolen, please don\'t fire me?\n\nI can feel his hands around my throat already. Damn it.\n---\n"Where the HELL are you with my proposal, Steve?"\n\n"Ah! Good morning Mr. Harris!"\n---\n"Cut the bullshit. You were supposed to be HERE an hour and a half ago --".\n\n"About that sir... I\'ve had a little trouble..."\n---\nMr. Harris goes into a rant before I can explain any more.  He is yelling so loud that I have to hold the phone away from my ear.\n\nA train pulls onto the platform.  The only passenger that exits is an odd looking man in a pulled up blue hoody.\n\nWe\'re the only two on the platform and he gives me a once-over.  Mr. Harris keeps yelling.\n---\nThis guy looks familiar.\n\nIt\'s the thief!\n---\n"That\'s the guy-- hey stop!"\n\nThe thief recognizes me too and turns and runs.  Mr. Harris stops his tirade in surprise.\n\n"What did you say to me Steve?  You want me to stop?  Why don\'t you--"\n\n"Sorry Mr. Harris, I have to run.  I\'ll see you with the proposal very soon.  Bye!"\n\n*CLICK*\n---\nThe man disappears around a concrete pillar.\n\nI chase after him, just in time to see him dash through an obscure maintenance door.\n\nI want my briefcase back.\n\nI\'m going after him.\n',A3($elm$core$Dict$insert,"useChangeFromMotherToCallBoss",'\nI\'ve got this change from that woman with the annoying kid. It\'s just 50 cents, she probably won\'t miss it. Plus that kid is probably better off without all that sugar.\n---\n*Ring* *Ring*\n---\n"Hello, this is In your Hands Insurance Agency, how may I direct your call?"\n\n"Hey Paula, this is Steve. Can I-"\n---\n"Steve? Steve who? You\'re going to have to be a little more specific, sir."\n\n"Steve. Steve Kerry. Insurance agent, office 213. We talked about your cat for like, twenty minutes in the break room last week."\n---\n"Okay Mr. Kerry. How may I direct your call?"\n\n"Can I speak to Mr. Harris please? It\'s very urgent."\n\n"Mr. Harris is very busy, sir. What is the nature of the call?"\n---\n"Dammit Paula, just put Jason on the phone, will you?"\n\nShe murmurs something unpleasant, but makes the transfer.\n---\nOkay, so what do I say? My briefcase and proposal were stolen, please don\'t fire me?\n\nI can feel his hands around my throat already. Damn it.\n---\n"Where the HELL are you with my proposal, Steve?"\n\n"Ah! Good morning Mr. Harris!"\n---\n"Cut the bullshit. You were supposed to be HERE an hour and a half ago --".\n\n"About that sir... I\'ve had a little trouble..."\n---\nMr. Harris goes into a rant before I can explain any more.  He is yelling so loud that I have to hold the phone away from my ear.\n\nA train pulls onto the platform.  The only passenger that exits is an odd looking man in a pulled up blue hoody.\n\nWe\'re the only two on the platform and he gives me a once-over.  Mr. Harris keeps yelling.\n---\nThis guy looks familiar.\n\nIt\'s the thief!\n---\n"That\'s the guy-- hey stop!"\n\nThe thief recognizes me too and turns and runs.  Mr. Harris stops his tirade in surprise.\n\n"What did you say to me Steve?  You want me to stop?  Why don\'t you--"\n\n"Sorry Mr. Harris, I have to run.  I\'ll see you with the proposal very soon.  Bye!"\n\n*CLICK*\n---\nThe man disappears around a concrete pillar.\n\nI chase after him, just in time to see him dash through an obscure maintenance door.\n\nI want my briefcase back.\n\nI\'m going after him.\n',A3($elm$core$Dict$insert,"girlInYellowSecondEncounter","\nIt's that girl again!  She really sticks out down here.  Oh, she sees me.\n---\n\"Excuse me sir, would you like to buy some flowers? Only 50 cents for a bundle.\"\n\nShe hold up a cardboard box with bunches of various weeds and flowers held together by rubber bands. They look like they were plucked from every public garden and sidewalk crack in the city.  Not worth 50 cents.\n---\nSuddenly she spots someone behind me.  A moment of worry crosses her face, then she giggles and dashes away.\n\nI turn around to see who startled her.  It's just a maintenance person.\n---\nWhen I turn back, she has completely disappeared!\n---\nWhere did she go?\n\nAm I imagining things?\n",A3($elm$core$Dict$insert,"stealMusiciansChangeSecondTime",'\nI guess another quarter might be useful...\n---\nThe musician suddenly speaks in a surprisingly low voice, "Stealing from a blind man.  I guess you need that more than I do."\n---\nShit!\n',A3($elm$core$Dict$insert,"stealMusiciansChange","\nI snatch two dirty quarters from the top of the pile and pocket them quickly so no one sees.\n\nThe violinist keeps on playing.\n---\nThis isn't right, but it is just 50 cents. He's probably not even going to notice that it's missing. I mean, how could he?\n",A3($elm$core$Dict$insert,"ABANDONED_JACKET","\n{PLAYER.call_boss=1?\n{Maybe I'll just check the pockets for change. I mean, it'll probably just get thrown out anyway.\n---\n...\n---\nNope, nothing. Ah, well. It was worth a look anyways.\n|\nThe pockets are empty.  No change in here.\n}\n|\n{It's lying on the bench like someone just forgot it. It's pretty worn out so I sort of doubt they'll be coming back for it.\n|It's just a discarded jacket. Nobody's coming back for it.}\n}\n",A3($elm$core$Dict$insert,"throwAwayPosters","\nI'll just toss these posters in here. I mean, I've got more important things to do than looking around for \"Jonathan.\"\n",A3($elm$core$Dict$insert,"askBusinessmanForChange",'\n"Say, you don\'t happen to have 50 cents, do you?"\n\n"And what have you done to earn, may I ask?"\n---\n"No, I just need 50 cents for the--"\n\n"I didn\'t ask what you needed it for, I\'m asking what you\'ve done to deserve it."\n---\nWhat the hell?\n---\n"Listen, I--"\n\n"No, you listen. Pay is given to those that work. Sitting on your ass begging people for money is not work. You think I got to where I am today by "asking" for what I wanted?"\n---\n"Forget about it. I can--"\n\n"No, I worked for what I wanted and took it. Success is not founded by beggars, but by choosers."\n---\nBefore I can say another word, the man steps through the turnstile and doesn\'t look back.\n\nWhat an asshole.\n',A3($elm$core$Dict$insert,"tryToHangRedundantDogPosters","\nI've got a few posters left, but this station already has one.\n",A3($elm$core$Dict$insert,"tryToHangDogPosterOnWrongLine","\nThat lady in the pink poncho wanted me to hang these on the Red line.\n",A3($elm$core$Dict$insert,"putUpLastMissingDogPoster","\nThis station doesn't have a poster yet.  Here, I'll hang one up now.\n\nThere, that's the last one.  Hope someone finds \"Jonathan.\"\n",A3($elm$core$Dict$insert,"putUpMissingDogPoster","\nThis station doesn't have a poster yet.  Here, I'll hang one up now.\n",A3($elm$core$Dict$insert,"lookAtHangingDogPosters","\n{How sad!  He must be so scared down here.  |\nSays the dog's name is Jonathan. Weird name for a dog.\n|\nMaybe I should make one of these for my briefcase.\n\nNaw, that's stupid. These things never work.\n|\n$3000 reward? Damn, I'm in the wrong business. How would \"Dog Bounty Hunter\" look on a business card. Hmmmm...\n|\nI wonder if he's been found yet.\n}\n",A3($elm$core$Dict$insert,"getDogPostersFromDistressedWoman","\nShe's wearing a pink poncho, maybe she's expecting rain in the subway?\n\nOh no, she's walking towards me.  I look away.\n---\n\"Oh, thank goodness. You look like a capable young man. Could I ask for an itsy bitsy favor from you? It won't take long, and you'd be saving a life.\"\n---\nShe shoves a handful of posters at me.\n\n\"Thanks!  I lost my little dog, Jonathan, down here.  I'm hanging up these posters hoping someone will find him.  Just hang these up on the Red Line for me.\"\n\nBefore I can respond she dashes after someone else.\n",A3($elm$core$Dict$insert,"tryingToCallBossWithCellphone","\nI still don't have any service down here.  I'd have to go above ground to make a call.  I guess I could do that, but I'm in no hurry.  And it's probably raining.  And this is my big opportunity to use a payphone for once.\n",A3($elm$core$Dict$insert,"readyToCallBoss","\nMr. Harris has probably given up on me.  I guess I could stay down here all day.\n---\nAll week...\n---\nAll year?\n",A3($elm$core$Dict$insert,"ponderingCallingBossOnTrain","\n{Mr. Harris is going to hate me.  I'm really not looking forward to calling him.\n|||\nMr. Harris is still waiting.  I should probably call.\n---\nWell, I guess I can put it of a little longer.\n||||\nI've spent a lot of time down here.  I better get back to Mr. Harris.\n}\n",A3($elm$core$Dict$insert,"needCoinsForPayphone","\n{Hmm, there's no dial tone.\n---\nOh yeah, you've got to pay for these things.  Shoot, and I don't have enough change.  No wonder they're disappearing.\n---\nGuess I'll have to ask around for change. I mean, how hard can it to be to get 50 cents?\n---\nI'm not really in any rush to talk to Mr. Harris anyways.\n|\nIt costs 50 cents to use. Better start begging for change.  I'm going to need the practice.\n}\n",A3($elm$core$Dict$insert,"checkBroomClosetButNotBriefcase","\nI finally made it. This is my last chance. It has to be in here.\n---\n*Click*\n---\nWell, it's unlocked.\n---\n*Creeeeeeaaak*\n---\nIt's dark, but I don't need to flip the switch to see that there's nothing in here but cleaning supplies.\n\nOf course there's nothing in here. What was I expecting?\n---\nDamn I wanted it to be true.\n---\n...\n---\nMy proposal is gone, and without that, no promotion. Hell, who am I kidding?  It's way past 6:30, I probably don't even have a job anymore.\n---\nI guess it's time to call Mr. Harris and tell him what happened.  I better find a phone.\n---\nDamn, and I was so close to that promotion. I would have had it made.\n",$elm$core$Dict$empty)))))))))))))))))))))))))))))))))))),$author$project$NarrativeContent$General$content=A3($elm$core$Dict$insert,"showFeedbackDialog","\nHello player!  I am Jeff, the game's designer and developer. \n\nI hope you are enjoing playing so far!\n---\nI just want to let you know that you've reached the end of the content that includes AI characters that you can chat with.\n\nI will be adding more AI characters soon.  You can continue playing now if you want, but you may wish to use the Notebook to save the game here so you can return to this point later.\n---\nBy the way, how do you like the game so far?  Do you have any feedback?\n\n",A3($elm$core$Dict$insert,"maintenanceManAtOneHundredFourthStreet","\n{He looks to be working indiscriminately on a wall of pipes. Taping here, hammering there, lots of wrenching. It doesn't look like much is being fixed though, in fact this whole station seems like a Case 27B - 6 waiting to happen.  Maybe I should leave my card.\n---\nHe doesn't seem to notice me, but he's muttering to himself, something about \"this whole damn place is falling apart.\"\n\nBetter give him his space.\n|\nNow he's either hammering a very rusty pipe or wrenching a bent nail.\n|\nMaybe I should offer him a hand.\n---\nHa ha, good one Steve!\n---\nWhy am I so fascinated with his maintenance guy?\n}\n",A3($elm$core$Dict$insert,"FLUORESCENT_LIGHTS","\n{~Ugh, it's giving me a headache.\n|\nHow hard is it to get someone out here to fix this thing?\n|\nIt. Won't. Stop. But I can't look away.\n}\n",A3($elm$core$Dict$insert,"CONSTRUCTION_AREA","\nHalf of the platform is draped in yellow tape and littered with orange cones. I remember hearing about this hefty construction project going on around here, but at this rate they're never going to finish.\n",A3($elm$core$Dict$insert,"TROPICAL_T_SHIRT_MAN","\nHe easily stands out from the crowd and he looks to be utterly lost. Maybe he's from out of town?\n---\n{He's got a map, but it doesn't seem to be doing him much good. He just keeps looking from his map to the signs overhead.\n---\nI like his shirt though.\n|\nHe still looks lost.  I'm just getting the subway layout figured out myself.\n}\n",A3($elm$core$Dict$insert,"CUSTODIAN","\n{He's asleep on a bench.  This place is a wreck! How does he still have a job?\n|\nHe's asleep. He should really do his job.\n\nI'm going to wake him up.\n---\nNo, I can't do that.  Maybe he's just on his break.\n|\nWow, still on break.\n}\n",A3($elm$core$Dict$insert,"NEWSPAPER_VENDING_MACHINE","\nThe door's been forced open and all the papers cleaned out. Didn't think anyone read the paper anymore, let alone stole them.\n",A3($elm$core$Dict$insert,"OVERTURNED_TRASHCAN","\n{~Looks like someone kicked it over. Half eaten food, stained newspapers, and other junk are splayed over the platform. Why do people have to be so senselessly destructive?\n|\nI'm not going to clean it up. Who knows what that stuff is covered in.\n}\n",A3($elm$core$Dict$insert,"ADVERTISEMENT","\nIt's a giant poster advertising a hot new off-road vehicle. Four wheel drive, the highest safety test awards, great gas mileage, and... out of the price range of anyone one who steps foot in the subway.  Who do they think their selling to?\n",A3($elm$core$Dict$insert,"FAKE_COP","\n{Oh my god, it's a police officer! I'm saved! He has to help me!\n\n\"Officer! Officer! I need your help!\"\n\nI tell him the whole story. My proposal, the missed stop, the thief. I even spill about jumping the turnstile. I don't care, I just need help.\n---\nHe doesn't say a word while I talk. It's tough to read him with his aviators on, but I think he's really listening.\n\nI finally finish and he stays quiet for a minute, then he takes off his sunglasses.\n---\n\"Wow, man. That's a crazy fucking story. What are you going to do?\"\n\n\"Uh, I thought you could help. You're a cop. You help people!\"\n---\n\"Oh... Oh! You're talking about my costume! Sorry, man, I ain't no cop. I'm on my way to my girlfriends costume brunch party. I told her this was fucking weird, but women, am I right bud?\"\n\n\"God damn it. I've got to go.\"\n\n\"Well, hey man, good luck finding your ring or whatever!\"\n|\nIt's not a police officer. It's just an idiot in a costume.\n}\n",A3($elm$core$Dict$insert,"MAGAZINE_STAND","\n{~Biking, cars, computers, tabloid gossip. There's a zine for everything.\n|\nMaybe I should get a hobby. Golf? No. Guns? Nah ah. Cars?\n\nI think I'll just stick to doing nothing.\n|\n\"End of the World? Top 10 Reasons Why You Should Be Very, Very Afraid.\"  Wow, they'll really try anything to get you to buy these tabloids. Resorting to top ten lists. Yeesh.\n|\nThe old man smiles toothily at me he sits behind the rack of magazines. I think he wants me to buy something.\n}\n",A3($elm$core$Dict$insert,"SECRET_SERVICE_TYPE_GUY","\n{He's just standing against the wall, not doing anything. He doesn't even react to the passing crowds or trains. If he's trying not to look suspicious, he's not doing a very good job.\n|\nOh shit, I think he's watching me. Eeek!\n}\n",A3($elm$core$Dict$insert,"COMMUTERS_ST_MARKS","\nVarious people come and go through the busy station.\n",A3($elm$core$Dict$insert,"BIRD","\nIt's flying all over the place, barely missing the passing commuters. I'm not sure how it got in here, but it seems scared. Hopefully it finds it's way out.\n",A3($elm$core$Dict$insert,"MURAL","\nIt's a mosaic mural made out of many different colors of glass. I think it's supposed to be some type of abstract piece, because I can't make out what it's supposed to be. It looks pretty though. I think.\n",A3($elm$core$Dict$insert,"CENTRAL_GUARD_OFFICE_ENTRANCE","\nI really dodged a bullet there, I have no desire to go back.\n",A3($elm$core$Dict$insert,"coffee_ruined",'\nI toss a quarter in the cup.\n---\n*SPLASH*\n\n"Hey, what the fuck, asshole? That was my coffee!"\n\n"Oh, I\'m sorry! I thought-"\n---\n"Just fuck off, will ya?"\n---\n...\n---\n"Um... could I have my quarter back?"\n---\nHe just scowls.  Guess not.\n',A3($elm$core$Dict$insert,"SLEEPING_MAN","\n{SLEEPING_MAN.coffee_ruined?  At least he didn't ask me to get him another coffee.\n|\nHe's sitting on the ground with a shabby hat drawn over his face he's got a Styrofoam cup in front of him. Looks like he could use some {CHANGE.location=PLAYER.amount>0? [change](help_a_guy_out) | change}.\n}\n",A3($elm$core$Dict$insert,"LIVING_STATUE","\nKind of cool... I bet they are really bored.\n",A3($elm$core$Dict$insert,"OLD_LADIES",'\n{"...the state of this city has really gone down hill since-"\n\n"I agree, all the radio talks about anymore is the homeless crisis-"\n\n"And the crime rate."\n\n"Did you hear about that man that jumped off that bank building yesterday? Laid on the side walk for nearly an hour before-"\n|\n"-nothing new, Maggy was nearly run down on MacArthur Street last week on her way to the bridge game."\n\n"-probably a drunk driver.  I heard there\'s more of them these days than-"\n|\n"Go, go, go. That\'s all these people know how to do."\n\n"-can\'t live that way."\n\n"- won\'t last long."\n\n"When\'s our train getting here? It\'s always late."\n|\nThey\'re still chattering without a single pause. I bet a single second of silence would drive them mad.\n}\n',A3($elm$core$Dict$insert,"TRASHED_NEWSPAPERS","\n{It's a pile of trashed newspapers by a bench. They look pretty gross.  Hey, what's that? There's something in there.\n---\n...\n---\nAHH!\nIT\"S A FUCKING RAT!\n|\nNO!\n------------------------------------------\nNEVER!\n|\nGAH!\n}\n",A3($elm$core$Dict$insert,"MAINTENANCE_DOOR_IRIS_LAKE_TO_WEST_MULBERRY","\nIt's locked.\n",A3($elm$core$Dict$insert,"GRAFFITI_IRIS_LAKE","\n{It covers one of the walls from floor to ceiling. This station looks severely unused, but how can the authorities just leave this here?\n|\nThese things are always so hard to read. Most of it illegible but I can make out the words \"Wild West\". I can't be sure though. If you're going to break the law, why not at least make what you're saying legible?\n}\n",A3($elm$core$Dict$insert,"CONCERT_POSTER","\n{It's a poster for some kind of concert. Not sure what type of music it is, but telling from all the skulls, tigers, and half naked women colorfully scribbled in the margins I don't think I'd like it very much.\n|\nIt's a poster for a rock concert, or something. I'm not much for music.\n}\n",A3($elm$core$Dict$insert,"check_coin_return","\nMaybe there's some change left in the coin return, let me check.\n---\n...\n---\nHey, a quarter!  Nice.\n",A3($elm$core$Dict$insert,"VENDING_MACHINE","\nIt's an old snack machine. I don't recognize any of these brands. How long has it been since they changed these out? Ugh.\n",A3($elm$core$Dict$insert,"FRANKS_FRANKS","\n{MAN_IN_HOT_DOG_SUIT.job_hunt_quest_1>1?\nI may have helped one get a job, but I still don't like hot dogs.\n|\nI'm not really a hot dog guy.}\n",A3($elm$core$Dict$insert,"BUSINESS_MAN","\nHe looks busy.\n",A3($elm$core$Dict$insert,"inspectPasses","\nI have a Red Line Pass{ORANGE_LINE_PASS.location=PLAYER? and an Orange Line Pass}.\n\n{It gets me anywhere on the Red Line, but I really only use it to get to work and back home.|}\n\n{ORANGE_LINE_PASS.new?\nI got the Orange Line Pass from the security guard guy.  Now I can ride the Orange Line without getting caught.\n}\n",A3($elm$core$Dict$insert,"PAYPHONE_SEVENTY_THIRD_STREET","\nIt's a payphone. Not much use for those things anymore with everyone having cellphones these days.\n",A3($elm$core$Dict$insert,"BROOM_CLOSET","\nIt's just a broom closet. Plenty of toilet paper and cleaning products, but no briefcase.{ If I ever see that Mark guy again, I swear, I'll...  I won't do anything. I'll probably be squatting next to him in a week or so.|}\n",A3($elm$core$Dict$insert,"SECURITY_DEPOT_SPRING_HILL_STATION","\nIt's closed. It's good to see where my tax dollars are going.\n",A3($elm$core$Dict$insert,"MAINTENANCE_MAN","\nHe's still at it, fixing the... well, whatever it is he's fixing.\n",A3($elm$core$Dict$insert,"MARCYS_PIZZA","\nI haven't eaten here before, but it looks popular.  It's packed, even this time of day.\n",A3($elm$core$Dict$insert,"BUSTLING_CROWD",'\n{Wow, this station is crowded. Everyone seems to be rushing off to somewhere.|\n{?"Hey, watch it!" |\n"Excuse me. Pardon me."|\n"Make way, I\'ve got a train to catch."\n}}\n',A3($elm$core$Dict$insert,"BROKEN_PAYPHONE","\n{Now that everyone's got cell phones, there's not much use for those things any more.  That's just as well, it's |Well, it used to be a payphone. Now it's } just a gutted payphone stand with stray wires poking out.\n",A3($elm$core$Dict$insert,"MUSICIAN","\nHe's playing an old cracked violin with a hat out in front of him for spare change.\n\nHe has a sign: \"Blind, Homeless Veteran. Anything helps. God Bless.\"\n\nThe music sounds nice, but I wouldn't call that a real job.\n{PLAYER.call_boss>0?\n---\nThen again, he's got quite a lot of [change](musicians_change) in his hat.\n|}\n",A3($elm$core$Dict$insert,"DOLLAR_BILL","\nA wrinkled dollar bill.\n",A3($elm$core$Dict$insert,"CHANGE","\nI have {CHANGE.format_amount} in change.\n",A3($elm$core$Dict$insert,"SODA","\nThis soda is probably really old and gross.\n",A3($elm$core$Dict$insert,"SCHOOL_CHILDREN","\n{A few children play some kind of game on one of the benches. One kid stands tall on the bench laughing and jeering while the other children scamper around below, clawing and grabbing at him.\n---\nAn unspoken rule seems to keep them from just climbing on the bench and pushing him off. But after a few attempts, one of the kids manages to grab his arm and tugs hard, bringing the standing boy down on top of him. A scream, a crash, then laughter and the kids are picking themselves up and scurrying towards the bench again, fighting to see who gets to stand on the bench next.\n---|}\nChildren aren't supposed to be down here unsupervised. And that game looks dangerous. Where are their parents?\n",A3($elm$core$Dict$insert,"WOMAN_IN_ODD_HAT",'\n{She\'s dressed very finely and has an air about her that seems to scream "High class." Her hat resembles some kind of bird or a very angry fern.\n---\n"Pardon me, Ma\'am. I--"\n\n"I haven\'t got any change."\n\n"No, I was actually--"\n\n"I haven\'t a clue of the time either. Please leave me alone."\n---\n"I just--"\n\n"Leave me be" she snorts as she turns her back to me.\n\nI guess that\'s that.\n|\nI\'m not going to try to talk to her again.\n}\n',A3($elm$core$Dict$insert,"DRINKING_FOUNTAIN","\n{?\nNo.\n|\nNot in a million years.\n|\nI'll never be thirsty enough to risk drinking from that.\n|\nI can see a piece of chewed bubble gum stuck to the spout.\n}\n",A3($elm$core$Dict$insert,"MISSIONARIES",'\n{\nOne of them tries to get my attention.\n\n"You look like you\'ve lost something important."\n---\n"Uh... yeah. How did you guess?"\n---\n"You look like all the others, so many people wandering around in this world, looking for themselves.  Well I can help you, I\'ve got this wonderful pamphlet that I\'d like to share with you..."\n---\n"Oh, sorry. I\'ve got to run. My, uh, my train is about to leave."\n---\n"Just take a pamphlet with you!"\n|\nI should have known. I fell right into that.\n}\n',A3($elm$core$Dict$insert,"trashcan","\n{?I'm not about to rummage through the trash.\n|\nI've got a weird feeling about this can. Maybe it wouldn't hurt to take a quick look.\n---\n...\n---\nNothing but trash.\n|\nWaste of time.\n|\nWonder who takes out the garbage down here.\n|\nJust garbage.\n|\nThere's nothing but junk in here. Just as it should be.\n|\nNothing but trash in here.\n}\n\n---\n\n{*.missing_dog_poster.location=PLAYER?\nI'm lugging around these missing dog posters.  I don't want to go hang them all up, maybe I should just [throw them away](throw_away_posters) instead.\n}\n---\n{MASCOT_PAPERS.location=PLAYER?\nThis resume is a joke.  Even if I deliver it nobody's going to hire this guy.  Maybe I should do him a favor and just [toss it](throw_away_mascot_papers).\n}\n",A3($elm$core$Dict$insert,"BULLETIN_BOARD","\n{Maybe somebody has posted about my missing briefcase.\n---\nNope, nothing.  Darn.|\nStill nothing about my briefcase, but if I'm ever in need of a house cleaner or want to join a lame garage band, I know where to look.}\n",A3($elm$core$Dict$insert,"SOGGY_JACKET","\n{I don't really have time to look at every piece of discarded junk in the subway. My proposal is gone, my life is falling apart.  Maybe I should focus on that.|Gross.}\n",A3($elm$core$Dict$insert,"outOfServiceStations","\nPLEASE NOTICE: Normal service disruption is in effect.\n\n{$.name} Station is temporarily out of service.  Please use alternative options.\n\nThank you and we apologize for the inconvenience.\n",A3($elm$core$Dict$insert,"jumpTurnstileFail","{?I'm not the type to jump turnstiles.|I don't want to get caught.|Better to stick to the lines I have passes for.}",A3($elm$core$Dict$insert,"SAFETY_WARNING_POSTER",'\n"ATTENTION: Pickpockets and thieves operate in this area. Report any suspicious behavior to your nearest Security Guard Station"\n{---\nThat\'s just great.  I wish people would just follow the rules.\n|}\n',A3($elm$core$Dict$insert,"COFFEE","\n{PLAYER.day=1?  Carl's Coffee has been fueling me for years. Can't imagine surviving a Monday without it.}\n{PLAYER.day=2?  Mmm, that's good coffee.}\n{PLAYER.day=3?  I'm going to need a barrel of this if I'm going to get this proposal done by Friday. What is Mr. Harris thinking?  }\n{PLAYER.day=4?  It tastes bitter.}\n",A3($elm$core$Dict$insert,"PAYPHONE_EAST_MULBERRY","Huh, doesn't even work.",A3($elm$core$Dict$insert,"GRAFFITI_EAST_MULBERRY","That's just vulgar.  Why do people have to mess things up?",A3($elm$core$Dict$insert,"ORANGE_LINE_PASS","I got this from the security guard guy.  Now I can ride the Orange Line without getting caught.",A3($elm$core$Dict$insert,"RED_LINE_PASS","This gets me anywhere on the Red Line, but I really only use it to get to work and back home.",A3($elm$core$Dict$insert,"notebookInstructions","\n{I have my notebook with me today to keep track of everything.\n\n(Click the notebook icon or press 'n' to toggle the notebook from now on)\n|}\n",A3($elm$core$Dict$insert,"BRIEFCASE","My portable office, all my work is in it.",$elm$core$Dict$empty))))))))))))))))))))))))))))))))))))))))))))))))))))))))),$author$project$NarrativeContent$Quests$content=A3($elm$core$Dict$insert,"man_in_hot_dog_suit_wants_more",'\n"Thanks, bud. You won\'t regret this!"\n',A3($elm$core$Dict$insert,"hot_dog_man_rebuffed","\n{\"What did Frank say?  Did he say anything?  Did he turn me down?  Oh no, he turned me down, didn't he.  I'm a failure.  I'll never be a hot dog man.  Ohhhhhh.....\"\n|\nThe guy is still crying.  What a weenie.\n}\n{||Heh heh.  Weenie.}\n",A3($elm$core$Dict$insert,"throw_away_mascot_papers","\nThere.  Who makes a resume to be a hot dog anyway?\n",A3($elm$core$Dict$insert,"check_up_on_hot_dog_guy_at_franks_franks","\nWow, he got here fast.\n\nHe's already at it.  Looks like he's having the time of his life.  But everyone mostly ignores him.  At least he's happy.\n\nHe's coming over to talk to me.\n---\n\"Oh, man. I didn't think I'd get the chance to thank you! But... Thank you! You don't know how much you've just changed my life!\"\n\nHe hugs me tight.\n\n\"Uh, don't mention it. Please.\"\n---\n\"Oh, and here's a little tip someone gave me, it's all yours for the help you're doing me.\"\n\nHe drops 2 quarters in my hand and waves as he rushes back to his stand.  Is this what he meant by \"worth while?\"\n",A3($elm$core$Dict$insert,"give_mascot_papers_to_frank",'\nThe stand is greasy looking and the man behind it even greasier.\n\n"Yo, wanna \'dog? Only a buck fifty."\n---\n"No thanks, but are you Frank? I... uh... hear you\'re looking for a hot dog guy."\n\n"Oh yeah? What experience you got?"\n\n"Oh!  No, not for me. It\'s for my... client. A real stand-up guy.  Here\'s his resume."\n---\nFrank looks it over and whistles.\n\n"Hey, this looks good.  You cant imagine the weirdos that try to get this sort of gig. I\'ll give him a ring."\n---\nWell, Steve, today you\'re going to make a weirdo very happy. Good on you.\n',A3($elm$core$Dict$insert,"MASCOT_PAPERS","\nResume for the man in the hot dog suit.\n\nWow, he means business.\n",A3($elm$core$Dict$insert,"meet_the_man_in_the_hot_dog_suit","\n{It's a man... in a grubby looking hot dog suit.\n\nI guess I've seen weirder things down in the subway.\n\nBut... it looks like he is... crying?\n---\n\"DON'T LOOK AT ME!\"\n\n\"I'm sorry.  Are you... are you alright?\"\n\nHe looks up at me and his face brightens up.  He pats the bench for me to join him, but the size of his suit makes it hard to sit. I think I'll just stand.\n---\n\"Listen, buddy. You ever feel like no matter how hard you try, the world manages to find new ways of bringing you right back down?\"\n---\n\"Well, actually--\"\n\n\"I know! Like take me for instance. I've been at this mascot game for years. I've done baseball games, sign flipping, children's pizza play houses. I've been around the rotisserie and back again. But this was my one chance. A chance for the big times.\"\n---\n\"Listen, I really don't have time for this. I've got my own problems right now.\"\n\n\"Hey just hear me out. I'll be brief.  I need to get a job at a hot dog stand, but I can't without a respectable reference to butter me up.  You look like a respectable sort.  Will you be my representation?\"\n---\nThat's my cue to slowly walk away...\n\nBut the guy jumps up and tosses his resume in my hands.\n\n\"Listen, stop by Frank's Franks on University Station.  Ask for Frank, drop off my papers, tell him I'm a swell guy.  Do this for me and I'll make it worth your while.\"\n---\nWhy does this keep happening to me? Am I a freak magnet or something?\n\n\"Thanks, bud. You won't regret this!\"\n|\n\"Hey, did you talk to Frank at Frank's Franks for me yet? I can't just sit around on my buns all day!\"\n}\n",A3($elm$core$Dict$insert,"ratty_hat_man_advice_5","\n\"Hey you!  I've been on a wild goose chase all over this subway system following your nonsense advice.  Have you seen my briefcase or haven't you?\"\n---\n\"Briefcase?  I haven't heard of any briefcase.  You really shouldn't talk to strangers.  Now if you'll excuse me, I have to go.\"\n",A3($elm$core$Dict$insert,"ratty_hat_man_advice_4",'\nOh no, not again.\n---\n"Brief case.  Thief\'s face.  Safe place.  Iris Lake."\n',A3($elm$core$Dict$insert,"ratty_hat_man_advice_3",'\nThere he is again.\n\n"Proposal.  I\'ve got a proposal.  A proposal to make."\n\n"Ok, I\'ll bite."\n---\n"My friends, they know.  Samual, Walter and Mark.  Go to them.  Say hello."\n',A3($elm$core$Dict$insert,"ratty_hat_man_advice_2","\nHey, it's that guy again.  Oh no, he saw me.  Now he's approaching me.\n---\n\"I have your case.\"\n---\n\"Wait, what?\"\n---\n\"Forty third.  That's where it's at.  That's where it's all at.\"\n\nAgain, he dashes away.\n",A3($elm$core$Dict$insert,"ratty_hat_man_advice_1",'\nHe\'s staring at me from across the room and mumbling to himself.\n\nWait a minute, did he just say something about a briefcase?\n---\n"Excuse me, I thought I just heard you mention--"\n\nHe holds up his finger with the utmost importance.\n\n"Holds your things.  That\'s what you need.  A place to hold your things.  Where are your things?"\n\n"Um... my briefcase was stolen.  Do you know something?"\n---\n"Ah... briefcase!  Yes.  West Mulberry.  East.  No, West.  Mulberry.  Yes."\n\n"Are you saying you saw it at West Mulberry?"\n\n"West Mulberry.  West Mulberry."\n\nWith that he turns and scampers away.\n',A3($elm$core$Dict$insert,"noMoreScreamingChild","\nThe kid has stopped screaming and the mother looks very relieved.  So am I.\n",A3($elm$core$Dict$insert,"giveSodaToScreamingChild",'\nHere\'s your soda. I didn\'t know what flavor to get."\n\nWithout hesitation the child snatches the can from my hand and starts guzzling it down.\n\n"Thank you so much!  Nice to know there are still decent people around."\n',A3($elm$core$Dict$insert,"getSodaForScreamingChild","\nI put 50 cents in and a soda comes out.  Hope it's the right flavor.\n",A3($elm$core$Dict$insert,"keepBotheringMother",'\n{"Did you find any soda?"\n\n"Um... not yet."\n|"So are you going to get me a soda or not?"\n}\n',A3($elm$core$Dict$insert,"offerToHelpScreamingChild",'\n"Hey, I could go get you a soda if you want..."\n---\n"Oh my God, yes, please!  Here, take some change to buy it.  Thank you!"\n',A3($elm$core$Dict$insert,"offerYourSodaToScreamingChild",'\n"Say, I actually have a soda.  I didn\'t drink it yet.  Do you want it?"\n---\n"Gross!  I don\'t want your weird soda!  Get away from me!"\n',A3($elm$core$Dict$insert,"offerYourSodaToScreamingChildFromSoda",'\n"Say, I actually have a soda.  I didn\'t drink it yet.  Do you want it?"\n---\n"Gross!  I don\'t want your weird soda!  Get away from me!"\n',A3($elm$core$Dict$insert,"meetingScreamingChild","\nThe child is screaming his head off.  It's actually very annoying.  Even his mother looks like she can barely take any more of it.  She looks at me apologetically.\n---\n\"I'm sorry, he won't calm down.  He wants a soda, but I can't leave this spot because I'm waiting for someone.\"\n---\nThis situation seems bad for everyone.\n",$elm$core$Dict$empty)))))))))))))))))))),$author$project$NarrativeContent$intro=A3($author$project$NarrativeContent$content__________________________________,"fallAsleep","\nToday's the day.  I busted my ass, but I think it will work.  I better get my damn promotion.\n\nI just wish I wasn't so tired.\n---\nTwo more stops. Maybe I can steal a wink or two before I get to the station. I'll just close my eyes for a minute.\n---\n...\n---\n\"Sir. Sir!\"\n---\nWhoa... what?  What's going on?\n\nA janitor is shaking my shoulder.\n\n\"We're almost at the end of the line, sir. You have to wake up.\"\n---\nEnd of the line?\n\nShit, I feel asleep!  I missed my stop!  What station is this?\n\nOh my God, I'm in so much trouble!  I have to get back to my stop.\n",A3($author$project$NarrativeContent$content__________________________________,"endThursday","\nI'm so tired.  I've been up all night working on this damn proposal, and there's still a lot more work to be done. Mr. Harris better appreciate it.\n",A3($author$project$NarrativeContent$content__________________________________,"endWednesday","\nThis train is two minutes late again.  This is becoming more and more of a problem lately.  They've got to do something about it.\n---\nI'm not looking forward to talking to Mr. Harris this morning.  This proposal is going to be a disaster.  Figures I get stuck with it.\n---\nBut I've got to make it work.\n",A3($author$project$NarrativeContent$content__________________________________,"endTuesday","\nIt's going to be tough getting this proposal put together by Friday, but I've got to do it.  I just wish I had more time to make it good.\n---\nAlso, It would be great to see Henry again. I've got to remember to get back to him.\n",A3($author$project$NarrativeContent$content__________________________________,"endMonday","\nI'm curious what my boss has in mind for this proposal.  It's nice he thought of me.  Maybe this will finally get me the promotion he's been promising.\n",A3($author$project$NarrativeContent$content__________________________________,"forcePlayerToReadEmails","\n{I have a few minutes before my train arrives.  I could check my emails while I wait.|It's kind of my routine to reread my emails before heading in.}\n",A3($author$project$NarrativeContent$content__________________________________,"notGoingToWork","\n { That's not my station. |}I have to go to {the office|work}{ at Broadway Street Station|}.\n ",A3($author$project$NarrativeContent$content__________________________________,"firstMeetSkaterDude","\nI've seen this young punk before, riding his skateboard up and down the platform.  He almost ran into me once.  The signs clearly say \"No skateboarding allowed.\"\n---\nOh great, now he's jumping the turnstile.  He probably doesn't even have a ticket.  You know, we've got rules for a reason.  When people like him disrespect them, it's the rest of us who have to pay.\n",A3($author$project$NarrativeContent$content__________________________________,"BENCH_BUM","\n{Some college kid is sprawled out across the whole bench. I wish he'd move. I'd like to just sit down.\n---\n\"Hi there. Could you sit up please? I'd like to sit while I wait for my train.\"\n---\nHe just ignores me.  Maybe he didn't hear me?\n|\n\"Hey!  I'd like to sit down, please.\"\n---\n\"Fuck off... I.. arghhh...\"\n---\nHe must be drunk.  I don't think he's getting up.\n|\nI guess I'm standing.\n}\n",A3($author$project$NarrativeContent$content__________________________________,"TRASH_DIGGER","\n{\"Spare some change?\"\n---\nI've seen that guy almost every day for years.  He always asks for money.  I used to give him some, but eventually stopped.  I work very hard to make a living.\n|\nHe's still at it.  Wonder what he thinks he'll find.\n}\n",A3($author$project$NarrativeContent$content__________________________________,"get_caffeinated_quest_3","\nNo thank you.\n",A3($author$project$NarrativeContent$content__________________________________,"drink_old_soda","\nUgh, this tastes disgusting.  How long has it been in there?\n",A3($author$project$NarrativeContent$content__________________________________,"get_caffeinated_quest_2","\n{This thing stole my quarters.  I want my soda!\n\nI know it's dumb, but I kick the machine so hard my foot hurts.\n---\nOK, calm down Steve.  The hard part is done, just focus on the getting to work.\n---\nWait, I think I hear something...\n---\nA soda dropped out!  Yes!\n}\n",A3($author$project$NarrativeContent$content__________________________________,"get_caffeinated_quest_1",'\n{The "Out of Order" sign is gone. Maybe it will work?\n\nSince I can\'t get my coffee, I might as well get my caffeine fix from somewhere.\n---\nGreat, the button doesn\'t work and it\'s not giving my change back. Damn.\n|\nThe "Out of Order" sign might be gone, but I know better.\n}\n',A3($author$project$NarrativeContent$content__________________________________,"sodaMachineFixed",'\nWow, the "Out of Order" sign is gone. Did they actually fix it?\n',A3($author$project$NarrativeContent$content__________________________________,"sodaMachineBroken","\n{An \"Out of Order\" sign is stuck to the front.  This thing has been broken since I moved here.\n\nNot that I've had a real hankering for a soda, but it's just kind of annoying.\n|\nIt's out of order.\n}\n",A3($author$project$NarrativeContent$content__________________________________,"SODA_MACHINE","\nI wonder how long the cans have been in that old thing?\n",A3($author$project$NarrativeContent$content__________________________________,"LOUD_PAYPHONE_LADY",'\n{\n"I\'ve been here for 30 damn minutes!  When the hell are you going to help me out?!"\n---\nShe sure seems upset.\n---\n"HOW THE FUCK ARE YOU GOING TO CALL ME BACK?! I\'M ON A FUCKING PAYPHONE, YOU IDIOT!"\n---\nWow, you\'d think people would try to take care of these matters at home. Yeesh.\n|\nThis is a bad idea...\n}\n',A3($author$project$NarrativeContent$content__________________________________,"COFFEE_CART","\nIt's closed. I hope Carl comes back.\n",A3($author$project$NarrativeContent$content__________________________________,"coffeeCartFriday","\nHuh, that's strange.  It's closed.  I really need my coffee.  Today of all days!\n",A3($author$project$NarrativeContent$content__________________________________,"coffeeCartThursday",'\n{Instead of Carl, there\'s some young lady behind the stand, looking at her phone.\n---\n"You\'re not Carl."\n\n"Nope. Was called in last minute. Guess his wife just went into labor or somethin\'. Can I get you anything?"\n\n"Carl\'s married?"\n\n"Guess so,  I don\'t know the guy. You getting something or not?"\n\n"Sure. Coffee. Black."\n\n"Here you go. See ya."\n|I miss Carl.}\n',A3($author$project$NarrativeContent$content__________________________________,"coffeeCartWednesday",'\n{"Morning Steve.  You alright?"\n\n"Fill it up to the top, Carl. I\'m going to need every last drop today."\n\n"You got it.  Take it easy Steve. Don\'t want to work too hard."\n\n"Easy for you to say, Carl. But I\'ll try. Thanks!"\n|I\'ve got plenty already, and plenty of work to do too.}\n',A3($author$project$NarrativeContent$content__________________________________,"coffeeCartTuesday",'\n{"The usual for you today, Steve?"\n\n"Yes please."\n\n"Enjoy."\n|"Need anything else?"\n\n"No, I\'m fine."}\n',A3($author$project$NarrativeContent$content__________________________________,"coffeeCartMonday",'\n{Carl runs the little coffee stand at my local station.  The coffee is decent, and it\'s nice to see his smiling face each morning.\n---\n"Morning, Carl! Can I just get the usual?"\n\n"Sure thing, Steve. That\'ll be a buck twenty five."\n\n"Here you go, Carl, exact change. Thanks. Have a good one."\n\n|"See you tomorrow."|"See you tomorrow."|"Don\'t miss your train."}\n',A3($author$project$NarrativeContent$content__________________________________,"checkEmailsDay5","\n{\nEmail 1\n\n    From: Jason Harris\n    To: Steve Kerry\n    Sent: Friday, 5:00am\n    Subject: WHERE THE HELL ARE YOU?\n---\n    I WANT TO RUN THROUGH THE PRESENTATION BEFORE THE CLIENTS GET HERE.\n    GET YOUR ASS DOWN HERE RIGHT AWAY!\n|\nMaybe I should call in sick.\n}\n",A3($author$project$NarrativeContent$content__________________________________,"checkEmailsDay4","\n{\nEmail 1\n\n    From: Jason Harris\n    To: Steve Kerry\n    Sent: Thursday, 4:27am\n    Subject: (Subject)\n---\n    Steve, our clients are going to be here tomorrow whether you're ready or not. You're going to\n    need to PUSH HARDER. I don't care what you have to do to put this thing together, just GET IT DONE.\n\n    BRING ME WHAT YOU HAVE ASAP.\n\n---\nEmail 2\n\n    From: Henry Thorne\n    To: Steve Kerry\n    Sent: Thursday, 5:45am\n    Subject: Today?\n---\n    Hey, Steve\n\n    I'm in the city today and I haven't heard back from you. I'm sure you're busy, but it would really\n    be nice to see you while I'm down. My plane leaves tomorrow, so today is probably it. You can\n    call me at my old number if you get this in time and we can plan something out. It hasn't\n    changed.\n\n    Hope to talk to you soon.\n|\nHow can Mr Harris ask me to push harder? I'm working my ass off!\n}\n",A3($author$project$NarrativeContent$content__________________________________,"checkEmailsDay3","\n{\nEmail 1\n\n    From: Jason Harris\n    To: Steve Kerry\n    Sent: Wednesday, 5:45am\n    Subject: Pure Risk\n---\n    Steve,\n\n    What you handed me today WON'T work. The Premiums we offer do NOT cover these plans.\n    Half of these are life quality expenses. We NEED to think about the bottom dollar here. We're\n    two days from the proposal meeting. You've got to do better than this.\n\n    Put something better together today and get it to me by tonight. You're running out of time.\n\n---\nReply (Unsent)\n\n    Dear Mr. Harris,\n\n    Sir, I have to disagree. I feel that these plans are essential for our customers. If you'd just look\n    over the papers I sent you about the\n\n---\nReply\n\n    Dear, Mr. Harris\n\n    Yes, sir. I'll make some changes.\n\n|\nHave to cut more. Have to work harder. Have to keep moving. This will be worth it. Right?\n}\n",A3($author$project$NarrativeContent$content__________________________________,"checkEmailsDay2","\n{\nEmail 1\n\n    From: Jason Harris\n    To: Steve Kerry\n    Sent: Tuesday, 6:10am\n    Subject: Good Things!\n---\n    Steve,\n\n    I liked the ideas that you brought up yesterday. But I got word that the new clients are pushing up\n    the meeting to Friday! You're going to have to put this thing in HIGH gear, Steve. I can't hand them\n    half assed work.\n\n    Don't let me down.\n---\nReply\n\n    Dear Mr. Harris,\n\n    Thanks for the update. But Friday is a little soon isn't it? I just want to put something\n    together that will really help our customers. I may have to cut a lot of the ideas we spoke\n    about.\n\n    But I'll do my best, sir!\n\n---\nEmail 2\n\n    From: Henry Thorne\n    To: Steve Kerry\n    Sent: Tuesday, 6:29am\n    Subject: Stevey!\n---\n    Hey Steve!\n\n    Long time no talk! Just checking in with you and letting you know I'm going to be in the city in a\n    few days. It's supposed to be a business trip and it's only for a day, but I thought it's be nice to drop\n    by and catch up. I know things have been difficult since we last talked.\n\n    Just let me know when you're free and I'll make something work.\n\n    See you soon!\n|\nThat's all the emails.  How am I supposed to get this done by Friday?\n}\n",A3($author$project$NarrativeContent$content__________________________________,"checkEmailsDay1","\n{There's no service, but I can view my emails.\n---\nEmail 1\n\n    From: Jason Harris\n    To: Steve Kerry\n    Sent: Monday, 5:15am\n    Subject: I've Got a Job for You\n\n    ---\n    Steve,\n\n    I've got something big for you.\n    We've landed some important clients. The boys upstairs want you to wow them with a new\n    proposal. You're one of our senior agents and you've been in the department for, what, 6 years?\n\n    I'm giving this opportunity to you.  Be at my office at 6:30 am this Monday and we can talk over the details.\n---\n\nReply\n\n    Dear Mr. Harris,\n\n    I've actually been with the company for eight years, but no need to worry, sir. I'm happy to finally\n    be given the opportunity to do some real good for the company. I've got a few big ideas that I feel\n    could really help our customers in a really big way.\n\n    I'll be there bright and early, sir. I can't wait to start on this project together.\n\n---\nEmail 2\n\n    From: Janice Franz\n    To: Steve Kerry\n    Sent: Monday, 6:05am\n    Subject: RE: RE: Job Opportunity\n---\n    Hi Mr. Steve Kerry\n\n    My name is Janis and I'm reaching out on behalf of Embrace Insurance. I came across your resume\n    in our system and I believe you would make a perfect fit for our team!\n    If you're looking for a change or would simply like to see what options are available, we would\n    love to set up a meeting soon!\n\n    We look forward to your response!\n|\nStill no service, but Mr. Harris is waiting for me at the office.\n}\n",A3($author$project$NarrativeContent$content__________________________________,"firstInteractionWithCommuter1","\n{Another commuter waiting on the train.  I say hello and she says hello back.\n|I think one hello is enough when talking to complete strangers.}\n",A3($author$project$NarrativeContent$content__________________________________,"title_intro","\nSteve,\n---\nSteve,\n\nI've got something big for you.\n---\nSteve,\n\nI've got something big for you.\n\nCome by my office first thing Monday morning.\n",$elm$core$Dict$empty))))))))))))))))))))))))))))))),$author$project$NarrativeContent$silent=A3($author$project$NarrativeContent$content__________________________________,"use_secret_passage_way","",A3($author$project$NarrativeContent$content__________________________________,"disembark","",A3($author$project$NarrativeContent$content__________________________________,"ridingTheTrain","",A3($author$project$NarrativeContent$content__________________________________,"checkMap","",A3($author$project$NarrativeContent$content__________________________________,"goToLinePlatform","",A3($author$project$NarrativeContent$content__________________________________,"goToLineTurnstile","",A3($author$project$NarrativeContent$content__________________________________,"goToLobby","",A3($author$project$NarrativeContent$content__________________________________,"nextDay","",$elm$core$Dict$empty)))))))),$elm$core$Dict$foldl=F3((function(func,acc,dict){for(;;){if(-2===dict.$)return acc;var right=dict.e,$temp$func=func,$temp$acc=A3(func,dict.b,dict.c,A3($elm$core$Dict$foldl,func,acc,dict.d));func=$temp$func,acc=$temp$acc,dict=right}})),$elm$core$Dict$union=F2((function(t1,t2){return A3($elm$core$Dict$foldl,$elm$core$Dict$insert,t2,t1)})),$author$project$NarrativeContent$all=A3($elm$core$List$foldl,$elm$core$Dict$union,$elm$core$Dict$empty,_List_fromArray([$author$project$NarrativeContent$silent,$author$project$NarrativeContent$Quests$content,$author$project$NarrativeContent$achievements,$author$project$NarrativeContent$intro,$author$project$NarrativeContent$Chapter1$content,$author$project$NarrativeContent$Chapter2$content,$author$project$NarrativeContent$General$content])),$elm$core$Dict$get=F2((function(targetKey,dict){get:for(;;){if(-2===dict.$)return $elm$core$Maybe$Nothing;var value=dict.c,left=dict.d,right=dict.e;switch(A2($elm$core$Basics$compare,targetKey,dict.b)){case 0:targetKey=targetKey,dict=left;continue get;case 1:return $elm$core$Maybe$Just(value);default:targetKey=targetKey,dict=right;continue get}}})),$elm$core$Maybe$withDefault=F2((function(_default,maybe){return maybe.$?_default:maybe.a})),$author$project$NarrativeContent$t=function(key){return A2($elm$core$Maybe$withDefault,"ERROR: can't find content for key "+key,A2($elm$core$Dict$get,key,$author$project$NarrativeContent$all))},$author$project$Main$init=F2((function(initialWorldModel,flags){var debugState=flags.Q?$elm$core$Maybe$Just($jschomay$elm_narrative_engine$NarrativeEngine$Debug$init):$elm$core$Maybe$Nothing;return _Utils_Tuple2({bj:!1,bp:"1",br:debugState,bx:$elm$core$Maybe$Nothing,by:!1,bC:_List_Nil,bJ:_Utils_eq(debugState,$elm$core$Maybe$Nothing),bN:$author$project$LocalTypes$Goals,bR:$elm$core$Maybe$Nothing,bS:"",bT:!1,bU:$elm$core$Maybe$Nothing,bZ:$elm$core$Dict$empty,b0:$author$project$LocalTypes$MainTitle,b1:!1,b2:!1,b3:flags.Q,b4:!1,b8:A2($elm$core$String$split,"---",$author$project$NarrativeContent$t("title_intro")),cb:_List_Nil,cf:initialWorldModel},$author$project$Main$persistSaveReq(_Utils_Tuple2("Chapter 1: Beginning",_List_Nil)))})),$author$project$Manifest$addExtraFields=F2((function(_v0,_v1){return{ad:_v0.ad,aN:_v1.aN,bM:_v0.bM,a5:_v1.a5,a8:_v1.a8}})),$author$project$Manifest$entity=F2((function(entityString,name){return _Utils_Tuple2(entityString,{ad:$elm$core$Maybe$Nothing,bM:name})})),$author$project$Manifest$withAI=F2((function(id,_v0){return _Utils_Tuple2(_v0.a,_Utils_update(_v0.b,{ad:$elm$core$Maybe$Just(id)}))})),$author$project$Manifest$entities=_List_fromArray([A2($author$project$Manifest$entity,"PLAYER.chapter=0.day=1.location=EAST_MULBERRY.destination=BROADWAY_STREET","Steve"),A2($author$project$Manifest$entity,"BRIEFCASE.item.location=PLAYER","Briefcase"),A2($author$project$Manifest$entity,"RED_LINE_PASS.pass.item.location=PLAYER.valid_on=RED_LINE","Red Line metro pass"),A2($author$project$Manifest$entity,"ORANGE_LINE_PASS.pass.item.valid_on=ORANGE_LINE","Orange Line metro pass"),A2($author$project$Manifest$entity,"CELL_PHONE.item.location=PLAYER.new","Cell phone"),A2($author$project$Manifest$entity,"MAP.item.map.silent","Subway map"),A2($author$project$Manifest$entity,"NOTEBOOK.item.new","I keep track of my daily plans in this."),A2($author$project$Manifest$entity,"DOLLAR_BILL.item.location=offscreen","Dollar bill"),A2($author$project$Manifest$entity,"CHANGE.item.location=offscreen.amount=0","Loose change"),A2($author$project$Manifest$entity,"SODA.item.location=offscreen","Soda"),A2($author$project$Manifest$entity,"CENTRAL_GUARD_OFFICE.location","Central Guard Office"),A2($author$project$Manifest$entity,"LOBBY.location","Station Lobby"),A2($author$project$Manifest$entity,"COFFEE.item.location=offscreen","Coffee"),A2($author$project$Manifest$withAI,"trash_digger",A2($author$project$Manifest$entity,"TRASH_DIGGER.character.location=offscreen","Man digging in the trash")),A2($author$project$Manifest$entity,"SKATER_DUDE.character.location=offscreen","Skater dude"),A2($author$project$Manifest$withAI,"beach_bum",A2($author$project$Manifest$entity,"BENCH_BUM.character.location=offscreen","Guy sleeping on a bench")),A2($author$project$Manifest$entity,"MISSING_DOG_POSTER_1.item.missing_dog_poster","Missing dog poster"),A2($author$project$Manifest$entity,"MISSING_DOG_POSTER_2.item.missing_dog_poster","Missing dog poster"),A2($author$project$Manifest$entity,"MISSING_DOG_POSTER_3.item.missing_dog_poster","Missing dog poster"),A2($author$project$Manifest$entity,"MISSING_DOG_POSTER_4.item.missing_dog_poster","Missing dog poster"),A2($author$project$Manifest$entity,"MISSING_DOG_POSTER_5.item.missing_dog_poster","Missing dog poster"),A2($author$project$Manifest$entity,"PAYPHONE_EAST_MULBERRY.item.location=offscreen","Payphone"),A2($author$project$Manifest$withAI,"carl",A2($author$project$Manifest$entity,"COFFEE_CART.character.location=EAST_MULBERRY","Coffee cart")),A2($author$project$Manifest$withAI,"girl_in_maroon_dress",A2($author$project$Manifest$entity,"COMMUTER_1.character.location=EAST_MULBERRY","Woman in a maroon jacket")),A2($author$project$Manifest$withAI,"loud_payphone_lady",A2($author$project$Manifest$entity,"LOUD_PAYPHONE_LADY.character.location=EAST_MULBERRY","Loud woman on payphone")),A2($author$project$Manifest$entity,"GRAFFITI_EAST_MULBERRY.item.location=EAST_MULBERRY","Graffiti on the wall"),A2($author$project$Manifest$entity,"SODA_MACHINE.item.broken.location=EAST_MULBERRY","Soda vending machine"),A2($author$project$Manifest$entity,"SOGGY_JACKET.item.location=WEST_MULBERRY","Soggy looking jacket"),A2($author$project$Manifest$entity,"BULLETIN_BOARD.item.location=WEST_MULBERRY","Bulletin board"),A2($author$project$Manifest$entity,"DRINKING_FOUNTAIN.item.location=WEST_MULBERRY","Rusty drinking fountain"),A2($author$project$Manifest$entity,"OVERTURNED_TRASHCAN.item.location=WEST_MULBERRY","Overturned trashcan"),A2($author$project$Manifest$entity,"CUSTODIAN.character.location=WEST_MULBERRY","Custodian"),A2($author$project$Manifest$entity,"WOMAN_IN_ODD_HAT.character.location=CHURCH_STREET","A woman with an odd hat"),A2($author$project$Manifest$entity,"SCHOOL_CHILDREN.character.location=CHURCH_STREET","A group of school children"),A2($author$project$Manifest$entity,"MOTHER.character.screaming_child_quest=0.location=CHURCH_STREET","Mother and child"),A2($author$project$Manifest$entity,"MISSIONARIES.character.location=CHURCH_STREET","Missionaries"),A2($author$project$Manifest$entity,"SAFETY_WARNING_POSTER.item.location=TWIN_BROOKS","Safety message poster"),A2($author$project$Manifest$entity,"MAP_POSTER.item.map.location=TWIN_BROOKS","Map on the wall"),A2($author$project$Manifest$entity,"MAINTENANCE_MAN.character.location=TWIN_BROOKS","Maintenance man"),A2($author$project$Manifest$entity,"MAN_IN_HOT_DOG_SUIT.character","Man in a hot dog suit"),A2($author$project$Manifest$entity,"MASCOT_PAPERS.item","Mascot papers"),A2($author$project$Manifest$entity,"NEWSPAPER_VENDING_MACHINE.item.location=TWIN_BROOKS","Newspaper vending machine"),A2($author$project$Manifest$entity,"EXIT.item.location=BROADWAY_STREET","Exit"),A2($author$project$Manifest$entity,"SECURITY_OFFICERS.character.location=BROADWAY_STREET","Security officers"),A2($author$project$Manifest$entity,"ANGRY_CROWD.character.location=BROADWAY_STREET","A large crowd of people"),A2($author$project$Manifest$entity,"GIRL_IN_YELLOW.character.location=BROADWAY_STREET","Girl in yellow dress"),A2($author$project$Manifest$entity,"MUSICIAN.character.location=CONVENTION_CENTER","Man playing violin"),A2($author$project$Manifest$entity,"MAN_IN_RATTY_HAT.character.location=CONVENTION_CENTER","Man in a ratty brown hat"),A2($author$project$Manifest$entity,"BUSTLING_CROWD.character.location=CONVENTION_CENTER","Bustling crowds of people"),A2($author$project$Manifest$entity,"MARCYS_PIZZA.item.fixed.location=CONVENTION_CENTER","Marcy's Pizza"),A2($author$project$Manifest$entity,"SECURITY_DEPOT_SPRING_HILL_STATION.item.location=SPRING_HILL","Security Depot"),A2($author$project$Manifest$entity,"MISSING_DOG_POSTER_0.item.missing_dog_poster.location=SPRING_HILL","Missing dog poster"),A2($author$project$Manifest$entity,"TRASH_CAN_CAPITOL_HEIGHTS.item.trashcan.location=CAPITOL_HEIGHTS","Trash can"),A2($author$project$Manifest$entity,"ODD_KEY.item","Odd key"),A2($author$project$Manifest$entity,"SHIFTY_MAN.character.location=CAPITOL_HEIGHTS","Shifty looking man"),A2($author$project$Manifest$entity,"MARK.character.location=CAPITOL_HEIGHTS","{PLAYER.find_briefcase>2?Mark|Guy with cardboard sign}"),A2($author$project$Manifest$entity,"SPIKY_HAIR_GUY.character.location=CAPITOL_HEIGHTS","Guy with Spiky Hair"),A2($author$project$Manifest$entity,"GREEN_SUIT_MAN.character.location=CAPITOL_HEIGHTS","Man in a fancy green suit"),A2($author$project$Manifest$entity,"BROOM_CLOSET.item.location=SEVENTY_THIRD_STREET","Broom closet"),A2($author$project$Manifest$entity,"DISTRESSED_WOMAN.character.location=SEVENTY_THIRD_STREET","Woman in a pink poncho"),A2($author$project$Manifest$entity,"PAYPHONE_SEVENTY_THIRD_STREET.item.location=SEVENTY_THIRD_STREET","Payphone"),A2($author$project$Manifest$entity,"TRASH_CAN_SEVENTY_THIRD_STREET.item.trashcan.location=SEVENTY_THIRD_STREET","Trash can"),A2($author$project$Manifest$entity,"BUSINESS_MAN.character.location=SEVENTY_THIRD_STREET","Slick looking business man"),A2($author$project$Manifest$entity,"ABANDONED_JACKET.item.location=SEVENTY_THIRD_STREET","Abandoned jacket"),A2($author$project$Manifest$entity,"MAINTENANCE_DOOR_SEVENTY_THIRD_STREET_TO_FORTY_SECOND_STREET.item.passage_to=FORTY_SECOND_STREET.location=SEVENTY_THIRD_STREET.hidden","Maintenance door"),A2($author$project$Manifest$entity,"MAINTENANCE_DOOR_FORTY_SECOND_STREET_TO_SEVENTY_THIRD_STREET.item.passage_to=SEVENTY_THIRD_STREET.location=FORTY_SECOND_STREET","Maintenance door"),A2($author$project$Manifest$entity,"GRIZZLED_REPAIRMAN.character.location=FORTY_SECOND_STREET","Grizzled repairman"),A2($author$project$Manifest$entity,"ELECTRIC_PANEL.item.hidden.location=FORTY_SECOND_STREET","Electric panel"),A2($author$project$Manifest$entity,"SECURITY_CAMERA_FORTY_SECOND_STREET.item.security_camera.location=FORTY_SECOND_STREET","Security camera"),A2($author$project$Manifest$entity,"FRANKS_FRANKS.item.fixed.location=UNIVERSITY","Frank's Franks hot dog stand"),A2($author$project$Manifest$entity,"SECRET_SERVICE_TYPE_GUY.character.location=UNIVERSITY","Man in sunglasses and suit"),A2($author$project$Manifest$entity,"MAGAZINE_STAND.item.location=UNIVERSITY","Magazine stand"),A2($author$project$Manifest$entity,"FAKE_COP.character.location=UNIVERSITY","Police officer"),A2($author$project$Manifest$entity,"ADVERTISEMENT.item.location=UNIVERSITY","Advertisement poster"),A2($author$project$Manifest$entity,"BROKEN_PAYPHONE.item.location=ST_MARKS","Broken payphone"),A2($author$project$Manifest$entity,"CENTRAL_GUARD_OFFICE_ENTRANCE.item.location=ST_MARKS","Guard Station Entrance"),A2($author$project$Manifest$entity,"MURAL.item.location=ST_MARKS","Mural"),A2($author$project$Manifest$entity,"BIRD.item.location=ST_MARKS","A bird!"),A2($author$project$Manifest$entity,"COMMUTERS_ST_MARKS.character.location=ST_MARKS","Commuters"),A2($author$project$Manifest$entity,"TROPICAL_T_SHIRT_MAN.character.location=ST_MARKS","Man in a bright tropical T-shirt"),A2($author$project$Manifest$entity,"VENDING_MACHINE.item.location=ONE_HUNDRED_FORTH_STREET","Snack machine"),A2($author$project$Manifest$entity,"CONSTRUCTION_AREA.item.location=ONE_HUNDRED_FORTH_STREET","Roped off area"),A2($author$project$Manifest$entity,"FLUORESCENT_LIGHTS.item.location=ONE_HUNDRED_FORTH_STREET","Flickering fluorescent lights"),A2($author$project$Manifest$entity,"TRASH_CAN_ONE_HUNDRED_FOURTH_STREET.item.trashcan.location=ONE_HUNDRED_FORTH_STREET","Trash can"),A2($author$project$Manifest$entity,"TICKET_INSPECTOR.character.location=CENTRAL_GUARD_OFFICE","Ticket inspector"),A2($author$project$Manifest$entity,"INFRACTIONS_INSTRUCTIONS_POSTER.item",'"Infractions Instructions" poster'),A2($author$project$Manifest$entity,"INFRACTIONS_COMPUTER.item","Computer"),A2($author$project$Manifest$entity,"INFRACTIONS_PRINTER.item","Printer"),A2($author$project$Manifest$entity,"INFRACTIONS_GREEN_BUTTON.item","Green button"),A2($author$project$Manifest$entity,"INFRACTIONS_ROOM_DOOR.item","Solid door"),A2($author$project$Manifest$entity,"INFRACTIONS_CARD_READER.item","Card reader"),A2($author$project$Manifest$entity,"GRIZZLED_SECURITY_GUARD.character","Grizzled security guard"),A2($author$project$Manifest$entity,"CONCERT_POSTER.item.location=IRIS_LAKE","Poster"),A2($author$project$Manifest$entity,"GRAFFITI_IRIS_LAKE.item.location=IRIS_LAKE","Graffiti"),A2($author$project$Manifest$entity,"MAINTENANCE_DOOR_IRIS_LAKE_TO_WEST_MULBERRY.item.passage_to=WEST_MULBERRY.location=IRIS_LAKE.locked","Maintenance door"),A2($author$project$Manifest$entity,"TRASHED_NEWSPAPERS.item.location=IRIS_LAKE","Pile of crumpled newspapers "),A2($author$project$Manifest$entity,"OLD_LADIES.character.location=NORWOOD","Old women in floral dresses"),A2($author$project$Manifest$entity,"TRASH_CAN_NORWOOD.item.trashcan.location=NORWOOD","Trash can"),A2($author$project$Manifest$entity,"LIVING_STATUE.character.location=NORWOOD","Living statue"),A2($author$project$Manifest$entity,"SLEEPING_MAN.character.location=NORWOOD","Man sleeping on ground"),A2($author$project$Manifest$entity,"ONE_HUNDRED_FORTH_STREET.station","104th Street"),A2($author$project$Manifest$entity,"FORTY_SECOND_STREET.station","42nd Street"),A2($author$project$Manifest$entity,"SEVENTY_THIRD_STREET.station","73rd Street"),A2($author$project$Manifest$entity,"BROADWAY_STREET.station","Broadway Street"),A2($author$project$Manifest$entity,"BURLINGTON.station","Burlington"),A2($author$project$Manifest$entity,"CAPITOL_HEIGHTS.station","Capitol Heights"),A2($author$project$Manifest$entity,"CHURCH_STREET.station","Church Street"),A2($author$project$Manifest$entity,"CONVENTION_CENTER.station","Convention Center"),A2($author$project$Manifest$entity,"EAST_MULBERRY.station","East Mulberry"),A2($author$project$Manifest$entity,"FAIRVIEW.station","Fairview"),A2($author$project$Manifest$entity,"HIGHLAND.station","Highland"),A2($author$project$Manifest$entity,"IRIS_LAKE.station","Iris Lake"),A2($author$project$Manifest$entity,"MACARTHURS_PARK.station","MacArthur's Park"),A2($author$project$Manifest$entity,"MUSEUM.station","Museum"),A2($author$project$Manifest$entity,"NORWOOD.station","Norwood"),A2($author$project$Manifest$entity,"PARK_AVE.station","Park Street"),A2($author$project$Manifest$entity,"RIVERSIDE.station","Riverside"),A2($author$project$Manifest$entity,"SAMUAL_STREET.station","Samual Street"),A2($author$project$Manifest$entity,"SPRING_HILL.station","Spring Hill"),A2($author$project$Manifest$entity,"ST_MARKS.station","St. Mark's"),A2($author$project$Manifest$entity,"TWIN_BROOKS.station","Twin Brooks"),A2($author$project$Manifest$entity,"UNIVERSITY.station","University"),A2($author$project$Manifest$entity,"WALTER_HILL.station","Walter Hill"),A2($author$project$Manifest$entity,"WESTGATE.station","Westgate"),A2($author$project$Manifest$entity,"WEST_MULBERRY.station","West Mulberry"),A2($author$project$Manifest$entity,"RED_LINE.line","Red line"),A2($author$project$Manifest$entity,"YELLOW_LINE.line","Yellow line"),A2($author$project$Manifest$entity,"GREEN_LINE.line","Green line"),A2($author$project$Manifest$entity,"ORANGE_LINE.line","Orange line"),A2($author$project$Manifest$entity,"BLUE_LINE.line","Blue line"),A2($author$project$Manifest$entity,"PURPLE_LINE.line","Purple line"),A2($author$project$Manifest$withAI,"jeff_the_game_designer",A2($author$project$Manifest$entity,"JEFF","X"))]),$elm$core$Result$map=F2((function(func,ra){return ra.$?$elm$core$Result$Err(ra.a):$elm$core$Result$Ok(func(ra.a))})),$elm$core$List$intersperse=F2((function(sep,xs){if(xs.b){var tl=xs.b;return A2($elm$core$List$cons,xs.a,A3($elm$core$List$foldr,F2((function(x,rest){return A2($elm$core$List$cons,sep,A2($elm$core$List$cons,x,rest))})),_List_Nil,tl))}return _List_Nil})),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$deadEndsToString=function(deadEnds){return A2($elm$core$String$join,"",A2($elm$core$List$intersperse,"; ",A2($elm$core$List$map,(function(deadend){return function(p){switch(p.$){case 0:return"expecting '"+p.a+"'";case 1:return"expecting int";case 2:return"expecting hex";case 3:return"expecting octal";case 4:return"expecting binary";case 5:return"expecting float";case 6:return"expecting number";case 7:return"expecting variable";case 8:return"expecting symbol '"+p.a+"'";case 9:return"expecting keyword '"+p.a+"'";case 10:return"expecting end";case 11:return"unexpected char";case 12:return"problem "+p.a;default:return"bad repeat"}}(deadend.aT)+" at row "+$elm$core$String$fromInt(deadend.a1)+", col "+$elm$core$String$fromInt(deadend.as)}),deadEnds)))},$elm$parser$Parser$Advanced$Bad=F2((function(a,b){return{$:1,a:a,b:b}})),$elm$parser$Parser$Advanced$Good=F3((function(a,b,c){return{$:0,a:a,b:b,c:c}})),$elm$parser$Parser$Advanced$AddRight=F2((function(a,b){return{$:1,a:a,b:b}})),$elm$parser$Parser$Advanced$DeadEnd=F4((function(row,col,problem,contextStack){return{as:col,bo:contextStack,aT:problem,a1:row}})),$elm$parser$Parser$Advanced$Empty={$:0},$elm$parser$Parser$Advanced$fromState=F2((function(s,x){return A2($elm$parser$Parser$Advanced$AddRight,$elm$parser$Parser$Advanced$Empty,A4($elm$parser$Parser$Advanced$DeadEnd,s.a1,s.as,x,s.e))})),$elm$parser$Parser$end=(x={$:10},function(s){return _Utils_eq($elm$core$String$length(s.a),s.b)?A3($elm$parser$Parser$Advanced$Good,!1,0,s):A2($elm$parser$Parser$Advanced$Bad,!1,A2($elm$parser$Parser$Advanced$fromState,s,x))}),$elm$parser$Parser$andThen=F2((function(callback,_v0){var parseA=_v0;return function(s0){var _v1=parseA(s0);if(1===_v1.$)return A2($elm$parser$Parser$Advanced$Bad,_v1.a,_v1.b);var p1=_v1.a,s1=_v1.c,_v3=callback(_v1.b)(s1);if(1===_v3.$){var p2=_v3.a;return A2($elm$parser$Parser$Advanced$Bad,p1||p2,_v3.b)}p2=_v3.a;return A3($elm$parser$Parser$Advanced$Good,p1||p2,_v3.b,_v3.c)}})),$elm$parser$Parser$UnexpectedChar={$:11},$elm$parser$Parser$Advanced$isSubChar=_Parser_isSubChar,$elm$core$Basics$negate=function(n){return-n},$elm$parser$Parser$Advanced$chompIf=F2((function(isGood,expecting){return function(s){var newOffset=A3($elm$parser$Parser$Advanced$isSubChar,isGood,s.b,s.a);return _Utils_eq(newOffset,-1)?A2($elm$parser$Parser$Advanced$Bad,!1,A2($elm$parser$Parser$Advanced$fromState,s,expecting)):_Utils_eq(newOffset,-2)?A3($elm$parser$Parser$Advanced$Good,!0,0,{as:1,e:s.e,i:s.i,b:s.b+1,a1:s.a1+1,a:s.a}):A3($elm$parser$Parser$Advanced$Good,!0,0,{as:s.as+1,e:s.e,i:s.i,b:newOffset,a1:s.a1,a:s.a})}})),$elm$parser$Parser$Advanced$chompWhileHelp=F5((function(isGood,offset,row,col,s0){for(;;){var newOffset=A3($elm$parser$Parser$Advanced$isSubChar,isGood,offset,s0.a);if(_Utils_eq(newOffset,-1))return A3($elm$parser$Parser$Advanced$Good,0>_Utils_cmp(s0.b,offset),0,{as:col,e:s0.e,i:s0.i,b:offset,a1:row,a:s0.a});if(_Utils_eq(newOffset,-2))isGood=isGood,offset=offset+1,row=row+1,col=1,s0=s0;else isGood=isGood,offset=newOffset,row=row,col=col+1,s0=s0}})),$elm$parser$Parser$Advanced$chompWhile=function(isGood){return function(s){return A5($elm$parser$Parser$Advanced$chompWhileHelp,isGood,s.b,s.a1,s.as,s)}},$elm$parser$Parser$chompWhile=$elm$parser$Parser$Advanced$chompWhile,$elm$core$Basics$always=F2((function(a){return a})),$elm$parser$Parser$Advanced$mapChompedString=F2((function(func,_v0){var parse=_v0;return function(s0){var _v1=parse(s0);if(1===_v1.$)return A2($elm$parser$Parser$Advanced$Bad,_v1.a,_v1.b);var a=_v1.b,s1=_v1.c;return A3($elm$parser$Parser$Advanced$Good,_v1.a,A2(func,A3($elm$core$String$slice,s0.b,s1.b,s0.a),a),s1)}})),$elm$parser$Parser$getChompedString=function(parser){return A2($elm$parser$Parser$Advanced$mapChompedString,$elm$core$Basics$always,parser)},$elm$parser$Parser$Advanced$map2=F3((function(func,_v0,_v1){var parseA=_v0,parseB=_v1;return function(s0){var _v2=parseA(s0);if(1===_v2.$)return A2($elm$parser$Parser$Advanced$Bad,_v2.a,_v2.b);var p1=_v2.a,a=_v2.b,_v3=parseB(_v2.c);if(1===_v3.$){var p2=_v3.a;return A2($elm$parser$Parser$Advanced$Bad,p1||p2,_v3.b)}p2=_v3.a;var s2=_v3.c;return A3($elm$parser$Parser$Advanced$Good,p1||p2,A2(func,a,_v3.b),s2)}})),$elm$parser$Parser$ignorer=F2((function(keepParser,ignoreParser){return A3($elm$parser$Parser$Advanced$map2,$elm$core$Basics$always,keepParser,ignoreParser)})),$elm$core$List$any=F2((function(isOkay,list){for(;;){if(!list.b)return!1;var xs=list.b;if(isOkay(list.a))return!0;isOkay=isOkay,list=xs}})),$elm$core$List$member=F2((function(x,xs){return A2($elm$core$List$any,(function(a){return _Utils_eq(a,x)}),xs)})),$elm$parser$Parser$problem=function(msg){return function(x){return function(s){return A2($elm$parser$Parser$Advanced$Bad,!1,A2($elm$parser$Parser$Advanced$fromState,s,x))}}({$:12,a:msg})},$elm$parser$Parser$succeed=function(a){return function(s){return A3($elm$parser$Parser$Advanced$Good,!1,a,s)}},$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$notEmpty=function(s){return $elm$core$String$isEmpty(s)?$elm$parser$Parser$problem("cannot be empty"):$elm$parser$Parser$succeed(s)},$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$idParser=A2($elm$parser$Parser$andThen,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$notEmpty,$elm$parser$Parser$getChompedString(A2($elm$parser$Parser$ignorer,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed(0),A2($elm$parser$Parser$Advanced$chompIf,$elm$core$Char$isAlpha,$elm$parser$Parser$UnexpectedChar)),$elm$parser$Parser$chompWhile((function(c){return $elm$core$Char$isAlphaNum(c)||A2($elm$core$List$member,c,_List_fromArray(["_","-",":","#","+"]))}))))),$elm$parser$Parser$keeper=F2((function(parseFunc,parseArg){return A3($elm$parser$Parser$Advanced$map2,$elm$core$Basics$apL,parseFunc,parseArg)})),$elm$parser$Parser$Done=function(a){return{$:1,a:a}},$elm$parser$Parser$Loop=function(a){return{$:0,a:a}},$elm$core$Set$insert=F2((function(key,_v0){return A3($elm$core$Dict$insert,key,0,_v0)})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$addTag=F2((function(value,entity){return _Utils_update(entity,{a8:A2($elm$core$Set$insert,value,entity.a8)})})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$emptyLinks=$elm$core$Dict$empty,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$emptyStats=$elm$core$Dict$empty,$elm$core$Set$empty=$elm$core$Dict$empty,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$emptyTags=$elm$core$Set$empty,$elm$parser$Parser$Advanced$loopHelp=F4((function(p,state,callback,s0){for(;;){var _v1=callback(state)(s0);if(_v1.$){p1=_v1.a;return A2($elm$parser$Parser$Advanced$Bad,p||p1,_v1.b)}var p1=_v1.a,step=_v1.b,s1=_v1.c;if(step.$)return A3($elm$parser$Parser$Advanced$Good,p||p1,step.a,s1);p=p||p1,state=step.a,callback=callback,s0=s1}})),$elm$parser$Parser$Advanced$loop=F2((function(state,callback){return function(s){return A4($elm$parser$Parser$Advanced$loopHelp,!1,state,callback,s)}})),$elm$parser$Parser$map=F2((function(func,_v0){var parse=_v0;return function(s0){var _v1=parse(s0);if(_v1.$)return A2($elm$parser$Parser$Advanced$Bad,_v1.a,_v1.b);var s1=_v1.c;return A3($elm$parser$Parser$Advanced$Good,_v1.a,func(_v1.b),s1)}})),$elm$parser$Parser$toAdvancedStep=function(step){return step.$?function(a){return{$:1,a:a}}(step.a):function(a){return{$:0,a:a}}(step.a)},$elm$parser$Parser$loop=F2((function(state,callback){return A2($elm$parser$Parser$Advanced$loop,state,(function(s){return A2($elm$parser$Parser$map,$elm$parser$Parser$toAdvancedStep,callback(s))}))})),$elm$core$Basics$composeR=F3((function(f,g,x){return g(f(x))})),$elm$core$Maybe$map=F2((function(f,maybe){return maybe.$?$elm$core$Maybe$Nothing:$elm$core$Maybe$Just(f(maybe.a))})),$elm$parser$Parser$Advanced$Append=F2((function(a,b){return{$:2,a:a,b:b}})),$elm$parser$Parser$Advanced$oneOfHelp=F3((function(s0,bag,parsers){oneOfHelp:for(;;){if(parsers.b){var remainingParsers=parsers.b,_v1=(0,parsers.a)(s0);if(_v1.$){var step;if((step=_v1).a)return step;s0=s0,bag=A2($elm$parser$Parser$Advanced$Append,bag,step.b),parsers=remainingParsers;continue oneOfHelp}return step=_v1}return A2($elm$parser$Parser$Advanced$Bad,!1,bag)}})),$elm$parser$Parser$oneOf=function(parsers){return function(s){return A3($elm$parser$Parser$Advanced$oneOfHelp,s,$elm$parser$Parser$Advanced$Empty,parsers)}},$elm$parser$Parser$Advanced$Token=F2((function(a,b){return{$:0,a:a,b:b}})),$elm$parser$Parser$Advanced$isSubString=_Parser_isSubString,$elm$core$Basics$not=function(bool){return!bool},$elm$parser$Parser$Advanced$token=function(_v0){var str=_v0.a,expecting=_v0.b,progress=!$elm$core$String$isEmpty(str);return function(s){var _v1=A5($elm$parser$Parser$Advanced$isSubString,str,s.b,s.a1,s.as,s.a),newOffset=_v1.a,newRow=_v1.b,newCol=_v1.c;return _Utils_eq(newOffset,-1)?A2($elm$parser$Parser$Advanced$Bad,!1,A2($elm$parser$Parser$Advanced$fromState,s,expecting)):A3($elm$parser$Parser$Advanced$Good,progress,0,{as:newCol,e:s.e,i:s.i,b:newOffset,a1:newRow,a:s.a})}},$elm$parser$Parser$Advanced$symbol=$elm$parser$Parser$Advanced$token,$elm$parser$Parser$symbol=function(str){return $elm$parser$Parser$Advanced$symbol(A2($elm$parser$Parser$Advanced$Token,str,{$:8,a:str}))},$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$numberParser=(int_=A2($elm$parser$Parser$andThen,A2($elm$core$Basics$composeR,$elm$core$String$toInt,A2($elm$core$Basics$composeR,$elm$core$Maybe$map($elm$parser$Parser$succeed),$elm$core$Maybe$withDefault($elm$parser$Parser$problem("not an int")))),$elm$parser$Parser$getChompedString($elm$parser$Parser$chompWhile($elm$core$Char$isDigit))),$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$negate),$elm$parser$Parser$symbol("-")),int_),int_]))),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$propertyNameParser=A2($elm$parser$Parser$andThen,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$notEmpty,$elm$parser$Parser$getChompedString(A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed(0),$elm$parser$Parser$chompWhile((function(c){return $elm$core$Char$isAlphaNum(c)||A2($elm$core$List$member,c,_List_fromArray(["_",":","#"]))}))))),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$setLink=F3((function(key,value,entity){return _Utils_update(entity,{aN:A3($elm$core$Dict$insert,key,value,entity.aN)})})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$setStat=F3((function(key,value,entity){return _Utils_update(entity,{a5:A3($elm$core$Dict$insert,key,value,entity.a5)})})),$elm$parser$Parser$spaces=$elm$parser$Parser$Advanced$chompWhile((function(c){return" "===c||"\n"===c||"\r"===c})),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$propsParser=(toComponent=F2((function(key,fn){return fn(key)})),A2($elm$parser$Parser$loop,{aN:$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$emptyLinks,a5:$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$emptyStats,a8:$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$emptyTags},(function(acc){return $elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed(toComponent),$elm$parser$Parser$spaces),$elm$parser$Parser$symbol(".")),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$propertyNameParser),$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$elm$parser$Parser$symbol("=")),$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,(function(v){return function(k){return $elm$parser$Parser$Loop(A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$setLink,k,v,acc))}}),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$idParser),A2($elm$parser$Parser$map,(function(v){return function(k){return $elm$parser$Parser$Loop(A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$setStat,k,v,acc))}}),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$numberParser)]))),$elm$parser$Parser$succeed((function(t){return $elm$parser$Parser$Loop(A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$addTag,t,acc))}))]))),$elm$parser$Parser$succeed($elm$parser$Parser$Done(acc))]))}))),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$entityParser=A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,$elm$parser$Parser$succeed(F2((function(id,narrativeComponent){return _Utils_Tuple2(id,narrativeComponent)}))),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$idParser),A2($elm$parser$Parser$ignorer,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$propsParser,$elm$parser$Parser$end)),$elm$core$Result$mapError=F2((function(f,result){return result.$?$elm$core$Result$Err(f(result.a)):$elm$core$Result$Ok(result.a)})),$elm$core$Tuple$mapSecond=F2((function(func,_v0){return _Utils_Tuple2(_v0.a,func(_v0.b))})),$elm$parser$Parser$DeadEnd=F3((function(row,col,problem){return{as:col,aT:problem,a1:row}})),$elm$parser$Parser$problemToDeadEnd=function(p){return A3($elm$parser$Parser$DeadEnd,p.a1,p.as,p.aT)},$elm$parser$Parser$Advanced$bagToList=F2((function(bag,list){bagToList:for(;;)switch(bag.$){case 0:return list;case 1:var x=bag.b;bag=bag.a,list=A2($elm$core$List$cons,x,list);continue bagToList;default:var bag2=bag.b;bag=bag.a,list=A2($elm$parser$Parser$Advanced$bagToList,bag2,list);continue bagToList}})),$elm$parser$Parser$Advanced$run=F2((function(_v0,src){var _v1=_v0({as:1,e:_List_Nil,i:1,b:0,a1:1,a:src});return _v1.$?$elm$core$Result$Err(A2($elm$parser$Parser$Advanced$bagToList,_v1.b,_List_Nil)):$elm$core$Result$Ok(_v1.b)})),$elm$parser$Parser$run=F2((function(parser,source){var _v0=A2($elm$parser$Parser$Advanced$run,parser,source);return _v0.$?$elm$core$Result$Err(A2($elm$core$List$map,$elm$parser$Parser$problemToDeadEnd,_v0.a)):$elm$core$Result$Ok(_v0.a)})),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$parseEntity=F2((function(extendFn,_v0){var text=_v0.a;return A2($elm$core$Result$mapError,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$deadEndsToString,A2($elm$core$Result$map,$elm$core$Tuple$mapSecond(extendFn(_v0.b)),A2($elm$parser$Parser$run,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$entityParser,text)))})),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$parseMany=F2((function(extendFn,entities){var displayError=F2((function(source,e){return _Utils_Tuple2("Entity def: "+source,e)}));return A3($elm$core$List$foldl,F2((function(entity,acc){var source=entity.a,_v0=A2($jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$parseEntity,extendFn,entity);if(_v0.$){var err=_v0.a;if(acc.$){var errors=acc.a;return $elm$core$Result$Err(A2($elm$core$List$cons,A2(displayError,source,err),errors))}return $elm$core$Result$Err(_List_fromArray([A2(displayError,source,err)]))}var _v1=_v0.a;return A2($elm$core$Result$map,A2($elm$core$Dict$insert,_v1.a,_v1.b),acc)})),$elm$core$Result$Ok($elm$core$Dict$empty),entities)})),$author$project$Manifest$initialWorldModel=A2($jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$parseMany,$author$project$Manifest$addExtraFields,$author$project$Manifest$entities),$elm$core$Result$map3=F4((function(func,ra,rb,rc){if(1===ra.$)return $elm$core$Result$Err(ra.a);var a=ra.a;if(1===rb.$)return $elm$core$Result$Err(rb.a);var b=rb.a;return 1===rc.$?$elm$core$Result$Err(rc.a):$elm$core$Result$Ok(A3(func,a,b,rc.a))})),$elm$core$Basics$composeL=F3((function(g,f,x){return g(f(x))})),$elm$core$List$all=F2((function(isOkay,list){return!A2($elm$core$List$any,A2($elm$core$Basics$composeL,$elm$core$Basics$not,isOkay),list)})),$elm$parser$Parser$backtrackable=function(_v0){var parse=_v0;return function(s0){var _v1=parse(s0);return 1===_v1.$?A2($elm$parser$Parser$Advanced$Bad,!1,_v1.b):A3($elm$parser$Parser$Advanced$Good,!1,_v1.b,_v1.c)}},$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$break=$elm$parser$Parser$symbol("|"),$elm$parser$Parser$Advanced$findSubString=_Parser_findSubString,$elm$parser$Parser$Advanced$fromInfo=F4((function(row,col,x,context){return A2($elm$parser$Parser$Advanced$AddRight,$elm$parser$Parser$Advanced$Empty,A4($elm$parser$Parser$Advanced$DeadEnd,row,col,x,context))})),$elm$parser$Parser$toToken=function(str){return A2($elm$parser$Parser$Advanced$Token,str,{$:0,a:str})},$elm$parser$Parser$chompUntil=function(str){return function(_v0){var str=_v0.a,expecting=_v0.b;return function(s){var _v1=A5($elm$parser$Parser$Advanced$findSubString,str,s.b,s.a1,s.as,s.a),newOffset=_v1.a,newRow=_v1.b,newCol=_v1.c;return _Utils_eq(newOffset,-1)?A2($elm$parser$Parser$Advanced$Bad,!1,A4($elm$parser$Parser$Advanced$fromInfo,newRow,newCol,expecting,s.e)):A3($elm$parser$Parser$Advanced$Good,0>_Utils_cmp(s.b,newOffset),0,{as:newCol,e:s.e,i:s.i,b:newOffset,a1:newRow,a:s.a})}}($elm$parser$Parser$toToken(str))},$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$close=$elm$parser$Parser$symbol("}"),$elm$parser$Parser$commit=function(a){return function(s){return A3($elm$parser$Parser$Advanced$Good,!0,a,s)}},$elm$core$Array$fromListHelp=F3((function(list,nodeList,nodeListSize){for(;;){var _v0=A2($elm$core$Elm$JsArray$initializeFromList,32,list),jsArray=_v0.a,remainingItems=_v0.b;if(0>_Utils_cmp($elm$core$Elm$JsArray$length(jsArray),32))return A2($elm$core$Array$builderToArray,!0,{m:nodeList,j:nodeListSize,l:jsArray});list=remainingItems,nodeList=A2($elm$core$List$cons,$elm$core$Array$Leaf(jsArray),nodeList),nodeListSize=nodeListSize+1}})),$elm$core$Array$fromList=function(list){return list.b?A3($elm$core$Array$fromListHelp,list,_List_Nil,0):$elm$core$Array$empty},$elm$core$Array$bitMask=4294967295>>>32-$elm$core$Array$shiftStep,$elm$core$Elm$JsArray$unsafeGet=_JsArray_unsafeGet,$elm$core$Array$getHelp=F3((function(shift,index,tree){for(;;){var _v0=A2($elm$core$Elm$JsArray$unsafeGet,$elm$core$Array$bitMask&index>>>shift,tree);if(_v0.$)return A2($elm$core$Elm$JsArray$unsafeGet,$elm$core$Array$bitMask&index,_v0.a);shift=shift-$elm$core$Array$shiftStep,index=index,tree=_v0.a}})),$elm$core$Array$get=F2((function(index,_v0){var len=_v0.a,startShift=_v0.b,tree=_v0.c,tail=_v0.d;return 0>index||_Utils_cmp(index,len)>-1?$elm$core$Maybe$Nothing:_Utils_cmp(index,function(len){return len>>>5<<5}(len))>-1?$elm$core$Maybe$Just(A2($elm$core$Elm$JsArray$unsafeGet,$elm$core$Array$bitMask&index,tail)):$elm$core$Maybe$Just(A3($elm$core$Array$getHelp,startShift,index,tree))})),$elm$random$Random$Seed=F2((function(a,b){return{$:0,a:a,b:b}})),$elm$random$Random$next=function(_v0){var incr=_v0.b;return A2($elm$random$Random$Seed,1664525*_v0.a+incr>>>0,incr)},$elm$random$Random$peel=function(_v0){var state=_v0.a,word=277803737*(state^state>>>4+(state>>>28));return(word>>>22^word)>>>0},$elm$random$Random$int=F2((function(a,b){return function(seed0){var _v0=0>_Utils_cmp(a,b)?_Utils_Tuple2(a,b):_Utils_Tuple2(b,a),lo=_v0.a,range=_v0.b-lo+1;if(range-1&range){var threshhold=(-range>>>0)%range>>>0;return function(seed){for(;;){var x=$elm$random$Random$peel(seed),seedN=$elm$random$Random$next(seed);if(_Utils_cmp(x,threshhold)>=0)return _Utils_Tuple2(x%range+lo,seedN);seed=seedN}}(seed0)}return _Utils_Tuple2(((range-1&$elm$random$Random$peel(seed0))>>>0)+lo,$elm$random$Random$next(seed0))}})),$elm$core$List$isEmpty=function(xs){return!xs.b},$elm$parser$Parser$lazy=function(thunk){return function(s){return thunk(0)(s)}},$elm$core$Basics$min=F2((function(x,y){return 0>_Utils_cmp(x,y)?x:y})),$elm$core$Basics$modBy=_Basics_modBy,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$open=$elm$parser$Parser$symbol("{"),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$CompareLink=F2((function(a,b){return{$:1,a:a,b:b}})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$CompareStat=F2((function(a,b){return{$:1,a:a,b:b}})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasLink=F2((function(a,b){return{$:2,a:a,b:b}})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasStat=F3((function(a,b,c){return{$:1,a:a,b:b,c:c}})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasTag=function(a){return{$:0,a:a}},$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$Match=F2((function(a,b){return{$:0,a:a,b:b}})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$Not=function(a){return{$:3,a:a}},$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SpecificLink=function(a){return{$:0,a:a}},$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SpecificStat=function(a){return{$:0,a:a}},$elm$parser$Parser$keyword=function(kwd){return function(_v0){var kwd=_v0.a,expecting=_v0.b,progress=!$elm$core$String$isEmpty(kwd);return function(s){var _v1=A5($elm$parser$Parser$Advanced$isSubString,kwd,s.b,s.a1,s.as,s.a),newOffset=_v1.a,newRow=_v1.b,newCol=_v1.c;return _Utils_eq(newOffset,-1)||A3($elm$parser$Parser$Advanced$isSubChar,(function(c){return $elm$core$Char$isAlphaNum(c)||"_"===c}),newOffset,s.a)>=0?A2($elm$parser$Parser$Advanced$Bad,!1,A2($elm$parser$Parser$Advanced$fromState,s,expecting)):A3($elm$parser$Parser$Advanced$Good,progress,0,{as:newCol,e:s.e,i:s.i,b:newOffset,a1:newRow,a:s.a})}}(A2($elm$parser$Parser$Advanced$Token,kwd,{$:9,a:kwd}))},$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$MatchAny=function(a){return{$:1,a:a}},$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$selectorParser=$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,$elm$core$Basics$always($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$MatchAny),$elm$parser$Parser$symbol("*")),A2($elm$parser$Parser$map,$elm$core$Basics$always($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$Match("$")),$elm$parser$Parser$symbol("$")),A2($elm$parser$Parser$map,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$Match,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$idParser)])),$elm$parser$Parser$token=function(str){return $elm$parser$Parser$Advanced$token($elm$parser$Parser$toToken(str))};function $jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$cyclic$matcherParser(){return A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,$elm$parser$Parser$succeed(F2((function(selector,queries){return selector(queries)}))),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$selectorParser),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$cyclic$queriesParser())}function $jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$cyclic$queriesParser(){var toQuery=F4((function(acc,negate,propName,queryConstructor){return $elm$parser$Parser$Loop(A2($elm$core$List$cons,negate?$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$Not(queryConstructor(propName)):queryConstructor(propName),acc))})),compareParser=F2((function(kind,mapper){return A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed(mapper),$elm$parser$Parser$keyword("("+kind)),$elm$parser$Parser$chompWhile($elm$core$Basics$eq(" "))),A2($elm$parser$Parser$ignorer,$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,$elm$core$Basics$always("$"),$elm$parser$Parser$token("$")),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$idParser])),$elm$parser$Parser$symbol("."))),A2($elm$parser$Parser$ignorer,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$propertyNameParser,$elm$parser$Parser$symbol(")")))}));return A2($elm$parser$Parser$loop,_List_Nil,(function(acc){return $elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed(toQuery(acc)),$elm$parser$Parser$symbol(".")),$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,$elm$core$Basics$always(!0),$elm$parser$Parser$symbol("!")),$elm$parser$Parser$succeed(!1)]))),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$propertyNameParser),$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$elm$parser$Parser$symbol(">")),$elm$parser$Parser$oneOf(_List_fromArray([A2(compareParser,"stat",F3((function(compareID,compareKey,key){return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasStat,key,2,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$CompareStat,compareID,compareKey))}))),A2($elm$parser$Parser$map,(function(n){return function(key){return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasStat,key,2,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SpecificStat(n))}}),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$numberParser)]))),A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$elm$parser$Parser$symbol("<")),$elm$parser$Parser$oneOf(_List_fromArray([A2(compareParser,"stat",F3((function(compareID,compareKey,key){return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasStat,key,0,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$CompareStat,compareID,compareKey))}))),A2($elm$parser$Parser$map,(function(n){return function(key){return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasStat,key,0,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SpecificStat(n))}}),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$numberParser)]))),A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$elm$parser$Parser$symbol("=")),$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,(function(n){return function(key){return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasStat,key,1,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SpecificStat(n))}}),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$numberParser),A2($elm$parser$Parser$map,(function(){return function(key){return A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasLink,key,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SpecificLink(A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$Match,"$",_List_Nil)))}}),$elm$parser$Parser$symbol("$")),A2($elm$parser$Parser$map,(function(id){return function(key){return A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasLink,key,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SpecificLink(A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$Match,id,_List_Nil)))}}),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$idParser),A2(compareParser,"stat",F3((function(compareID,compareKey,key){return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasStat,key,1,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$CompareStat,compareID,compareKey))}))),A2(compareParser,"link",F3((function(compareID,compareKey,key){return A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasLink,key,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$CompareLink,compareID,compareKey))}))),A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$elm$parser$Parser$symbol("(")),A2($elm$parser$Parser$ignorer,A2($elm$parser$Parser$map,(function(matcher){return function(key){return A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasLink,key,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SpecificLink(matcher))}}),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$cyclic$matcherParser()),$elm$parser$Parser$symbol(")")))]))),$elm$parser$Parser$succeed((function(t){return $jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasTag(t)}))]))),$elm$parser$Parser$succeed($elm$parser$Parser$Done(acc))]))}))}var $jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$matcherParser=$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$cyclic$matcherParser();$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$cyclic$matcherParser=function(){return $jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$matcherParser};var $jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$queriesParser=$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$cyclic$queriesParser();$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$cyclic$queriesParser=function(){return $jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$queriesParser};var content,emptyConfig,displayError,toUpdateEntity,toRule,specificTriggerParser,triggerParser,conditionsParser,changesParser_,skeleton,skip,finalPlayThrough,chatper2,fullPlay,scenes,parsedData,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$parseMatcher=function(text){return A2($elm$core$Result$mapError,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$deadEndsToString,A2($elm$parser$Parser$run,A2($elm$parser$Parser$ignorer,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$matcherParser,$elm$parser$Parser$end),text))},$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$parseMultiple=F2((function(parser,strings){return list=A2($elm$core$List$map,parser,strings),A3($elm$core$List$foldl,F2((function(r,acc){return r.$?$elm$core$Result$Err(r.a):A2($elm$core$Result$map,$elm$core$List$cons(r.a),acc)})),$elm$core$Result$Ok(_List_Nil),list);var list})),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$fromResult=function(res){return res.$?$elm$parser$Parser$problem(res.a):$elm$parser$Parser$succeed(res.a)},$elm$core$String$replace=F3((function(before,after,string){return A2($elm$core$String$join,after,A2($elm$core$String$split,before,string))})),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$propertyText=function(config){var keywords=A2($elm$core$List$map,(function(_v0){var propName=_v0.a;return A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed(_v0.b),$elm$parser$Parser$keyword(propName))}),$elm$core$Dict$toList(config.bW));return A2($elm$parser$Parser$andThen,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$fromResult,A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,$elm$parser$Parser$succeed(F2((function(id,propFn){return propFn(A3($elm$core$String$replace,"$",config.cc,id))}))),A2($elm$parser$Parser$ignorer,A2($elm$parser$Parser$andThen,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$notEmpty,$elm$parser$Parser$getChompedString($elm$parser$Parser$chompWhile((function(c){return!A2($elm$core$List$member,c,_List_fromArray(["{",".","|","}"]))})))),$elm$parser$Parser$symbol("."))),A2($elm$parser$Parser$ignorer,$elm$parser$Parser$oneOf(keywords),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$close)))},$elm$core$Dict$filter=F2((function(isGood,dict){return A3($elm$core$Dict$foldl,F3((function(k,v,d){return A2(isGood,k,v)?A3($elm$core$Dict$insert,k,v,d):d})),$elm$core$Dict$empty,dict)})),$elm$core$Maybe$andThen=F2((function(callback,maybeValue){return maybeValue.$?$elm$core$Maybe$Nothing:callback(maybeValue.a)})),$elm$core$Maybe$map2=F3((function(func,ma,mb){return 1===ma.$||1===mb.$?$elm$core$Maybe$Nothing:$elm$core$Maybe$Just(A2(func,ma.a,mb.a))})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$hasStat=F5((function(key,comparator,statMatcher,store,entity){if(statMatcher.$){var compareID=statMatcher.a,compareKey=statMatcher.b;return A2($elm$core$Maybe$withDefault,!1,A2($elm$core$Maybe$map,$elm$core$Basics$eq(comparator),A3($elm$core$Maybe$map2,$elm$core$Basics$compare,A2($elm$core$Dict$get,key,entity.a5),A2($elm$core$Maybe$andThen,A2($elm$core$Basics$composeR,(function($){return $.a5}),$elm$core$Dict$get(compareKey)),A2($elm$core$Dict$get,compareID,store)))))}var value=statMatcher.a;return _Utils_eq(A2($elm$core$Basics$compare,A2($elm$core$Maybe$withDefault,0,A2($elm$core$Dict$get,key,entity.a5)),value),comparator)})),$elm$core$Dict$member=F2((function(key,dict){return!A2($elm$core$Dict$get,key,dict).$})),$elm$core$Set$member=F2((function(key,_v0){return A2($elm$core$Dict$member,key,_v0)})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$hasTag=F2((function(value,entity){return A2($elm$core$Set$member,value,entity.a8)})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$findSpecific=F3((function(id,queries,store){return A2($elm$core$Maybe$withDefault,_List_Nil,A2($elm$core$Maybe$map,(function(entity){return A2($elm$core$List$all,(function(q){return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$queryFn,q,store,entity)}),queries)?_List_fromArray([_Utils_Tuple2(id,entity)]):_List_Nil}),A2($elm$core$Dict$get,id,store)))})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$hasLink=F4((function(key,linkMatcher,store,entity){var assertMatch=F2((function(matcher,actualID){if(matcher.$)return!$elm$core$List$isEmpty(A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$findSpecific,actualID,qs=matcher.a,store));var qs=matcher.b;return _Utils_eq(matcher.a,actualID)&&!$elm$core$List$isEmpty(A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$findSpecific,actualID,qs,store))}));if(linkMatcher.$){var compareID=linkMatcher.a,compareKey=linkMatcher.b;return A2($elm$core$Maybe$withDefault,!1,A3($elm$core$Maybe$map2,$elm$core$Basics$eq,A2($elm$core$Dict$get,key,entity.aN),A2($elm$core$Maybe$andThen,A2($elm$core$Basics$composeR,(function($){return $.aN}),$elm$core$Dict$get(compareKey)),A2($elm$core$Dict$get,compareID,store))))}return A2($elm$core$Maybe$withDefault,!1,A2($elm$core$Maybe$map,assertMatch(linkMatcher.a),A2($elm$core$Dict$get,key,entity.aN)))})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$queryFn=F2((function(q,store){switch(q.$){case 0:return $jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$hasTag(q.a);case 1:return A4($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$hasStat,q.a,q.b,q.c,store);case 2:return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$hasLink,q.a,q.b,store);default:return A2($elm$core$Basics$composeL,$elm$core$Basics$not,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$queryFn,q.a,store))}})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$findGeneral=F2((function(queries,store){return $elm$core$Dict$toList(A2($elm$core$Dict$filter,F2((function(id,entity){return A2($elm$core$List$all,(function(q){return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$queryFn,q,store,entity)}),queries)})),store))})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$query=F2((function(matcher,store){return matcher.$?A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$findGeneral,matcher.a,store):A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$findSpecific,matcher.a,matcher.b,store)})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$replaceTrigger=F2((function(trigger,matcher){var replaceInQuery=function(q){_v1$3:for(;;)switch(q.$){case 1:if(1===q.c.$&&"$"===q.c.a)return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasStat,q.a,q.b,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$CompareStat,trigger,q.c.b));break _v1$3;case 2:if(q.b.$){if("$"===q.b.a)return A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasLink,q.a,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$CompareLink,trigger,q.b.b));break _v1$3}if(q.b.a.$||"$"!==q.b.a.a)break _v1$3;return A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$HasLink,q.a,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SpecificLink(A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$Match,trigger,q.b.a.b)));default:break _v1$3}return q};if(1===matcher.$)return $jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$MatchAny(A2($elm$core$List$map,replaceInQuery,queries=matcher.a));var queries=matcher.b;return A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$Match,function(id){return"$"===id?trigger:id}(matcher.a),A2($elm$core$List$map,replaceInQuery,queries))})),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$staticText=A2($elm$parser$Parser$andThen,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$notEmpty,$elm$parser$Parser$getChompedString(A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed(0),$elm$parser$Parser$chompWhile((function(_char){return!A2($elm$core$List$member,_char,_List_fromArray(["{","}","|"]))}))))),$elm$random$Random$step=F2((function(_v0,seed){return _v0(seed)})),$elm$core$String$trim=function(str){return str.trim()},$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$conditionalText=function(config){var assert=function(matcher){return!$elm$core$List$isEmpty(A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$query,matcher,config.cf))};return A2($elm$parser$Parser$andThen,(function(_v5){var _final,queryText=_v5.a,ifText=_v5.b,elseText=_v5.c;return(_final=A2($elm$core$Result$map,$elm$core$List$all(A2($elm$core$Basics$composeR,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$replaceTrigger(config.cc),assert)),A2($jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$parseMultiple,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$parseMatcher,A2($elm$core$List$map,$elm$core$String$trim,A2($elm$core$String$split,"&",queryText))))).$?$elm$parser$Parser$problem(_final.a):$elm$parser$Parser$commit(_final.a?ifText:elseText)}),A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,$elm$parser$Parser$succeed(F3((function(a,b,c){return _Utils_Tuple3(a,b,c)}))),A2($elm$parser$Parser$ignorer,A2($elm$parser$Parser$andThen,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$notEmpty,$elm$parser$Parser$getChompedString($elm$parser$Parser$chompUntil("?"))),$elm$parser$Parser$symbol("?"))),$elm$parser$Parser$lazy((function(){return $jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$parseText(config)}))),$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$break),A2($elm$parser$Parser$ignorer,$elm$parser$Parser$lazy((function(){return $jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$parseText(config)})),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$close)),A2($elm$parser$Parser$map,$elm$core$Basics$always(""),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$close)]))))},$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$cyclingText=function(config){var helper=function(acc){return $elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,$elm$core$Basics$always($elm$parser$Parser$Loop(A2($elm$core$List$cons,"",acc))),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$break),A2($elm$parser$Parser$map,$elm$core$Basics$always($elm$parser$Parser$Done($elm$core$List$reverse(A2($elm$core$List$cons,"",acc)))),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$close),A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,$elm$parser$Parser$succeed(F2((function(a,f){return f(a)}))),$elm$parser$Parser$lazy((function(){return $jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$parseText(config)}))),$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,$elm$core$Basics$always((function(t){return $elm$parser$Parser$Loop(A2($elm$core$List$cons,t,acc))})),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$break),A2($elm$parser$Parser$map,$elm$core$Basics$always((function(t){return $elm$parser$Parser$Done($elm$core$List$reverse(A2($elm$core$List$cons,t,acc)))})),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$close)])))]))},findCurrent=F2((function(cycleType,l){switch(cycleType){case 2:return A2($elm$core$Maybe$withDefault,"ERROR finding correct cycling text",(i=A2($elm$core$Basics$modBy,$elm$core$List$length(l),A2($elm$random$Random$step,A2($elm$random$Random$int,0,200),function(x){var _v0=$elm$random$Random$next(A2($elm$random$Random$Seed,0,1013904223));return $elm$random$Random$next(A2($elm$random$Random$Seed,_v0.a+x>>>0,_v0.b))}(config.bq*$elm$core$String$length(config.cc))).a),A2($elm$core$Array$get,i,$elm$core$Array$fromList(l))));case 1:return A2($elm$core$Maybe$withDefault,"ERROR finding correct cycling text",A2($elm$core$Array$get,A2($elm$core$Basics$modBy,$elm$core$List$length(l),config.bq),$elm$core$Array$fromList(l)));default:return A2($elm$core$Maybe$withDefault,"ERROR finding correct cycling text",A2($elm$core$Array$get,A2($elm$core$Basics$min,$elm$core$List$length(l)-1,config.bq),$elm$core$Array$fromList(l)))}var i}));return A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,$elm$parser$Parser$succeed(findCurrent),$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,$elm$core$Basics$always(1),$elm$parser$Parser$symbol("~")),A2($elm$parser$Parser$map,$elm$core$Basics$always(2),$elm$parser$Parser$symbol("?")),$elm$parser$Parser$succeed(0)]))),A2($elm$parser$Parser$loop,_List_Nil,helper))},$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$parseText=function(config){var topLevel=$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$open),$elm$parser$Parser$oneOf(_List_fromArray([$elm$parser$Parser$backtrackable($jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$conditionalText(config)),$elm$parser$Parser$backtrackable($jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$propertyText(config)),$elm$parser$Parser$backtrackable($jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$cyclingText(config))]))),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$staticText])),join=F2((function(next,base){return $elm$parser$Parser$Loop(_Utils_ap(next,base))})),l=function(base){return $elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,join(base),topLevel),$elm$parser$Parser$succeed($elm$parser$Parser$Done(base))]))};return A2($elm$parser$Parser$keeper,$elm$parser$Parser$succeed($elm$core$Basics$identity),A2($elm$parser$Parser$loop,"",l))},$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$top=function(config){return A2($elm$parser$Parser$ignorer,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$parseText(config),$elm$parser$Parser$end)},$author$project$NarrativeContent$parseAll=(content=$author$project$NarrativeContent$all,emptyConfig={bq:0,bW:$elm$core$Dict$empty,cc:"",cf:$elm$core$Dict$empty},displayError=F3((function(k,v,e){return _Utils_Tuple2("Narrative content: "+k+"\n"+v+" ",$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$deadEndsToString(e))})),A3($elm$core$Dict$foldl,F3((function(k,v,acc){var _v0=A2($elm$parser$Parser$run,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$top(emptyConfig),v);if(_v0.$){var e=_v0.a;if(acc.$){var errors=acc.a;return $elm$core$Result$Err(A2($elm$core$List$cons,A3(displayError,k,v,e),errors))}return $elm$core$Result$Err(_List_fromArray([A3(displayError,k,v,e)]))}return acc})),$elm$core$Result$Ok(0),content)),$elm$html$Html$code=_VirtualDom_node("code"),$elm$html$Html$div=_VirtualDom_node("div"),$elm$html$Html$h1=_VirtualDom_node("h1"),$elm$html$Html$li=_VirtualDom_node("li"),$elm$html$Html$pre=_VirtualDom_node("pre"),$elm$virtual_dom$VirtualDom$style=_VirtualDom_style,$elm$html$Html$Attributes$style=$elm$virtual_dom$VirtualDom$style,$elm$virtual_dom$VirtualDom$text=_VirtualDom_text,$elm$html$Html$text=$elm$virtual_dom$VirtualDom$text,$elm$html$Html$ul=_VirtualDom_node("ul"),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$parseErrorsView=function(errors){return A2($elm$html$Html$div,_List_fromArray([A2($elm$html$Html$Attributes$style,"background","black"),A2($elm$html$Html$Attributes$style,"color","red"),A2($elm$html$Html$Attributes$style,"padding","4em"),A2($elm$html$Html$Attributes$style,"display","flex"),A2($elm$html$Html$Attributes$style,"flex-direction","column"),A2($elm$html$Html$Attributes$style,"align-items","center"),A2($elm$html$Html$Attributes$style,"justify-content","center")]),_List_fromArray([A2($elm$html$Html$h1,_List_Nil,_List_fromArray([$elm$html$Html$text("Errors when parsing!  Please fix:")])),A2($elm$html$Html$ul,_List_fromArray([A2($elm$html$Html$Attributes$style,"width","100%")]),A2($elm$core$List$map,(function(_v0){var source=_v0.a,error=_v0.b;return A2($elm$html$Html$li,_List_fromArray([A2($elm$html$Html$Attributes$style,"margin-bottom","2em")]),_List_fromArray([A2($elm$html$Html$pre,_List_fromArray([A2($elm$html$Html$Attributes$style,"background","white"),A2($elm$html$Html$Attributes$style,"padding","1em"),A2($elm$html$Html$Attributes$style,"color","black"),A2($elm$html$Html$Attributes$style,"overflow"," auto"),A2($elm$html$Html$Attributes$style,"width","100%")]),_List_fromArray([A2($elm$html$Html$code,_List_Nil,_List_fromArray([$elm$html$Html$text(source)]))])),$elm$html$Html$text(error)]))}),errors))]))},$author$project$Rules$Helpers$rule_______________________=F3((function(k,v,dict){return A3($elm$core$Dict$insert,k,_Utils_Tuple2(v,{}),dict)})),$author$project$Rules$Chapter1$rules=A3($author$project$Rules$Helpers$rule_______________________,"meetConductorFirstTime","\n            ON: GRIZZLED_SECURITY_GUARD\n            DO: ORANGE_LINE_PASS.location=PLAYER\n                (*.pass).new\n                PLAYER.chapter=2\n                MAN_IN_HOT_DOG_SUIT.location=TWIN_BROOKS\n                MAINTENANCE_MAN.location=ONE_HUNDRED_FORTH_STREET\n            ",A3($author$project$Rules$Helpers$rule_______________________,"escapingInfractionRoom","\n            ON: INFRACTIONS_ROOM_DOOR.infraction_step=3\n            DO: INFRACTIONS_INSTRUCTIONS_POSTER.location=offscreen\n                INFRACTIONS_COMPUTER.location=offscreen\n                INFRACTIONS_PRINTER.location=offscreen\n                INFRACTIONS_ROOM_DOOR.location=offscreen\n                INFRACTIONS_CARD_READER.location=offscreen\n                GRIZZLED_SECURITY_GUARD.location=CENTRAL_GUARD_OFFICE\n            ",A3($author$project$Rules$Helpers$rule_______________________,"breakInfractionAutomationSystem","\n            ON: INFRACTIONS_GREEN_BUTTON\n            DO: INFRACTIONS_ROOM_DOOR.infraction_step=3\n                INFRACTIONS_GREEN_BUTTON.pressed\n            ",A3($author$project$Rules$Helpers$rule_______________________,"infractionAutomationStep3","\n            ON: INFRACTIONS_PRINTER\n            IF: INFRACTIONS_ROOM_DOOR.infraction_step>1\n            DO: INFRACTIONS_ROOM_DOOR.infraction_step=3\n            ",A3($author$project$Rules$Helpers$rule_______________________,"infractionAutomationStep2","\n            ON: INFRACTIONS_COMPUTER\n            IF: INFRACTIONS_ROOM_DOOR.infraction_step=1\n            DO: INFRACTIONS_ROOM_DOOR.infraction_step=2\n            ",A3($author$project$Rules$Helpers$rule_______________________,"infractionAutomationStep1","\n            ON: INFRACTIONS_CARD_READER\n            IF: INFRACTIONS_ROOM_DOOR.infraction_step=0\n            DO: INFRACTIONS_ROOM_DOOR.infraction_step=1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"pourSodaOnInfractionsMachine","\n            ON: SODA\n            IF: INFRACTIONS_INSTRUCTIONS_POSTER.read\n                PLAYER.chapter=1\n            DO: SODA.location=offscreen\n                INFRACTIONS_ROOM_DOOR.infraction_step=3\n                PLAYER.good_will-10\n            ",A3($author$project$Rules$Helpers$rule_______________________,"readingInfrationsPoster","\n            ON: INFRACTIONS_INSTRUCTIONS_POSTER\n            DO: INFRACTIONS_INSTRUCTIONS_POSTER.read\n            ",A3($author$project$Rules$Helpers$rule_______________________,"TICKET_INSPECTOR","\n            ON: TICKET_INSPECTOR\n            DO: INFRACTIONS_INSTRUCTIONS_POSTER.location=CENTRAL_GUARD_OFFICE\n                INFRACTIONS_COMPUTER.location=CENTRAL_GUARD_OFFICE\n                INFRACTIONS_PRINTER.location=CENTRAL_GUARD_OFFICE\n                INFRACTIONS_ROOM_DOOR.location=CENTRAL_GUARD_OFFICE\n                INFRACTIONS_CARD_READER.location=CENTRAL_GUARD_OFFICE\n                $.location=offscreen\n            ",A3($author$project$Rules$Helpers$rule_______________________,"caughtOnOrangeLineHeadingToOther","\n            ON: *.station\n            IF: PLAYER.chapter=1.location=CAPITOL_HEIGHTS.find_briefcase=3\n            DO: PLAYER.location=ST_MARKS\n            ",A3($author$project$Rules$Helpers$rule_______________________,"caughtOnOrangeLineHeadingTo73rd","\n            ON: SEVENTY_THIRD_STREET\n            IF: PLAYER.chapter=1.location=CAPITOL_HEIGHTS.find_briefcase=3\n            DO: PLAYER.location=ST_MARKS\n            ",A3($author$project$Rules$Helpers$rule_______________________,"jumpTurnstileAfterTaklingToMark","\n            ON: ORANGE_LINE\n            IF: PLAYER.chapter=1.location=CAPITOL_HEIGHTS.find_briefcase=3.at_turnstile\n            DO: PLAYER.line=ORANGE_LINE.-at_turnstile\n            ",A3($author$project$Rules$Helpers$rule_______________________,"pleasantriesWithMark","\n            ON: MARK\n            IF: PLAYER.find_briefcase>2\n            ",A3($author$project$Rules$Helpers$rule_______________________,"markTellsAboutBroomCloset","\n            ON: MARK\n            IF: PLAYER.find_briefcase=2\n            DO: PLAYER.find_briefcase=3\n            ",A3($author$project$Rules$Helpers$rule_______________________,"findKeyInTrashCan","\n            ON: TRASH_CAN_CAPITOL_HEIGHTS.!empty\n            DO: ODD_KEY.location=PLAYER\n                TRASH_CAN_CAPITOL_HEIGHTS.empty\n            ",A3($author$project$Rules$Helpers$rule_______________________,"followSkaterDudeToCapitalHeights","\n            ON: CAPITOL_HEIGHTS\n            IF: PLAYER.chapter=1.location=SPRING_HILL\n                SKATER_DUDE.help_steve=1\n            DO: PLAYER.destination=xxx.location=CAPITOL_HEIGHTS.find_briefcase=2\n                SKATER_DUDE.location=offscreen.help_steve=2\n            ",A3($author$project$Rules$Helpers$rule_______________________,"jumpTurnstileWithSkaterDude","\n            ON: ORANGE_LINE\n            IF: PLAYER.chapter=1.location=SPRING_HILL.at_turnstile\n                SKATER_DUDE.help_steve=1\n            DO: PLAYER.line=ORANGE_LINE.-at_turnstile\n            ",A3($author$project$Rules$Helpers$rule_______________________,"followSkaterDudeToOrangeLine","\n            ON: ORANGE_LINE\n            IF: PLAYER.chapter=1.location=SPRING_HILL\n                SKATER_DUDE.help_steve=1\n            DO: PLAYER.line=ORANGE_LINE.at_turnstile\n            ",A3($author$project$Rules$Helpers$rule_______________________,"forcePlayerToFollowSkaterDudeToCapitolHeights","\n            ON: *.station\n            IF: PLAYER.chapter=1.location=SPRING_HILL\n                SKATER_DUDE.help_steve=1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"forcePlayerToFollowSkaterDudeOntoOrangeLine","\n            ON: RED_LINE\n            IF: PLAYER.chapter=1.location=SPRING_HILL\n                SKATER_DUDE.help_steve=1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"helpFromSkaterDude","\n            ON: SKATER_DUDE\n            IF: PLAYER.chapter=1.location=SPRING_HILL\n            DO: SKATER_DUDE.help_steve=1\n                PLAYER.destination=CAPITOL_HEIGHTS\n            ",A3($author$project$Rules$Helpers$rule_______________________,"findingSecurityDepotClosed","\n            ON: SECURITY_DEPOT_SPRING_HILL_STATION\n            IF: BROADWAY_STREET.leaving_broadway_street_station_plot<5\n                PLAYER.chapter=1\n            DO: BROADWAY_STREET.leaving_broadway_street_station_plot=5\n                SKATER_DUDE.location=SPRING_HILL\n            ",A3($author$project$Rules$Helpers$rule_______________________,"panic","\n            ON: *.station\n            IF: BROADWAY_STREET.leaving_broadway_street_station_plot=2\n                PLAYER.chapter=1\n            DO: PLAYER.location=$\n                BROADWAY_STREET.leaving_broadway_street_station_plot=4\n            ",A3($author$project$Rules$Helpers$rule_______________________,"ignoreGuardsAdvice","\n            ON: *.station\n            IF: BROADWAY_STREET.leaving_broadway_street_station_plot=3\n                PLAYER.chapter=1\n            DO: PLAYER.location=$\n                BROADWAY_STREET.leaving_broadway_street_station_plot=4\n            ",A3($author$project$Rules$Helpers$rule_______________________,"followGuardsAdvice","\n            ON: SPRING_HILL\n            IF: BROADWAY_STREET.leaving_broadway_street_station_plot=3\n                PLAYER.chapter=1\n            DO: PLAYER.location=SPRING_HILL\n                BROADWAY_STREET.leaving_broadway_street_station_plot=4\n            ",A3($author$project$Rules$Helpers$rule_______________________,"tellCommuter1AboutStolenBriefcase","\n            ON: COMMUTER_1\n            IF: BROADWAY_STREET.leaving_broadway_street_station_plot>1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"tellOfficersAboutStolenBriefcase","\n            ON: SECURITY_OFFICERS\n            IF: BROADWAY_STREET.leaving_broadway_street_station_plot=2\n            DO: BROADWAY_STREET.leaving_broadway_street_station_plot=3\n            ",A3($author$project$Rules$Helpers$rule_______________________,"briefcaseStolen","\n            ON: *.line\n            IF: PLAYER.chapter=1\n                BROADWAY_STREET.leaving_broadway_street_station_plot=1\n            DO: BRIEFCASE.location=THIEF\n                BROADWAY_STREET.leaving_broadway_street_station_plot=2\n                GIRL_IN_YELLOW.location=IRIS_LAKE\n                PLAYER.find_briefcase=1.present_proposal=4\n            ",A3($author$project$Rules$Helpers$rule_______________________,"noticeGirlInYellow","\n            ON: GIRL_IN_YELLOW\n            IF: PLAYER.chapter=1\n            DO: GIRL_IN_YELLOW.who_was_girl_in_yellow_quest+1\n                GIRL_IN_YELLOW.location=IRIS_LAKE\n            ",A3($author$project$Rules$Helpers$rule_______________________,"askCommuter1AboutDelay","\n            ON: COMMUTER_1\n            IF: BROADWAY_STREET.leaving_broadway_street_station_plot<2\n                PLAYER.chapter=1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"askOfficersAboutDelay","\n            ON: SECURITY_OFFICERS\n            IF: BROADWAY_STREET.leaving_broadway_street_station_plot<2\n            DO: BROADWAY_STREET.leaving_broadway_street_station_plot=1\n                PLAYER.present_proposal=3\n            ",A3($author$project$Rules$Helpers$rule_______________________,"leavingBroadwayStationPrematurely","\n            ON: *.line\n            IF: PLAYER.location=BROADWAY_STREET\n                BROADWAY_STREET.leaving_broadway_street_station_plot<1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"notGoingToWorkAgain","\n            ON: *.station\n            IF: PLAYER.destination=BROADWAY_STREET.chapter=1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"delaysAtBroadwayStreetStation","\n            ON: BROADWAY_STREET\n            IF: PLAYER.destination=BROADWAY_STREET.chapter=1\n            DO: PLAYER.location=BROADWAY_STREET.destination=xxx\n                BROADWAY_STREET.out_of_service\n                COMMUTER_1.location=BROADWAY_STREET\n            ",A3($author$project$Rules$Helpers$rule_______________________,"getMap","\n            ON: MAP_POSTER\n            IF: MAP.!location=PLAYER\n            DO: MAP.location=PLAYER\n            ",A3($author$project$Rules$Helpers$rule_______________________,"askMaintenanceManForDirections","\n            ON: MAINTENANCE_MAN\n            IF: PLAYER.destination=BROADWAY_STREET.chapter=1\n            ",$elm$core$Dict$empty)))))))))))))))))))))))))))))))))))),$author$project$Rules$Chapter2$rules=A3($author$project$Rules$Helpers$rule_______________________,"workersComplainingAboutClosuresOnTrain","\n            ON: *.station.!out_of_service\n            IF: PLAYER.!heardAboutClosures.line=RED_LINE\n                ORANGE_LINE_PASS.location=PLAYER\n            DO: PLAYER.location=$.heardAboutClosures\n            ",A3($author$project$Rules$Helpers$rule_______________________,"womenTalkingAboutHotdogManOnTrain","\n            ON: *.station.!out_of_service\n            IF: PLAYER.!heardOfHotdogMan\n                ORANGE_LINE_PASS.location=PLAYER\n            DO: PLAYER.location=$.heardOfHotdogMan\n            ",A3($author$project$Rules$Helpers$rule_______________________,"check_wet_jeans",'\n            ON: "check_wet_jeans"\n            DO: CHANGE.amount+25\n            ',A3($author$project$Rules$Helpers$rule_______________________,"wetPantsOnTrain","\n            ON: *.station.!out_of_service\n            IF: PLAYER.call_boss=1.line=RED_LINE\n                CHANGE.amount=25\n            DO: PLAYER.location=$\n            ",A3($author$project$Rules$Helpers$rule_______________________,"persist_sitting_in_saved_seat",'\n            ON: "persist_sitting_in_saved_seat"\n            DO: PLAYER.good_will-3\n            ',A3($author$project$Rules$Helpers$rule_______________________,"attempt_to_sit_in_saved_seat",'\n            ON: "attempt_to_sit_in_saved_seat"\n            ',A3($author$project$Rules$Helpers$rule_______________________,"savedSeatOnTrain","\n            ON: *.station.!out_of_service\n            IF: PLAYER.good_will<0.location=CONVENTION_CENTER.!seen_saved_seat\n            DO: PLAYER.location=$.seen_saved_seat\n            ",A3($author$project$Rules$Helpers$rule_______________________,"jumpTurnstileFortySecondStreet",'\n            ON: "just_do_it"\n            ',A3($author$project$Rules$Helpers$rule_______________________,"questionJumpingTurnstiles","\n            ON: BLUE_LINE\n            IF: PLAYER.at_turnstile.location=FORTY_SECOND_STREET\n            ",A3($author$project$Rules$Helpers$rule_______________________,"tryToJumpTurnstileWithRepairManWatching","\n            ON: BLUE_LINE\n            IF: PLAYER.at_turnstile.location=FORTY_SECOND_STREET\n                GRIZZLED_REPAIRMAN.location=FORTY_SECOND_STREET\n            ",A3($author$project$Rules$Helpers$rule_______________________,"maintenanceManAtOneHundredFourthStreet","\n            ON: MAINTENANCE_MAN.location=ONE_HUNDRED_FORTH_STREET\n            ",A3($author$project$Rules$Helpers$rule_______________________,"coffee_ruined",'\n            ON: "help_a_guy_out"\n            DO: SLEEPING_MAN.coffee_ruined\n                CHANGE.amount-25\n            ',A3($author$project$Rules$Helpers$rule_______________________,"confrontConductor",'\n            ON: "confront_repairman"\n            DO: GRIZZLED_REPAIRMAN.location=offscreen\n                ELECTRIC_PANEL.-hidden\n            ',A3($author$project$Rules$Helpers$rule_______________________,"catchConductorMessingWithPanel","\n            ON: GRIZZLED_REPAIRMAN.location=FORTY_SECOND_STREET\n            ",A3($author$project$Rules$Helpers$rule_______________________,"girlInYellowSecondEncounter","\n            ON: GIRL_IN_YELLOW\n            DO: GIRL_IN_YELLOW.who_was_girl_in_yellow_quest+1.location=WESTGATE\n            ",A3($author$project$Rules$Helpers$rule_______________________,"stealMusiciansChangeSecondTime",'\n            ON: "musicians_change"\n            IF: MUSICIAN.robbed\n            DO: PLAYER.good_will-5\n            ',A3($author$project$Rules$Helpers$rule_______________________,"stealMusiciansChange",'\n            ON: "musicians_change"\n            DO: MUSICIAN.robbed\n                CHANGE.amount+50.location=PLAYER\n                PLAYER.good_will-3\n            ',A3($author$project$Rules$Helpers$rule_______________________,"askBusinessmanForChange","\n            ON: BUSINESS_MAN\n            IF: PLAYER.call_boss=1\n            DO: BUSINESS_MAN.location=offscreen\n            ",A3($author$project$Rules$Helpers$rule_______________________,"tryingToCallBossWithCellphone","\n            ON: CELL_PHONE\n            IF: PLAYER.call_boss=1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"readyToCallBoss","\n            ON: SEVENTY_THIRD_STREET\n            IF: PLAYER.call_boss=1\n                CHANGE.amount>49\n            DO: PLAYER.location=$\n            ",A3($author$project$Rules$Helpers$rule_______________________,"ponderingCallingBossOnTrain","\n            ON: *.station.!out_of_service\n            IF: PLAYER.call_boss=1\n            DO: PLAYER.location=$\n            ",A3($author$project$Rules$Helpers$rule_______________________,"exitPassagewayAtFortySecondStreet",'\n            ON: "disembark"\n            IF: PLAYER.location=FORTY_SECOND_STREET.call_boss=3\n            DO: PLAYER.call_boss=4\n            ',A3($author$project$Rules$Helpers$rule_______________________,"passageLocked","\n            ON: MAINTENANCE_DOOR_FORTY_SECOND_STREET_TO_SEVENTY_THIRD_STREET\n            ",A3($author$project$Rules$Helpers$rule_______________________,"chaseThiefAgain","\n            ON: MAINTENANCE_DOOR_SEVENTY_THIRD_STREET_TO_FORTY_SECOND_STREET\n            IF: PLAYER.call_boss=2\n            DO: PLAYER.call_boss=3.location=FORTY_SECOND_STREET.mapLevel=1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"collectedEnoughChangeToCallBoss","\n            ON: PAYPHONE_SEVENTY_THIRD_STREET\n            IF: CHANGE.amount>49\n                PLAYER.call_boss=1\n            DO: CHANGE.amount-50\n                PLAYER.call_boss=2\n                MAINTENANCE_DOOR_SEVENTY_THIRD_STREET_TO_FORTY_SECOND_STREET.-hidden\n            ",A3($author$project$Rules$Helpers$rule_______________________,"useChangeFromMotherToCallBoss","\n            ON: PAYPHONE_SEVENTY_THIRD_STREET\n            IF: CHANGE.amount=50\n                PLAYER.call_boss=1\n                MOTHER.screaming_child_quest=1\n            DO: CHANGE.amount-50\n                PLAYER.good_will-1\n                PLAYER.call_boss=2\n                MOTHER.location=offscreen.screaming_child_quest=100\n                MAINTENANCE_DOOR_SEVENTY_THIRD_STREET_TO_FORTY_SECOND_STREET.-hidden\n            ",A3($author$project$Rules$Helpers$rule_______________________,"needCoinsForPayphone","\n            ON: PAYPHONE_SEVENTY_THIRD_STREET\n            IF: PLAYER.call_boss=1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"throwAwayPosters",'\n            ON: "throw_away_posters"\n            DO: (*.missing_dog_poster.!location=SPRING_HILL).location=offscreen\n                PLAYER.good_will-3\n                DISTRESSED_WOMAN.missing_dog_posters_quest=100\n            ',A3($author$project$Rules$Helpers$rule_______________________,"tryToHangRedundantDogPosters","\n            ON: *.missing_dog_poster.location=PLAYER\n            IF: *.missing_dog_poster.location=(link PLAYER.location)\n                DISTRESSED_WOMAN.missing_dog_posters_quest>0\n            ",A3($author$project$Rules$Helpers$rule_______________________,"tryToHangDogPosterOnWrongLine","\n            ON: *.missing_dog_poster.location=PLAYER\n            IF: PLAYER.!line=RED_LINE\n            ",A3($author$project$Rules$Helpers$rule_______________________,"putUpLastMissingDogPoster","\n            ON: *.missing_dog_poster.location=PLAYER\n            IF: DISTRESSED_WOMAN.missing_dog_posters_quest=5\n            DO: $.location=(link PLAYER.location)\n                DISTRESSED_WOMAN.missing_dog_posters_quest+1\n                PLAYER.good_will+5\n            ",A3($author$project$Rules$Helpers$rule_______________________,"putUpMissingDogPoster","\n            ON: *.missing_dog_poster.location=PLAYER\n            DO: $.location=(link PLAYER.location)\n                DISTRESSED_WOMAN.missing_dog_posters_quest+1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"lookAtHangingDogPosters","\n            ON: *.missing_dog_poster\n            ",A3($author$project$Rules$Helpers$rule_______________________,"getDogPostersFromDistressedWoman","\n            ON: DISTRESSED_WOMAN\n            DO: MISSING_DOG_POSTER_1.location=PLAYER\n                MISSING_DOG_POSTER_2.location=PLAYER\n                MISSING_DOG_POSTER_3.location=PLAYER\n                MISSING_DOG_POSTER_4.location=PLAYER\n                MISSING_DOG_POSTER_5.location=PLAYER\n                DISTRESSED_WOMAN.location=offscreen.missing_dog_posters_quest=1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"checkBroomClosetButNotBriefcase","\n            ON: BROOM_CLOSET\n            IF: PLAYER.find_briefcase=3\n            DO: PLAYER.find_briefcase=4.call_boss=1\n                VENDING_MACHINE.coin_in_coin_return\n                BROKEN_PAYPHONE.coin_in_coin_return\n            ",$elm$core$Dict$empty))))))))))))))))))))))))))))))))))),$author$project$Rules$General$rules=A3($author$project$Rules$Helpers$rule_______________________,"showFeedbackDialog",'\n            ON: "disembark"\n            IF: PLAYER.showFeedback\n            DO: PLAYER.-showFeedback\n            ',A3($author$project$Rules$Helpers$rule_______________________,"use_secret_passage_way","\n            ON: *.passage_to=(*).!locked\n            DO: PLAYER.location=(link $.passage_to)\n            ",A3($author$project$Rules$Helpers$rule_______________________,"check_coin_return","\n            ON: *.coin_in_coin_return\n            DO: $.-coin_in_coin_return\n                CHANGE.amount+25.location=PLAYER\n            ",A3($author$project$Rules$Helpers$rule_______________________,"trashcan","\n            ON: *.trashcan\n            ",A3($author$project$Rules$Helpers$rule_______________________,"inspectPasses","\n            ON: *.pass\n            DO: (*.pass.new).-new\n            ",A3($author$project$Rules$Helpers$rule_______________________,"notebookInstructions","\n            ON: NOTEBOOK.new\n            DO: NOTEBOOK.-new.silent\n            ",A3($author$project$Rules$Helpers$rule_______________________,"checkMap","\n            ON: *.map\n            ",A3($author$project$Rules$Helpers$rule_______________________,"jumpTurnstileFail","\n            ON: *.line\n            DO: PLAYER\n            ",A3($author$project$Rules$Helpers$rule_______________________,"goToLinePlatform","\n            ON: *.line\n            IF: PLAYER.at_turnstile\n                *.valid_on=$.location=PLAYER\n            DO: PLAYER.-at_turnstile\n            ",A3($author$project$Rules$Helpers$rule_______________________,"goToLineTurnstile","\n            ON: *.line\n            IF: PLAYER.!at_turnstile\n            DO: PLAYER.line=$.at_turnstile\n            ",A3($author$project$Rules$Helpers$rule_______________________,"goToLobby","\n            ON: LOBBY\n            DO: PLAYER.-at_turnstile\n            ",A3($author$project$Rules$Helpers$rule_______________________,"nextDay",'\n            ON: "next_day"\n            ',A3($author$project$Rules$Helpers$rule_______________________,"outOfServiceStations","\n            ON: *.station.out_of_service\n            ",A3($author$project$Rules$Helpers$rule_______________________,"ridingTheTrain","\n            ON: *.station\n            DO: PLAYER.location=$\n            ",$elm$core$Dict$empty)))))))))))))),$author$project$Rules$Intro$rules=A3($author$project$Rules$Helpers$rule_______________________,"fallAsleep","\n            ON: BROADWAY_STREET\n            IF: PLAYER.day=5.chapter=0\n            DO: PLAYER.location=TWIN_BROOKS.chapter+1.present_proposal=2.showFeedback\n                COFFEE.location=offscreen\n            ",A3($author$project$Rules$Helpers$rule_______________________,"endThursday","\n            ON: BROADWAY_STREET\n            IF: PLAYER.day=4\n            DO: PLAYER.location=EAST_MULBERRY.day+1.present_proposal=1\n                CELL_PHONE.new\n                COFFEE.location=offscreen\n                TRASH_DIGGER.location=offscreen\n                BENCH_BUM.location=offscreen\n                SODA_MACHINE.-broken\n                NOTEBOOK.location=PLAYER\n            ",A3($author$project$Rules$Helpers$rule_______________________,"endWednesday","\n            ON: BROADWAY_STREET\n            IF: PLAYER.day=3\n            DO: PLAYER.location=EAST_MULBERRY.day+1\n                CELL_PHONE.new\n                COFFEE.location=offscreen\n                SKATER_DUDE.location=offscreen\n                TRASH_DIGGER.location=EAST_MULBERRY\n                BENCH_BUM.location=EAST_MULBERRY\n            ",A3($author$project$Rules$Helpers$rule_______________________,"endTuesday","\n            ON: BROADWAY_STREET\n            IF: PLAYER.day=2\n            DO: PLAYER.location=EAST_MULBERRY.day+1\n                CELL_PHONE.new\n                COFFEE.location=offscreen\n                TRASH_DIGGER.location=offscreen\n                SKATER_DUDE.location=EAST_MULBERRY\n            ",A3($author$project$Rules$Helpers$rule_______________________,"endMonday","\n            ON: BROADWAY_STREET\n            IF: PLAYER.day=1\n            DO: PLAYER.location=EAST_MULBERRY.day+1\n                CELL_PHONE.new\n                COFFEE.location=offscreen\n                COMMUTER_1.location=offscreen\n                LOUD_PAYPHONE_LADY.location=offscreen\n                PAYPHONE_EAST_MULBERRY.location=EAST_MULBERRY\n                TRASH_DIGGER.location=EAST_MULBERRY\n            ",A3($author$project$Rules$Helpers$rule_______________________,"firstInteractionWithCommuter1","\n            ON: COMMUTER_1\n            IF: PLAYER.chapter=0\n            DO: COMMUTER_1.friendliness=1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"firstMeetSkaterDude","\n            ON: SKATER_DUDE\n            IF: PLAYER.chapter=0\n            DO: $.location=offscreen\n            ",A3($author$project$Rules$Helpers$rule_______________________,"get_caffeinated_quest_3","\n            ON: SODA_MACHINE.!broken.get_caffeinated_quest=3\n            IF: PLAYER.chapter=0\n            ",A3($author$project$Rules$Helpers$rule_______________________,"drink_old_soda","\n            ON: SODA\n            IF: MOTHER.screaming_child_quest<1\n            DO: SODA.location=offscreen\n            ",A3($author$project$Rules$Helpers$rule_______________________,"get_caffeinated_quest_2","\n            ON: SODA_MACHINE.!broken.get_caffeinated_quest=2\n            IF: PLAYER.chapter=0\n            DO: $.get_caffeinated_quest+1\n                PLAYER.persistent+1\n                SODA.location=PLAYER\n            ",A3($author$project$Rules$Helpers$rule_______________________,"get_caffeinated_quest_1","\n            ON: SODA_MACHINE.!broken.get_caffeinated_quest=1\n            IF: PLAYER.chapter=0\n            DO: $.get_caffeinated_quest+1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"sodaMachineFixed","\n            ON: SODA_MACHINE.!broken\n            IF: PLAYER.chapter=0\n            ",A3($author$project$Rules$Helpers$rule_______________________,"sodaMachineBroken","\n            ON: SODA_MACHINE.broken\n            ",A3($author$project$Rules$Helpers$rule_______________________,"coffeeCartFriday","\n            ON: COFFEE_CART\n            IF: PLAYER.day=5.chapter=0\n                SODA_MACHINE.get_caffeinated_quest<1\n            DO: SODA_MACHINE.get_caffeinated_quest=1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"coffeeCartThursday","\n            ON: COFFEE_CART\n            IF: PLAYER.day=4\n            DO: COFFEE.location=PLAYER\n            ",A3($author$project$Rules$Helpers$rule_______________________,"coffeeCartWednesday","\n            ON: COFFEE_CART\n            IF: PLAYER.day=3\n            DO: COFFEE.location=PLAYER\n            ",A3($author$project$Rules$Helpers$rule_______________________,"coffeeCartTuesday","\n            ON: COFFEE_CART\n            IF: PLAYER.day=2\n            DO: COFFEE.location=PLAYER\n            ",A3($author$project$Rules$Helpers$rule_______________________,"coffeeCartMonday","\n            ON: COFFEE_CART\n            IF: PLAYER.day=1\n            DO: COFFEE.location=PLAYER\n            ",A3($author$project$Rules$Helpers$rule_______________________,"forcePlayerToReadEmails","\n            ON: *.line\n            IF: CELL_PHONE.new\n                PLAYER.chapter=0\n            ",A3($author$project$Rules$Helpers$rule_______________________,"checkEmailsDay5","\n            ON: CELL_PHONE\n            IF: PLAYER.day=5\n            DO: CELL_PHONE.-new\n            ",A3($author$project$Rules$Helpers$rule_______________________,"checkEmailsDay4","\n            ON: CELL_PHONE\n            IF: PLAYER.day=4\n            DO: CELL_PHONE.-new\n            ",A3($author$project$Rules$Helpers$rule_______________________,"checkEmailsDay3","\n            ON: CELL_PHONE\n            IF: PLAYER.day=3\n            DO: CELL_PHONE.-new\n            ",A3($author$project$Rules$Helpers$rule_______________________,"checkEmailsDay2","\n            ON: CELL_PHONE\n            IF: PLAYER.day=2\n            DO: CELL_PHONE.-new\n            ",A3($author$project$Rules$Helpers$rule_______________________,"checkEmailsDay1","\n            ON: CELL_PHONE\n            IF: PLAYER.day=1\n            DO: CELL_PHONE.-new\n            ",A3($author$project$Rules$Helpers$rule_______________________,"notGoingToWork","\n            ON: *.station\n            IF: PLAYER.destination=BROADWAY_STREET.chapter=0\n            ",$elm$core$Dict$empty))))))))))))))))))))))))),$author$project$Rules$Quests$rules=A3($author$project$Rules$Helpers$rule_______________________,"man_in_hot_dog_suit_wants_more","\n            ON: MAN_IN_HOT_DOG_SUIT.job_hunt_quest_1=3\n            ",A3($author$project$Rules$Helpers$rule_______________________,"hot_dog_man_rebuffed","\n            ON: MAN_IN_HOT_DOG_SUIT.location=TWIN_BROOKS.job_hunt_quest_1=100\n            ",A3($author$project$Rules$Helpers$rule_______________________,"throw_away_mascot_papers",'\n            ON: "throw_away_mascot_papers"\n            DO: MASCOT_PAPERS.location=offscreen\n                PLAYER.good_will-1\n                MAN_IN_HOT_DOG_SUIT.job_hunt_quest_1=100\n            ',A3($author$project$Rules$Helpers$rule_______________________,"check_up_on_hot_dog_guy_at_franks_franks","\n            ON: MAN_IN_HOT_DOG_SUIT.job_hunt_quest_1=2\n            DO: MAN_IN_HOT_DOG_SUIT.job_hunt_quest_1=3\n                CHANGE.location=PLAYER.amount+50\n                PLAYER.good_will+3\n            ",A3($author$project$Rules$Helpers$rule_______________________,"give_mascot_papers_to_frank","\n            ON: FRANKS_FRANKS\n            IF: MAN_IN_HOT_DOG_SUIT.job_hunt_quest_1=1\n            DO: MASCOT_PAPERS.location=offscreen\n                MAN_IN_HOT_DOG_SUIT.job_hunt_quest_1=2.location=UNIVERSITY\n            ",A3($author$project$Rules$Helpers$rule_______________________,"meet_the_man_in_the_hot_dog_suit","\n            ON: MAN_IN_HOT_DOG_SUIT.location=TWIN_BROOKS\n            DO: MASCOT_PAPERS.location=PLAYER\n                MAN_IN_HOT_DOG_SUIT.job_hunt_quest_1=1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"ratty_hat_man_advice_5","\n            ON: MAN_IN_RATTY_HAT.ratty_hat_man_advice=4\n            DO: $.location=offscreen.ratty_hat_man_advice+1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"ratty_hat_man_advice_4","\n            ON: MAN_IN_RATTY_HAT.ratty_hat_man_advice=3\n            DO: $.location=HIGHLAND.ratty_hat_man_advice+1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"ratty_hat_man_advice_3","\n            ON: MAN_IN_RATTY_HAT.ratty_hat_man_advice=2\n            DO: $.location=PARK_AVE.ratty_hat_man_advice+1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"ratty_hat_man_advice_2","\n            ON: MAN_IN_RATTY_HAT.ratty_hat_man_advice=1\n            DO: $.location=NORWOOD.ratty_hat_man_advice+1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"ratty_hat_man_advice_1","\n            ON: MAN_IN_RATTY_HAT\n            DO: $.location=TWIN_BROOKS.ratty_hat_man_advice+1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"noMoreScreamingChild","\n            ON: MOTHER.screaming_child_quest=2\n            ",A3($author$project$Rules$Helpers$rule_______________________,"giveSodaToScreamingChild","\n            ON: MOTHER.screaming_child_quest=1\n            IF: SODA.location=PLAYER\n            DO: SODA.location=offscreen\n                MOTHER.screaming_child_quest=2\n                PLAYER.good_will+2\n            ",A3($author$project$Rules$Helpers$rule_______________________,"getSodaForScreamingChild","\n            ON: SODA_MACHINE\n            IF: MOTHER.screaming_child_quest=1\n                CHANGE.location=PLAYER.amount>49\n                SODA.!location=PLAYER\n            DO: CHANGE.amount-50\n                SODA.location=PLAYER\n            ",A3($author$project$Rules$Helpers$rule_______________________,"keepBotheringMother","\n            ON: MOTHER.met.screaming_child_quest=1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"offerToHelpScreamingChild","\n            ON: MOTHER.met.screaming_child_quest=0\n            DO: CHANGE.location=PLAYER.amount+50\n                MOTHER.screaming_child_quest=1\n            ",A3($author$project$Rules$Helpers$rule_______________________,"offerYourSodaToScreamingChild","\n            ON: MOTHER.met.screaming_child_quest=0\n            IF: SODA.location=PLAYER\n            DO: MOTHER.screaming_child_quest=99\n                MOTHER.location=offscreen\n            ",A3($author$project$Rules$Helpers$rule_______________________,"offerYourSodaToScreamingChildFromSoda","\n            ON: SODA\n            IF: MOTHER.met.screaming_child_quest=0\n                SODA.location=PLAYER\n            DO: MOTHER.screaming_child_quest=99\n                MOTHER.location=offscreen\n            ",A3($author$project$Rules$Helpers$rule_______________________,"meetingScreamingChild","\n            ON: MOTHER.!met\n            DO: MOTHER.met\n            ",$elm$core$Dict$empty))))))))))))))))))),$author$project$Rules$allRuleSpecs=A3($elm$core$List$foldl,$elm$core$Dict$union,$author$project$Rules$General$rules,_List_fromArray([$author$project$Rules$Quests$rules,$author$project$Rules$Intro$rules,$author$project$Rules$Chapter1$rules,$author$project$Rules$Chapter2$rules])),$jschomay$elm_narrative_engine$NarrativeEngine$Core$Rules$EntityTrigger=function(a){return{$:1,a:a}},$jschomay$elm_narrative_engine$NarrativeEngine$Core$Rules$SpecificTrigger=function(a){return{$:0,a:a}},$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$DecStat=F2((function(a,b){return{$:4,a:a,b:b}})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$IncStat=F2((function(a,b){return{$:3,a:a,b:b}})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$LookUpLinkTarget=F2((function(a,b){return{$:1,a:a,b:b}})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SetLink=F2((function(a,b){return{$:5,a:a,b:b}})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SetStat=F2((function(a,b){return{$:2,a:a,b:b}})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SpecificLinkTarget=function(a){return{$:0,a:a}},$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$changeEntityParser=(toUpdateEntity=F3((function(acc,propName,updateConstructor){return $elm$parser$Parser$Loop(A2($elm$core$List$cons,updateConstructor(propName),acc))})),A2($elm$parser$Parser$loop,_List_Nil,(function(acc){return $elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$elm$parser$Parser$chompWhile($elm$core$Basics$eq(" "))),$elm$parser$Parser$symbol(".")),$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed((function(t){return $elm$parser$Parser$Loop(A2($elm$core$List$cons,{$:1,a:t},acc))})),$elm$parser$Parser$symbol("-")),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$propertyNameParser),A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,$elm$parser$Parser$succeed(toUpdateEntity(acc)),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$propertyNameParser),$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$elm$parser$Parser$symbol("+")),A2($elm$parser$Parser$map,(function(n){return function(key){return A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$IncStat,key,n)}}),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$numberParser)),A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$elm$parser$Parser$symbol("-")),A2($elm$parser$Parser$map,(function(n){return function(key){return A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$DecStat,key,n)}}),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$numberParser)),A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$elm$parser$Parser$symbol("=")),$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,(function(n){return function(key){return A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SetStat,key,n)}}),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$numberParser),A2($elm$parser$Parser$map,(function(){return function(key){return A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SetLink,key,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SpecificLinkTarget("$"))}}),$elm$parser$Parser$symbol("$")),A2($elm$parser$Parser$map,(function(id){return function(key){return A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SetLink,key,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SpecificLinkTarget(id))}}),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$idParser),(mapper=F3((function(lookupID,lookupKey,key){return A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$SetLink,key,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$LookUpLinkTarget,lookupID,lookupKey))})),A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed(mapper),$elm$parser$Parser$keyword("(link")),$elm$parser$Parser$chompWhile($elm$core$Basics$eq(" "))),A2($elm$parser$Parser$ignorer,$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,$elm$core$Basics$always("$"),$elm$parser$Parser$token("$")),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$idParser])),$elm$parser$Parser$symbol("."))),A2($elm$parser$Parser$ignorer,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$propertyNameParser,$elm$parser$Parser$symbol(")"))))]))),$elm$parser$Parser$succeed((function(t){return{$:0,a:t}}))])))]))),$elm$parser$Parser$succeed($elm$parser$Parser$Done(acc))]));var mapper}))),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$Update=F2((function(a,b){return{$:0,a:a,b:b}})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$UpdateAll=F2((function(a,b){return{$:1,a:a,b:b}})),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$updateTargetParser=$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,$elm$core$Basics$always($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$Update("$")),$elm$parser$Parser$symbol("$")),A2($elm$parser$Parser$map,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$Update,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$EntityParser$idParser),A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$elm$parser$Parser$symbol("(")),$elm$parser$Parser$symbol("*")),A2($elm$parser$Parser$ignorer,A2($elm$parser$Parser$map,(function(queries){return $jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$UpdateAll(queries)}),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$queriesParser),$elm$parser$Parser$symbol(")")))])),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$changesParser=A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,$elm$parser$Parser$succeed(F2((function(selector,updates){return selector(updates)}))),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$updateTargetParser),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$changeEntityParser),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$ruleParser=(toRule=F3((function(trigger,conditions,changes){return{bn:changes,at:conditions,cc:trigger}})),specificTriggerParser=A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$elm$parser$Parser$token('"')),A2($elm$parser$Parser$ignorer,$elm$parser$Parser$getChompedString($elm$parser$Parser$chompUntil('"')),$elm$parser$Parser$symbol('"'))),triggerParser=A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,A2($elm$parser$Parser$ignorer,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$elm$parser$Parser$spaces),$elm$parser$Parser$oneOf(_List_fromArray([$elm$parser$Parser$keyword("ON:"),$elm$parser$Parser$keyword("ON")]))),$elm$parser$Parser$spaces),A2($elm$parser$Parser$ignorer,$elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,$jschomay$elm_narrative_engine$NarrativeEngine$Core$Rules$SpecificTrigger,specificTriggerParser),A2($elm$parser$Parser$map,$jschomay$elm_narrative_engine$NarrativeEngine$Core$Rules$EntityTrigger,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$matcherParser)])),$elm$parser$Parser$spaces)),conditionsParser=A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$ignorer,A2($elm$parser$Parser$ignorer,$elm$parser$Parser$succeed($elm$core$Basics$identity),$elm$parser$Parser$oneOf(_List_fromArray([$elm$parser$Parser$keyword("IF:"),$elm$parser$Parser$keyword("IF"),$elm$parser$Parser$succeed(0)]))),$elm$parser$Parser$spaces),A2($elm$parser$Parser$loop,_List_Nil,(function(acc){return $elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,(function(){return $elm$parser$Parser$Done($elm$core$List$reverse(acc))}),A2($elm$parser$Parser$ignorer,$elm$parser$Parser$oneOf(_List_fromArray([$elm$parser$Parser$keyword("DO:"),$elm$parser$Parser$keyword("DO"),$elm$parser$Parser$end])),$elm$parser$Parser$spaces)),A2($elm$parser$Parser$map,(function(condition){return $elm$parser$Parser$Loop(A2($elm$core$List$cons,condition,acc))}),A2($elm$parser$Parser$ignorer,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$matcherParser,$elm$parser$Parser$spaces))]))}))),changesParser_=A2($elm$parser$Parser$loop,_List_Nil,(function(acc){return $elm$parser$Parser$oneOf(_List_fromArray([A2($elm$parser$Parser$map,(function(){return $elm$parser$Parser$Done($elm$core$List$reverse(acc))}),$elm$parser$Parser$end),A2($elm$parser$Parser$map,(function(condition){return $elm$parser$Parser$Loop(A2($elm$core$List$cons,condition,acc))}),A2($elm$parser$Parser$ignorer,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$changesParser,$elm$parser$Parser$spaces))]))})),A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,A2($elm$parser$Parser$keeper,$elm$parser$Parser$succeed(toRule),triggerParser),conditionsParser),changesParser_)),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$parseRule=F2((function(extendFn,_v0){var source=_v0.a;return A2($elm$core$Result$mapError,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$deadEndsToString,A2($elm$core$Result$map,extendFn(_v0.b),A2($elm$parser$Parser$run,A2($elm$parser$Parser$ignorer,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$ruleParser,$elm$parser$Parser$end),source)))})),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$parseRules=F2((function(extendFn,rules){var displayError=F3((function(k,v,e){return _Utils_Tuple2("Rule: "+k+"\n"+v.a+" ",e)}));return A3($elm$core$Dict$foldl,F3((function(id,ruleSpec,acc){var _v0=A2($jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$parseRule,extendFn,ruleSpec);if(_v0.$){var err=_v0.a;if(acc.$){var errors=acc.a;return $elm$core$Result$Err(A2($elm$core$List$cons,A3(displayError,id,ruleSpec,err),errors))}return $elm$core$Result$Err(_List_fromArray([A3(displayError,id,ruleSpec,err)]))}return A2($elm$core$Result$map,A2($elm$core$Dict$insert,id,_v0.a),acc)})),$elm$core$Result$Ok($elm$core$Dict$empty),rules)})),$author$project$Rules$rules=A2($jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$parseRules,$elm$core$Basics$always($elm$core$Basics$identity),$author$project$Rules$allRuleSpecs),$elm$core$Tuple$second=function(_v0){return _v0.b},$author$project$LocalTypes$AssetsLoaded={$:3},$author$project$LocalTypes$ExistingSaves=function(a){return{$:4,a:a}},$author$project$LocalTypes$ListSaves={$:0},$author$project$LocalTypes$LoadScene=function(a){return{$:1,a:a}},$author$project$LocalTypes$Persist=function(a){return{$:18,a:a}},$author$project$LocalTypes$PromptResponse=function(a){return{$:13,a:a}},$author$project$Main$assetsLoaded=_Platform_incomingPort("assetsLoaded",$elm$json$Json$Decode$bool),$elm$core$Platform$Sub$batch=_Platform_batch,$author$project$LocalTypes$Continue={$:9},$author$project$LocalTypes$Interact=function(a){return{$:2,a:a}},$author$project$LocalTypes$NoOp={$:0},$author$project$LocalTypes$SendPrompt={$:12},$author$project$LocalTypes$Splash={$:2},$author$project$LocalTypes$StartPrompt={$:10},$author$project$LocalTypes$ToggleMap={$:4},$author$project$LocalTypes$ToggleNotebook={$:5},$elm$core$Basics$neq=_Utils_notEqual,$author$project$Main$handleKey=F2((function(model,key){var showingTitle=!model.b0.$;if(!model.bj||model.bJ||model.b3)return $author$project$LocalTypes$NoOp;switch(key){case" ":return showingTitle?$author$project$LocalTypes$Interact("next_day"):model.b1?$author$project$LocalTypes$ToggleMap:model.b2?$author$project$LocalTypes$ToggleNotebook:_Utils_eq(model.b0,$author$project$LocalTypes$Splash)?$author$project$LocalTypes$Continue:$elm$core$List$isEmpty(model.b8)?$author$project$LocalTypes$NoOp:$author$project$LocalTypes$Continue;case"m":return $author$project$LocalTypes$ToggleMap;case"n":return $author$project$LocalTypes$ToggleNotebook;case"Enter":return _Utils_eq(model.bU,$elm$core$Maybe$Nothing)?_Utils_eq(model.bx,$elm$core$Maybe$Nothing)||1!==$elm$core$List$length(model.b8)?$author$project$LocalTypes$NoOp:$author$project$LocalTypes$StartPrompt:$author$project$LocalTypes$SendPrompt;default:return $author$project$LocalTypes$NoOp}})),$elm$json$Json$Decode$string=_Json_decodeString,$author$project$Main$keyPress=_Platform_incomingPort("keyPress",$elm$json$Json$Decode$string),$elm$json$Json$Decode$null=function(value){return{$:5,c:value}},$author$project$Main$persistListChanged=_Platform_incomingPort("persistListChanged",$elm$json$Json$Decode$null(0)),$elm$json$Json$Decode$index=_Json_decodeIndex,$elm$json$Json$Decode$list=function(decoder){return{$:3,b:decoder}},$author$project$Main$persistListRes=_Platform_incomingPort("persistListRes",A2($elm$json$Json$Decode$andThen,(function(_v0){return A2($elm$json$Json$Decode$andThen,(function(_v1){return $elm$json$Json$Decode$succeed(_Utils_Tuple2(_v0,_v1))}),A2($elm$json$Json$Decode$index,1,$elm$json$Json$Decode$list($elm$json$Json$Decode$string)))}),A2($elm$json$Json$Decode$index,0,$elm$json$Json$Decode$string))),$author$project$Main$persistLoadRes=_Platform_incomingPort("persistLoadRes",$elm$json$Json$Decode$list($elm$json$Json$Decode$string)),$author$project$Main$promptResponse=_Platform_incomingPort("promptResponse",A2($elm$json$Json$Decode$andThen,(function(response){return A2($elm$json$Json$Decode$andThen,(function(id){return $elm$json$Json$Decode$succeed({aH:id,a0:response})}),A2($elm$json$Json$Decode$field,"id",$elm$json$Json$Decode$string))}),A2($elm$json$Json$Decode$field,"response",$elm$json$Json$Decode$string))),$author$project$Main$subscriptions=function(model){return $elm$core$Platform$Sub$batch(_List_fromArray([$author$project$Main$assetsLoaded($elm$core$Basics$always($author$project$LocalTypes$AssetsLoaded)),$author$project$Main$keyPress($author$project$Main$handleKey(model)),$author$project$Main$persistListRes(A2($elm$core$Basics$composeL,$author$project$LocalTypes$Persist,$author$project$LocalTypes$ExistingSaves)),$author$project$Main$persistLoadRes($author$project$LocalTypes$LoadScene),$author$project$Main$persistListChanged($elm$core$Basics$always($author$project$LocalTypes$Persist($author$project$LocalTypes$ListSaves))),$author$project$Main$promptResponse($author$project$LocalTypes$PromptResponse)]))},$author$project$LocalTypes$Achievement=function(a){return{$:14,a:a}},$author$project$LocalTypes$AddDrama={$:22},$author$project$LocalTypes$CentralGuardOffice={$:9},$author$project$LocalTypes$Disembark={$:7},$author$project$LocalTypes$DisembarkStory={$:8},$author$project$LocalTypes$End={$:3},$author$project$LocalTypes$Lobby={$:4},$author$project$LocalTypes$Passageway={$:8},$author$project$LocalTypes$Platform=function(a){return{$:6,a:a}},$author$project$LocalTypes$PlaySound=function(a){return{$:20,a:a}},$author$project$LocalTypes$QueueLoop=function(a){return{$:24,a:a}},$author$project$LocalTypes$RemoveDrama={$:23},$author$project$LocalTypes$SubwaySounds={$:19},$author$project$LocalTypes$Title=function(a){return{$:0,a:a}},$author$project$LocalTypes$Train=function(a){return{$:7,a:a}},$author$project$Main$addDramaReq=_Platform_outgoingPort("addDramaReq",(function(){return null})),$author$project$Main$isLoading=function(model){return!model.bj||model.b3||model.bJ},$elm$core$Platform$Cmd$batch=_Platform_batch,$elm$core$Platform$Cmd$none=$elm$core$Platform$Cmd$batch(_List_Nil),$author$project$Main$addDrama=function(model){return _Utils_Tuple2(_Utils_update(model,{bT:!0}),$author$project$Main$isLoading(model)?$elm$core$Platform$Cmd$none:$author$project$Main$addDramaReq(0))},$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$decStat=F3((function(key,delta,entity){return _Utils_update(entity,{a5:A3($elm$core$Dict$insert,key,A2($elm$core$Maybe$withDefault,0,A2($elm$core$Dict$get,key,entity.a5))-delta,entity.a5)})})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$incStat=F3((function(key,delta,entity){return _Utils_update(entity,{a5:A3($elm$core$Dict$insert,key,A2($elm$core$Maybe$withDefault,0,A2($elm$core$Dict$get,key,entity.a5))+delta,entity.a5)})})),$elm$core$Dict$moveRedLeft=function(dict){if(-1===dict.$&&-1===dict.d.$&&-1===dict.e.$){if(-1!==dict.e.d.$||dict.e.d.a){var _v4=dict.d,_v5=dict.e;rK=_v5.b,rV=_v5.c,rLeft=_v5.d,rRight=_v5.e;return A5($elm$core$Dict$RBNode_elm_builtin,1,dict.b,dict.c,A5($elm$core$Dict$RBNode_elm_builtin,0,_v4.b,_v4.c,_v4.d,_v4.e),A5($elm$core$Dict$RBNode_elm_builtin,0,rK,rV,rLeft,rRight))}var rLeft,_v1=dict.d,_v2=dict.e,rK=_v2.b,rV=_v2.c,rlL=(rLeft=_v2.d,rLeft.d),rlR=rLeft.e,rRight=_v2.e;return A5($elm$core$Dict$RBNode_elm_builtin,0,rLeft.b,rLeft.c,A5($elm$core$Dict$RBNode_elm_builtin,1,dict.b,dict.c,A5($elm$core$Dict$RBNode_elm_builtin,0,_v1.b,_v1.c,_v1.d,_v1.e),rlL),A5($elm$core$Dict$RBNode_elm_builtin,1,rK,rV,rlR,rRight))}return dict},$elm$core$Dict$moveRedRight=function(dict){if(-1===dict.$&&-1===dict.d.$&&-1===dict.e.$){if(-1!==dict.d.d.$||dict.d.d.a){var _v5=dict.d,lLeft=_v5.d,_v6=dict.e;rK=_v6.b,rV=_v6.c,rLeft=_v6.d,rRight=_v6.e;return A5($elm$core$Dict$RBNode_elm_builtin,1,k=dict.b,v=dict.c,A5($elm$core$Dict$RBNode_elm_builtin,0,_v5.b,_v5.c,lLeft,lRight=_v5.e),A5($elm$core$Dict$RBNode_elm_builtin,0,rK,rV,rLeft,rRight))}var k=dict.b,v=dict.c,_v1=dict.d,_v2=_v1.d,lRight=_v1.e,_v4=dict.e,rK=_v4.b,rV=_v4.c,rLeft=_v4.d,rRight=_v4.e;return A5($elm$core$Dict$RBNode_elm_builtin,0,_v1.b,_v1.c,A5($elm$core$Dict$RBNode_elm_builtin,1,_v2.b,_v2.c,_v2.d,_v2.e),A5($elm$core$Dict$RBNode_elm_builtin,1,k,v,lRight,A5($elm$core$Dict$RBNode_elm_builtin,0,rK,rV,rLeft,rRight)))}return dict},$elm$core$Dict$removeHelpPrepEQGT=F7((function(targetKey,dict,color,key,value,left,right){if(-1!==left.$||left.a){_v2$2:for(;;){if(-1===right.$&&1===right.a){if(-1===right.d.$){if(1===right.d.a){return $elm$core$Dict$moveRedRight(dict)}break _v2$2}return $elm$core$Dict$moveRedRight(dict)}break _v2$2}return dict}return A5($elm$core$Dict$RBNode_elm_builtin,color,left.b,left.c,left.d,A5($elm$core$Dict$RBNode_elm_builtin,0,key,value,left.e,right))})),$elm$core$Dict$removeMin=function(dict){if(-1===dict.$&&-1===dict.d.$){var color=dict.a,key=dict.b,value=dict.c,left=dict.d,lLeft=left.d,right=dict.e;if(1===left.a){if(-1!==lLeft.$||lLeft.a){var _v4=$elm$core$Dict$moveRedLeft(dict);if(-1===_v4.$){var nRight=_v4.e;return A5($elm$core$Dict$balance,_v4.a,_v4.b,_v4.c,$elm$core$Dict$removeMin(_v4.d),nRight)}return $elm$core$Dict$RBEmpty_elm_builtin}return A5($elm$core$Dict$RBNode_elm_builtin,color,key,value,$elm$core$Dict$removeMin(left),right)}return A5($elm$core$Dict$RBNode_elm_builtin,color,key,value,$elm$core$Dict$removeMin(left),right)}return $elm$core$Dict$RBEmpty_elm_builtin},$elm$core$Dict$removeHelp=F2((function(targetKey,dict){if(-2===dict.$)return $elm$core$Dict$RBEmpty_elm_builtin;var color=dict.a,key=dict.b,value=dict.c,left=dict.d,right=dict.e;if(0>_Utils_cmp(targetKey,key)){if(-1===left.$&&1===left.a){var lLeft=left.d;if(-1!==lLeft.$||lLeft.a){var _v7=$elm$core$Dict$moveRedLeft(dict);if(-1===_v7.$){var nRight=_v7.e;return A5($elm$core$Dict$balance,_v7.a,_v7.b,_v7.c,A2($elm$core$Dict$removeHelp,targetKey,_v7.d),nRight)}return $elm$core$Dict$RBEmpty_elm_builtin}return A5($elm$core$Dict$RBNode_elm_builtin,color,key,value,A2($elm$core$Dict$removeHelp,targetKey,left),right)}return A5($elm$core$Dict$RBNode_elm_builtin,color,key,value,A2($elm$core$Dict$removeHelp,targetKey,left),right)}return A2($elm$core$Dict$removeHelpEQGT,targetKey,A7($elm$core$Dict$removeHelpPrepEQGT,targetKey,dict,color,key,value,left,right))})),$elm$core$Dict$removeHelpEQGT=F2((function(targetKey,dict){if(-1===dict.$){var color=dict.a,key=dict.b,value=dict.c,left=dict.d,right=dict.e;if(_Utils_eq(targetKey,key)){var _v1=function(dict){for(;;){if(-1!==dict.$||-1!==dict.d.$)return dict;dict=dict.d}}(right);return-1===_v1.$?A5($elm$core$Dict$balance,color,_v1.b,_v1.c,left,$elm$core$Dict$removeMin(right)):$elm$core$Dict$RBEmpty_elm_builtin}return A5($elm$core$Dict$balance,color,key,value,left,A2($elm$core$Dict$removeHelp,targetKey,right))}return $elm$core$Dict$RBEmpty_elm_builtin})),$elm$core$Dict$remove=F2((function(key,dict){var _v0=A2($elm$core$Dict$removeHelp,key,dict);if(-1!==_v0.$||_v0.a)return _v0;return A5($elm$core$Dict$RBNode_elm_builtin,1,_v0.b,_v0.c,_v0.d,_v0.e)})),$elm$core$Set$remove=F2((function(key,_v0){return A2($elm$core$Dict$remove,key,_v0)})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$removeTag=F2((function(value,entity){return _Utils_update(entity,{a8:A2($elm$core$Set$remove,value,entity.a8)})})),$elm$core$Dict$update=F3((function(targetKey,alter,dictionary){var _v0=alter(A2($elm$core$Dict$get,targetKey,dictionary));return _v0.$?A2($elm$core$Dict$remove,targetKey,dictionary):A3($elm$core$Dict$insert,targetKey,_v0.a,dictionary)})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$update=F3((function(id,updateFn,store){return A3($elm$core$Dict$update,id,$elm$core$Maybe$map(updateFn),store)})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$applyChanges=F3((function(entityUpdates,trigger,store){var parseID=function(id){return"$"===id?trigger:id},applyChange=F3((function(id,change,updated_store){switch(change.$){case 0:return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$update,id,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$addTag(change.a),updated_store);case 1:return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$update,id,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$removeTag(change.a),updated_store);case 2:return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$update,id,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$setStat,key=change.a,change.b),updated_store);case 3:return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$update,id,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$incStat,key=change.a,change.b),updated_store);case 4:return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$update,id,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$decStat,key=change.a,change.b),updated_store);default:if(change.b.$){key=change.a;var _v3=change.b;linkID=_v3.a;return A2($elm$core$Maybe$withDefault,updated_store,A2($elm$core$Maybe$map,(function(targetID){return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$update,id,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$setLink,key,targetID),updated_store)}),A2($elm$core$Maybe$andThen,A2($elm$core$Basics$composeR,(function($){return $.aN}),$elm$core$Dict$get(_v3.b)),A2($elm$core$Dict$get,parseID(linkID),updated_store))))}var key,linkID;return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$update,id,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$setLink,key=change.a,parseID(linkID=change.b.a)),updated_store)}})),updateEntity=function(id){return $elm$core$List$foldl(applyChange(id))};return A3($elm$core$List$foldl,F2((function(entityUpdate,updated_store){if(entityUpdate.$){var queries=entityUpdate.a;changes=entityUpdate.b;return A3($elm$core$List$foldl,F2((function(_v1,acc){return A3(updateEntity,_v1.a,acc,changes)})),updated_store,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$query,$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$MatchAny(queries),updated_store))}var changes=entityUpdate.b;return A3(updateEntity,parseID(entityUpdate.a),updated_store,changes)})),store,entityUpdates)})),$elm$core$Task$onError=_Scheduler_onError,$elm$core$Task$attempt=F2((function(resultToMessage,task){return $elm$core$Task$command(A2($elm$core$Task$onError,A2($elm$core$Basics$composeL,A2($elm$core$Basics$composeL,$elm$core$Task$succeed,resultToMessage),$elm$core$Result$Err),A2($elm$core$Task$andThen,A2($elm$core$Basics$composeL,A2($elm$core$Basics$composeL,$elm$core$Task$succeed,resultToMessage),$elm$core$Result$Ok),task)))})),$author$project$Main$changeScene=_Platform_outgoingPort("changeScene",$elm$json$Json$Encode$string),$author$project$Main$changeTrainStatus=F2((function(newStatus,trainProps){return _Utils_update(trainProps,{b6:newStatus})})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$getStat=F3((function(id,key,store){return A2($elm$core$Maybe$andThen,A2($elm$core$Basics$composeR,(function($){return $.a5}),$elm$core$Dict$get(key)),A2($elm$core$Dict$get,id,store))})),$author$project$Main$dayText=function(worldModel){var _v0=A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$getStat,"PLAYER","day",worldModel);_v0$5:for(;!_v0.$;)switch(_v0.a){case 1:return"Monday morning";case 2:return"Tuesday morning";case 3:return"Wednesday morning";case 4:return"Thursday morning";case 5:return"Friday morning";default:break _v0$5}return"ERROR can't get PLAYER.day"},$elm$core$List$drop=F2((function(n,list){drop:for(;;){if(n>0){if(list.b){n=n-1,list=list.b;continue drop}return list}return list}})),$elm$core$List$head=function(list){if(list.b){return $elm$core$Maybe$Just(list.a)}return $elm$core$Maybe$Nothing},$jschomay$elm_narrative_engine$NarrativeEngine$Core$Rules$matchCondition=F3((function(trigger,store,matcher){return!$elm$core$List$isEmpty((m=A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$replaceTrigger,trigger,matcher),A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$query,m,store)));var m})),$jschomay$elm_narrative_engine$NarrativeEngine$Core$Rules$matchTrigger=F3((function(store,trigger,triggerMatcher){if(triggerMatcher.$){if(triggerMatcher.a.$)return!$elm$core$List$isEmpty(A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$query,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$Match,trigger,triggerMatcher.a.a),store));var em=triggerMatcher.a;return _Utils_eq(em.a,trigger)&&!$elm$core$List$isEmpty(A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$query,em,store))}return _Utils_eq(trigger,triggerMatcher.a)})),$elm$core$List$sortBy=_List_sortBy,$jschomay$elm_narrative_engine$NarrativeEngine$Core$Rules$weight=function(_v0){var trigger=_v0.cc,conditions=_v0.at,queryScore=function(matcher){if(matcher.$)return $elm$core$List$length(matcher.a);return $elm$core$List$length(matcher.b)},triggerScore=trigger.$?trigger.a.$?0+queryScore(trigger.a):100+queryScore(trigger.a):0;return A3($elm$core$List$foldl,F2((function(matcher,acc){return matcher.$?0+queryScore(matcher)+acc:10+queryScore(matcher)+acc})),0,conditions)+triggerScore},$jschomay$elm_narrative_engine$NarrativeEngine$Core$Rules$findMatchingRule=F3((function(trigger,rules,store){return $elm$core$List$head($elm$core$List$reverse(A2($elm$core$List$sortBy,A2($elm$core$Basics$composeR,$elm$core$Tuple$second,$jschomay$elm_narrative_engine$NarrativeEngine$Core$Rules$weight),$elm$core$Dict$toList(A2($elm$core$Dict$filter,F2((function(ruleId,rule){return A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$Rules$matchTrigger,store,trigger,rule.cc)&&A2($elm$core$List$all,A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$Rules$matchCondition,trigger,store),rule.at)})),rules)))))})),$elm$browser$Browser$Dom$focus=_Browser_call("focus"),$jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$getLink=F3((function(id,key,store){return A2($elm$core$Maybe$andThen,(function(linkedID){return A2($elm$core$Dict$member,linkedID,store)?$elm$core$Maybe$Just(linkedID):$elm$core$Maybe$Nothing}),A2($elm$core$Maybe$andThen,A2($elm$core$Basics$composeR,(function($){return $.aN}),$elm$core$Dict$get(key)),A2($elm$core$Dict$get,id,store)))})),$author$project$Subway$idToLine=function(id){switch(id){case"RED_LINE":return $elm$core$Maybe$Just(0);case"YELLOW_LINE":return $elm$core$Maybe$Just(1);case"GREEN_LINE":return $elm$core$Maybe$Just(2);case"ORANGE_LINE":return $elm$core$Maybe$Just(3);case"BLUE_LINE":return $elm$core$Maybe$Just(4);case"PURPLE_LINE":return $elm$core$Maybe$Just(5);default:return $elm$core$Maybe$Nothing}},$author$project$Main$getCurrentLine=function(worldModel){return A2($elm$core$Maybe$andThen,$author$project$Subway$idToLine,A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$getLink,"PLAYER","line",worldModel))},$author$project$Main$getCurrentStation=function(worldModel){return A2($elm$core$Maybe$withDefault,"ERROR getting the current location of player from worldmodel",A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$getLink,"PLAYER","location",worldModel))},$elm$core$Tuple$mapFirst=F2((function(func,_v0){var y=_v0.b;return _Utils_Tuple2(func(_v0.a),y)})),$author$project$Main$maybeAutosaveChapter=F2((function(ruleID,model){return"fallAsleep"===ruleID?$author$project$Main$persistSaveReq(_Utils_Tuple2("Chapter 2: Falling asleep",model.bC)):$elm$core$Platform$Cmd$none})),$author$project$Main$noop=function(model){return _Utils_Tuple2(model,$elm$core$Platform$Cmd$none)},$elm$core$Tuple$pair=F2((function(a,b){return _Utils_Tuple2(a,b)})),$elm$core$Result$fromMaybe=F2((function(err,maybe){return maybe.$?$elm$core$Result$Err(err):$elm$core$Result$Ok(maybe.a)})),$elm$core$List$filter=F2((function(isGood,list){return A3($elm$core$List$foldr,F2((function(x,xs){return isGood(x)?A2($elm$core$List$cons,x,xs):xs})),_List_Nil,list)})),$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$parse=F2((function(config,text){var _v0=A2($elm$parser$Parser$run,$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$top(config),text);if(_v0.$){return _List_fromArray(["ERROR could not parse: "+text])}var parsed=_v0.a;return A2($elm$core$List$filter,A2($elm$core$Basics$composeL,A2($elm$core$Basics$composeL,$elm$core$Basics$not,$elm$core$String$isEmpty),$elm$core$String$trim),A2($elm$core$String$split,"---",parsed))})),$author$project$Main$parseNarrative=F4((function(model,matchedRuleID,trigger,rawNarrative){var assocs,replaceTrigger=function(id){return"$"===id?trigger:id},propKeywords=(assocs=_List_fromArray([_Utils_Tuple2("name",A2($elm$core$Basics$composeR,replaceTrigger,(function(id){return A2($elm$core$Result$map,(function($){return $.bM}),A2($elm$core$Result$fromMaybe,"Unable to find entity for id: "+id,A2($elm$core$Dict$get,id,model.cf)))}))),_Utils_Tuple2("description",A2($elm$core$Basics$composeR,replaceTrigger,A2($elm$core$Basics$composeR,$author$project$NarrativeContent$t,$elm$core$Result$Ok))),_Utils_Tuple2("format_amount",A2($elm$core$Basics$composeR,replaceTrigger,(function(id){return A2($elm$core$Result$fromMaybe,"Error looking up 'amount' stat on "+id,A2($elm$core$Maybe$map,(function(n){return"$"+$elm$core$String$fromInt(n/100|0)+"."+((_v0=A2($elm$core$Basics$modBy,100,n))?$elm$core$String$fromInt(_v0):"00");var _v0}),A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$getStat,id,"amount",model.cf)))})))]),A3($elm$core$List$foldl,F2((function(_v0,dict){return A3($elm$core$Dict$insert,_v0.a,_v0.b,dict)})),$elm$core$Dict$empty,assocs)),newMatchCounts=A3($elm$core$Dict$update,matchedRuleID,(function(i){return $elm$core$Maybe$Just(A2($elm$core$Maybe$withDefault,1,A2($elm$core$Maybe$map,$elm$core$Basics$add(1),i)))}),model.bZ);return _Utils_Tuple2(A2($jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$parse,{bq:A2($elm$core$Maybe$withDefault,0,A2($elm$core$Dict$get,matchedRuleID,model.bZ)),bW:propKeywords,cc:trigger,cf:model.cf},rawNarrative),newMatchCounts)})),$author$project$Main$persistDeleteReq=_Platform_outgoingPort("persistDeleteReq",$elm$json$Json$Encode$string),$author$project$Main$persistListReq=_Platform_outgoingPort("persistListReq",(function(){return null})),$author$project$Main$persistLoadReq=_Platform_outgoingPort("persistLoadReq",$elm$json$Json$Encode$string),$author$project$Main$playSound=_Platform_outgoingPort("playSound",$elm$json$Json$Encode$string),$author$project$Main$queueLoopReq=_Platform_outgoingPort("queueLoopReq",$elm$json$Json$Encode$string),$author$project$Main$queueLoop=F2((function(key,model){return _Utils_Tuple2(_Utils_update(model,{bp:key}),$author$project$Main$isLoading(model)?$elm$core$Platform$Cmd$none:$author$project$Main$queueLoopReq(key))})),$author$project$Main$removeDramaReq=_Platform_outgoingPort("removeDramaReq",(function(){return null})),$author$project$Main$removeDrama=function(model){return _Utils_Tuple2(_Utils_update(model,{bT:!1}),$author$project$Main$isLoading(model)?$elm$core$Platform$Cmd$none:$author$project$Main$removeDramaReq(0))},$author$project$Main$sendPrompt=_Platform_outgoingPort("sendPrompt",(function($){var b=$.b;return A2($elm$json$Json$Encode$list,$elm$core$Basics$identity,_List_fromArray([$elm$json$Json$Encode$string($.a),$elm$json$Json$Encode$string(b)]))})),$author$project$Main$sendTrigger=_Platform_outgoingPort("sendTrigger",$elm$json$Json$Encode$string),$jschomay$elm_narrative_engine$NarrativeEngine$Debug$setLastInteractionId=F2((function(id,_v0){return _Utils_update(_v0,{ag:id})})),$jschomay$elm_narrative_engine$NarrativeEngine$Debug$setLastMatchedRuleId=F2((function(id,_v0){return _Utils_update(_v0,{ah:id})})),$elm$core$Process$sleep=_Process_sleep,$author$project$Main$stopMusic=_Platform_outgoingPort("stopMusic",(function(){return null})),$author$project$Main$stopSound=_Platform_outgoingPort("stopSound",$elm$json$Json$Encode$string),$author$project$Main$trackEvent=_Platform_outgoingPort("trackEvent",$elm$json$Json$Encode$string),$author$project$Rules$unsafeQuery=F2((function(queryString,store){return _v0=$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$RuleParser$parseMatcher(queryString),A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$query,_v0.$?A2($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$Match,"PARSING_ERROR",_List_Nil):_v0.a,store);var _v0})),$author$project$Rules$unsafeAssert=F2((function(queryString,store){return!$elm$core$List$isEmpty(A2($author$project$Rules$unsafeQuery,queryString,store))})),$author$project$Main$updateAndThen=F2((function(f,_v0){var cmds=_v0.b;return A2($elm$core$Tuple$mapSecond,(function(cmd){return $elm$core$Platform$Cmd$batch(_List_fromArray([cmd,cmds]))}),f(_v0.a))})),$jschomay$elm_narrative_engine$NarrativeEngine$Debug$updateSearch=F2((function(text,_v0){return _Utils_update(_v0,{ak:text})})),$elm$core$Result$withDefault=F2((function(def,result){return result.$?def:result.a})),$author$project$Main$applyPendingChanges=F2((function(rules,model){var _v18=model.bR;if(_v18.$)return _Utils_Tuple2(model,$elm$core$Platform$Cmd$none);var _v19=_v18.a,trigger=_v19.a,changes=_v19.b;return A2($author$project$Main$updateAndThen,A2($author$project$Main$specialEvents,rules,_v19.c),_Utils_Tuple2(_Utils_update(model,{bR:$elm$core$Maybe$Nothing,cf:A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$applyChanges,changes,trigger,model.cf)}),$elm$core$Platform$Cmd$none))})),$author$project$Main$delay=F4((function(rules,duration,msg,model){return model.b3||model.bJ?A3($author$project$Main$update,rules,msg,model):_Utils_Tuple2(model,A2($elm$core$Task$perform,$elm$core$Basics$always(msg),$elm$core$Process$sleep(duration)))})),$author$project$Main$specialEvents=F3((function(rules,ruleId,model){switch(ruleId){case"notebookInstructions":return _Utils_Tuple2(_Utils_update(model,{b2:!0}),$elm$core$Platform$Cmd$none);case"NOTEBOOK":return _Utils_Tuple2(_Utils_update(model,{bN:$author$project$LocalTypes$Goals,b2:!model.b2}),$elm$core$Platform$Cmd$none);case"checkMap":return _Utils_Tuple2(_Utils_update(model,{b1:!model.b1}),$elm$core$Platform$Cmd$none);case"goToLobby":return _Utils_Tuple2(_Utils_update(model,{b0:$author$project$LocalTypes$Lobby}),$elm$core$Platform$Cmd$none);case"get_caffeinated_quest_2":return A4($author$project$Main$delay,rules,300,$author$project$LocalTypes$Achievement("get_caffeinated_quest_achievement"),model);case"ratty_hat_man_advice_5":return A4($author$project$Main$delay,rules,300,$author$project$LocalTypes$Achievement("fools_errand_achievement"),model);case"meetConductorFirstTime":return A2($author$project$Main$updateAndThen,$author$project$Main$queueLoop("3"),A2($author$project$Main$updateAndThen,A3($author$project$Main$delay,rules,300,$author$project$LocalTypes$Achievement("transfer_station")),_Utils_Tuple2(_Utils_update(model,{b0:$author$project$LocalTypes$Lobby}),$elm$core$Platform$Cmd$none)));case"jumpTurnstileFortySecondStreet":return A2($author$project$Main$updateAndThen,A3($author$project$Main$delay,rules,300,$author$project$LocalTypes$Achievement("freedom")),_Utils_Tuple2(_Utils_update(model,{b0:$author$project$LocalTypes$End}),$elm$core$Platform$Cmd$none));case"pourSodaOnInfractionsMachine":return A4($author$project$Main$delay,rules,300,$author$project$LocalTypes$Achievement("f_the_system"),model);case"fallAsleep":return A2($author$project$Main$updateAndThen,$author$project$Main$addDrama,_Utils_Tuple2(_Utils_update(model,{bx:$elm$core$Maybe$Just("jeff_the_game_designer")}),$author$project$Main$changeScene("holdup_at_broadway_station")));case"briefcaseStolen":case"needCoinsForPayphone":case"confrontConductor":return $author$project$Main$addDrama(model);case"findingSecurityDepotClosed":return A2($author$project$Main$queueLoop,"4",model);case"followSkaterDudeToCapitalHeights":return A4($author$project$Main$delay,rules,3e3,$author$project$LocalTypes$RemoveDrama,model);case"readyToCallBoss":return A4($author$project$Main$delay,rules,3e3,$author$project$LocalTypes$QueueLoop("2"),model);case"nextDay":return _Utils_Tuple2(_Utils_update(model,{b0:$author$project$LocalTypes$Lobby}),_Utils_eq(model.b0,$author$project$LocalTypes$Title("Monday morning"))?$elm$core$Platform$Cmd$batch(_List_fromArray([$author$project$Main$playSound("sfx/subway_ambient_loop"),A2($elm$core$Task$perform,$elm$core$Basics$always($author$project$LocalTypes$SubwaySounds),$elm$core$Process$sleep(8e3))])):$elm$core$Platform$Cmd$none);case"endWednesday":var wm=A3($elm$core$Dict$update,"COFFEE_CART",$elm$core$Maybe$map((function(e){return _Utils_update(e,{ad:$elm$core$Maybe$Just("snarky_coffee_girl")})})),model.cf);return _Utils_Tuple2(_Utils_update(model,{cf:wm}),$elm$core$Platform$Cmd$none);case"endThursday":wm=A3($elm$core$Dict$update,"COMMUTER_1",$elm$core$Maybe$map((function(e){return _Utils_update(e,{ad:$elm$core$Maybe$Nothing})})),A3($elm$core$Dict$update,"COFFEE_CART",$elm$core$Maybe$map((function(e){return _Utils_update(e,{ad:$elm$core$Maybe$Nothing})})),model.cf));return _Utils_Tuple2(_Utils_update(model,{cf:wm}),$elm$core$Platform$Cmd$none);case"coffeeCartWednesday":return _Utils_Tuple2(model,$author$project$Main$sendTrigger("worry-about-steve"));default:var other=ruleId;return A2($elm$core$List$member,other,_List_fromArray(["use_secret_passage_way","chaseThiefAgain"]))?A2($author$project$Main$updateAndThen,A3($author$project$Main$delay,rules,1600,$author$project$LocalTypes$Disembark),_Utils_Tuple2(_Utils_update(model,{b0:$author$project$LocalTypes$Passageway}),$elm$core$Platform$Cmd$none)):A2($elm$core$List$member,other,_List_fromArray(["goToLineTurnstile","followSkaterDudeToOrangeLine"]))?_Utils_Tuple2(_Utils_update(model,{b0:(a=A2($elm$core$Maybe$withDefault,0,$author$project$Main$getCurrentLine(model.cf)),{$:5,a:a})}),$elm$core$Platform$Cmd$none):A2($elm$core$List$member,other,_List_fromArray(["goToLinePlatform","jumpTurnstileWithSkaterDude","jumpTurnstileAfterTaklingToMark"]))?A2($author$project$Main$updateAndThen,function(){switch(other){case"jumpTurnstileWithSkaterDude":case"jumpTurnstileAfterTaklingToMark":return $author$project$Main$addDrama;default:return $author$project$Main$noop}}(),_Utils_Tuple2(_Utils_update(model,{b0:$author$project$LocalTypes$Platform(A2($elm$core$Maybe$withDefault,0,$author$project$Main$getCurrentLine(model.cf)))}),$elm$core$Platform$Cmd$none)):A2($elm$core$List$member,other,_List_fromArray(["caughtOnOrangeLineHeadingTo73rd","caughtOnOrangeLineHeadingToOther"]))?A2($author$project$Main$updateAndThen,$author$project$Main$removeDrama,_Utils_Tuple2(_Utils_update(model,{b0:$author$project$LocalTypes$CentralGuardOffice}),$author$project$Main$stopMusic(0))):A2($elm$core$List$member,other,_List_fromArray(["endMonday","endTuesday","endWednesday","endThursday"]))?_Utils_Tuple2(_Utils_update(model,{b0:$author$project$LocalTypes$Title($author$project$Main$dayText(model.cf))}),$elm$core$Platform$Cmd$none):_Utils_Tuple2(model,$elm$core$Platform$Cmd$none)}var a})),$author$project$Main$update=F3((function(rules,msg,model){if(model.by)return $author$project$Main$noop(model);switch(msg.$){case 0:return $author$project$Main$noop(model);case 18:switch(msg.a.$){case 0:return _Utils_Tuple2(model,$author$project$Main$persistListReq(0));case 2:var k=msg.a.a;return _Utils_Tuple2(_Utils_update(model,{bJ:!0}),$elm$core$Platform$Cmd$batch(_List_fromArray([$author$project$Main$persistLoadReq(k)])));case 1:var _v6=msg.a;return _Utils_Tuple2(model,$author$project$Main$persistSaveReq(_Utils_Tuple2(k=_v6.a,_v6.b)));case 3:return _Utils_Tuple2(model,$author$project$Main$persistDeleteReq(k=msg.a.a));case 4:var _v7=msg.a.a;return _Utils_Tuple2(_Utils_update(model,{bN:(a=_v7.b,{$:2,a:a}),bS:_v7.a}),A2($elm$core$Task$attempt,(function(){return $author$project$LocalTypes$NoOp}),$elm$browser$Browser$Dom$focus("persistKeyInput")));default:return _Utils_Tuple2(_Utils_update(model,{bS:msg.a.a}),$elm$core$Platform$Cmd$none)}case 3:return _Utils_Tuple2(_Utils_update(model,{bj:!0}),_Utils_eq(model.br,$elm$core$Maybe$Nothing)?$author$project$Main$persistLoadReq("Autosave (most recent)"):$elm$core$Platform$Cmd$none);case 1:var history=msg.a;return A2($author$project$Main$updateAndThen,(function(m){return _Utils_Tuple2(_Utils_update(m,{bj:!0,bJ:!1,b0:function(){var _v9=m.b0;switch(_v9.$){case 7:case 5:case 6:return $author$project$LocalTypes$Lobby;default:return _v9}}(),b1:!1,b2:!1,b3:!1,b8:function(){var _v10=m.b0;if(1===_v10.$)return m.b8;return _List_Nil}()}),$elm$core$Platform$Cmd$batch(_List_fromArray([$author$project$Main$stopMusic(0),A2($elm$core$Task$perform,$elm$core$Basics$always($author$project$LocalTypes$QueueLoop(m.bp)),$elm$core$Process$sleep(100)),m.bT?A2($elm$core$Task$perform,$elm$core$Basics$always($author$project$LocalTypes$AddDrama),$elm$core$Process$sleep(200)):$elm$core$Platform$Cmd$none,A2($elm$core$Task$perform,$elm$core$Basics$always($author$project$LocalTypes$SubwaySounds),$elm$core$Process$sleep(8e3)),$author$project$Main$playSound("sfx/subway_ambient_loop")])))}),A3($elm$core$List$foldl,F2((function(id,modelTuple){return A2($author$project$Main$updateAndThen,$author$project$Main$applyPendingChanges(rules),A2($author$project$Main$updateAndThen,A2($author$project$Main$update,rules,$author$project$LocalTypes$Interact(id)),A2($elm$core$Tuple$mapFirst,(function(m){return _Utils_update(m,{bJ:!0})}),modelTuple)))})),_Utils_Tuple2(A2($author$project$Main$init,A2($elm$core$Result$withDefault,$elm$core$Dict$empty,$author$project$Manifest$initialWorldModel),{Q:!_Utils_eq(model.br,$elm$core$Maybe$Nothing)}).a,$elm$core$Platform$Cmd$none),history));case 2:var interactableId=msg.a;return A2($author$project$Main$updateAndThen,(function(m){return _Utils_Tuple2(_Utils_update(m,{bx:A2($elm$core$Maybe$andThen,(function(_v13){return _v13.ad}),A2($elm$core$Dict$get,interactableId,m.cf))}),$elm$core$Platform$Cmd$none)}),A2($author$project$Main$updateAndThen,(function(m){var _v12=_Utils_Tuple2(m.b0,m.b8);return 7!==_v12.a.$||_v12.b.b?_Utils_Tuple2(m,$elm$core$Platform$Cmd$none):A4($author$project$Main$delay,rules,3e3,$author$project$LocalTypes$Continue,m)}),A2($author$project$Main$updateAndThen,(function(m){return _Utils_eq(m.br,$elm$core$Maybe$Nothing)?_Utils_Tuple2(m,$elm$core$Platform$Cmd$none):_Utils_Tuple2(_Utils_update(m,{cb:_Utils_ap(m.cb,A2($elm$core$List$cons,interactableId,m.b8))}),$elm$core$Platform$Cmd$none)}),A2($author$project$Main$updateAndThen,A2($author$project$Main$updateStory,rules,interactableId),A2($author$project$Main$updateAndThen,(function(m){var _v11=m.bR;if(1===_v11.$)return _Utils_Tuple2(m,$elm$core$Platform$Cmd$none);return A2($author$project$Main$applyPendingChanges,rules,m)}),_Utils_Tuple2(_Utils_update(model,{bC:_Utils_ap(model.bC,_List_fromArray([interactableId]))}),$elm$core$Platform$Cmd$none))))));case 5:return _Utils_Tuple2(A2($author$project$Rules$unsafeAssert,"NOTEBOOK.!new",model.cf)?_Utils_update(model,{bN:$author$project$LocalTypes$Goals,b2:!model.b2}):model,$elm$core$Platform$Cmd$none);case 16:return _Utils_Tuple2(_Utils_update(model,{bN:msg.a}),$elm$core$Platform$Cmd$none);case 4:return _Utils_Tuple2(A2($author$project$Rules$unsafeAssert,"MAP.location=PLAYER",model.cf)?_Utils_update(model,{b1:!model.b1}):model,$elm$core$Platform$Cmd$none);case 15:return _Utils_Tuple2(_Utils_update(model,{b4:!model.b4}),$elm$core$Platform$Cmd$none);case 6:var line=msg.a,station=msg.b;return A2($author$project$Main$updateAndThen,A2($author$project$Rules$unsafeAssert,"PLAYER.chapter=1",model.cf)&&"BROADWAY_STREET"===station?$author$project$Main$removeDrama:$author$project$Main$noop,A2($author$project$Main$updateAndThen,A3($author$project$Main$delay,rules,2e3,$author$project$LocalTypes$Interact(station)),_Utils_Tuple2(_Utils_update(model,{b0:$author$project$LocalTypes$Train({bI:line,b6:0})}),$elm$core$Platform$Cmd$batch(_List_fromArray([$author$project$Main$playSound("sfx/subway_departure"),$author$project$Main$playSound("sfx/subway_whistle"),$author$project$Main$stopSound("sfx/ambience_crowd_loop"),$author$project$Main$persistSaveReq(_Utils_Tuple2("Autosave (most recent)",model.bC))])))));case 9:return $elm$core$List$length(model.b8)>1?_Utils_Tuple2(_Utils_update(model,{b8:A2($elm$core$List$drop,1,model.b8)}),$elm$core$Platform$Cmd$none):A2($author$project$Main$updateAndThen,(function(m){var _v14=m.b0;switch(_v14.$){case 7:var train=_v14.a;return A2($author$project$Main$updateAndThen,A3($author$project$Main$delay,rules,500,function(a){return{$:21,a:a}}("sfx/subway_departure")),A2($author$project$Main$updateAndThen,A3($author$project$Main$delay,rules,3e3,$author$project$LocalTypes$Disembark),_Utils_Tuple2(_Utils_update(m,{b0:$author$project$LocalTypes$Train(A2($author$project$Main$changeTrainStatus,1,train))}),$author$project$Main$playSound("sfx/subway_arrival2"))));case 1:return _Utils_Tuple2(_Utils_update(m,{b0:$author$project$LocalTypes$Splash}),$elm$core$Platform$Cmd$batch(_List_fromArray([$author$project$Main$playSound("sfx/subway_departure"),A2($elm$core$Task$perform,$elm$core$Basics$always($author$project$LocalTypes$PlaySound("sfx/subway_whistle")),$elm$core$Process$sleep(2e3))])));case 2:return _Utils_Tuple2(_Utils_update(m,{b0:$author$project$LocalTypes$Title($author$project$Main$dayText(m.cf))}),$author$project$Main$stopSound("sfx/subway_departure"));case 0:return _Utils_Tuple2(m,$author$project$Main$stopSound("sfx/subway_departure"));default:return _Utils_Tuple2(m,$elm$core$Platform$Cmd$none)}}),A2($author$project$Main$updateAndThen,$author$project$Main$applyPendingChanges(rules),_Utils_Tuple2(_Utils_update(model,{bx:$elm$core$Maybe$Nothing,b8:_List_Nil}),$elm$core$Platform$Cmd$none)));case 10:return _Utils_Tuple2(_Utils_update(model,{bU:$elm$core$Maybe$Just(""),b8:_List_Nil}),A2($elm$core$Task$attempt,(function(){return $author$project$LocalTypes$NoOp}),$elm$browser$Browser$Dom$focus("player-prompt")));case 11:return _Utils_Tuple2(_Utils_update(model,{bU:$elm$core$Maybe$Just(msg.a)}),$elm$core$Platform$Cmd$none);case 12:return _Utils_eq(A2($elm$core$Maybe$map,$elm$core$String$trim,model.bU),$elm$core$Maybe$Just(""))?_Utils_Tuple2(_Utils_update(model,{bx:$elm$core$Maybe$Nothing,bU:$elm$core$Maybe$Nothing,b8:_List_Nil}),$elm$core$Platform$Cmd$none):A2($elm$core$Maybe$withDefault,_Utils_Tuple2(model,$elm$core$Platform$Cmd$none),A3($elm$core$Maybe$map2,F2((function(freeChatID,playerPrompt){return _Utils_Tuple2(_Utils_update(model,{bU:$elm$core$Maybe$Nothing,b8:_List_fromArray(["> Generating response..."])}),$author$project$Main$sendPrompt(A2($elm$core$Tuple$pair,freeChatID,playerPrompt)))})),model.bx,model.bU));case 13:var response=msg.a.a0;return _Utils_eq(model.bx,$elm$core$Maybe$Just(msg.a.aH))&&1===$elm$core$List$length(model.b8)?_Utils_Tuple2(_Utils_update(model,{b8:A2($elm$core$List$map,(function(s){return A2($elm$core$String$join,"\n\n",_List_fromArray([A3($elm$core$String$replace,"> Generating response...","",s),response]))}),model.b8)}),$elm$core$Platform$Cmd$none):_Utils_Tuple2(model,$elm$core$Platform$Cmd$none);case 20:return _Utils_Tuple2(model,$author$project$Main$playSound(msg.a));case 24:return A2($author$project$Main$queueLoop,msg.a,model);case 22:return $author$project$Main$addDrama(model);case 23:return $author$project$Main$removeDrama(model);case 21:return _Utils_Tuple2(model,$author$project$Main$stopSound(msg.a));case 19:return _Utils_Tuple2(model,$elm$core$Platform$Cmd$batch(_List_fromArray([$author$project$Main$playSound("sfx/subway_arrival"),A2($elm$core$Task$perform,$elm$core$Basics$always($author$project$LocalTypes$SubwaySounds),$elm$core$Process$sleep(37e3))])));case 14:return _Utils_Tuple2(_Utils_update(model,{b8:_List_fromArray([$author$project$NarrativeContent$t(msg.a)])}),$elm$core$Platform$Cmd$none);case 7:var currentStation=$author$project$Main$getCurrentStation(model.cf);return A2($author$project$Main$updateAndThen,A3($author$project$Main$delay,rules,500,$author$project$LocalTypes$DisembarkStory),_Utils_Tuple2(_Utils_update(model,{b0:$author$project$LocalTypes$Lobby}),$elm$core$Platform$Cmd$batch(_List_fromArray([A2($elm$core$List$member,currentStation,_List_fromArray(["BROADWAY_STREET","CONVENTION_CENTER","CAPITOL_HEIGHTS","UNIVERSITY","ST_MARKS"]))?$author$project$Main$playSound("sfx/ambience_crowd_loop"):$elm$core$Platform$Cmd$none]))));case 8:return A3($author$project$Main$updateStory,rules,"disembark",model);default:var newDebugState=A2($elm$core$Maybe$map,$jschomay$elm_narrative_engine$NarrativeEngine$Debug$updateSearch(msg.a),model.br);return _Utils_Tuple2(_Utils_update(model,{br:newDebugState}),$elm$core$Platform$Cmd$none)}var a})),$author$project$Main$updateStory=F3((function(rules,trigger,model){var _v0=A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$Rules$findMatchingRule,trigger,rules,model.cf);if(1===_v0.$){var newDebugState=A2($elm$core$Maybe$map,A2($elm$core$Basics$composeR,$jschomay$elm_narrative_engine$NarrativeEngine$Debug$setLastMatchedRuleId("no matching rule"),$jschomay$elm_narrative_engine$NarrativeEngine$Debug$setLastInteractionId(trigger)),model.br),_v1=A2($author$project$Rules$unsafeAssert,trigger+".silent",model.cf)?_Utils_Tuple2(_List_Nil,model.bZ):A4($author$project$Main$parseNarrative,model,trigger,trigger,$author$project$NarrativeContent$t(trigger)),newStory=_v1.a,newMatchCounts=_v1.b;return A2($author$project$Main$updateAndThen,A2($author$project$Main$specialEvents,rules,trigger),_Utils_Tuple2(_Utils_update(model,{br:newDebugState,bZ:newMatchCounts,b8:newStory}),$elm$core$Platform$Cmd$none))}var _v2=_v0.a,matchedRuleID=_v2.a,matchedRule=_v2.b,_v3=(newDebugState=A2($elm$core$Maybe$map,A2($elm$core$Basics$composeR,$jschomay$elm_narrative_engine$NarrativeEngine$Debug$setLastMatchedRuleId(matchedRuleID),$jschomay$elm_narrative_engine$NarrativeEngine$Debug$setLastInteractionId(trigger)),model.br),A4($author$project$Main$parseNarrative,model,matchedRuleID,trigger,$author$project$NarrativeContent$t(matchedRuleID)));newMatchCounts=_v3.b;return A2($author$project$Main$updateAndThen,model.bJ?$author$project$Main$noop:function(m){return _Utils_Tuple2(m,$elm$core$Platform$Cmd$batch(_List_fromArray([A2($author$project$Main$maybeAutosaveChapter,matchedRuleID,m),$author$project$Main$trackEvent(matchedRuleID)])))},A2($author$project$Main$updateAndThen,$elm$core$List$isEmpty(newStory=_v3.a)?$author$project$Main$applyPendingChanges(rules):$author$project$Main$noop,_Utils_Tuple2(_Utils_update(model,{br:newDebugState,bR:$elm$core$Maybe$Just(_Utils_Tuple3(trigger,matchedRule.bn,matchedRuleID)),bZ:newMatchCounts,b8:newStory}),$elm$core$Platform$Cmd$none)))})),$author$project$LocalTypes$DebugSeachWorldModel=function(a){return{$:17,a:a}},$elm$html$Html$Attributes$stringProperty=F2((function(key,string){return A2(_VirtualDom_property,key,$elm$json$Json$Encode$string(string))})),$elm$html$Html$Attributes$class=$elm$html$Html$Attributes$stringProperty("className"),$elm$html$Html$input=_VirtualDom_node("input"),$elm$html$Html$Events$alwaysStop=function(x){return _Utils_Tuple2(x,!0)},$elm$virtual_dom$VirtualDom$on=_VirtualDom_on,$elm$html$Html$Events$stopPropagationOn=F2((function(event,decoder){return A2($elm$virtual_dom$VirtualDom$on,event,{$:1,a:decoder})})),$elm$json$Json$Decode$at=F2((function(fields,decoder){return A3($elm$core$List$foldr,$elm$json$Json$Decode$field,decoder,fields)})),$elm$html$Html$Events$targetValue=A2($elm$json$Json$Decode$at,_List_fromArray(["target","value"]),$elm$json$Json$Decode$string),$elm$html$Html$Events$onInput=function(tagger){return A2($elm$html$Html$Events$stopPropagationOn,"input",A2($elm$json$Json$Decode$map,$elm$html$Html$Events$alwaysStop,A2($elm$json$Json$Decode$map,tagger,$elm$html$Html$Events$targetValue)))},$elm$html$Html$Attributes$placeholder=$elm$html$Html$Attributes$stringProperty("placeholder"),$elm$html$Html$span=_VirtualDom_node("span"),$elm$core$String$toLower=function(str){return str.toLowerCase()},$elm$html$Html$Attributes$value=$elm$html$Html$Attributes$stringProperty("value"),$jschomay$elm_narrative_engine$NarrativeEngine$Debug$debugBar=F3((function(msg,worldModel,_v0){var lastInteractionId=_v0.ag,lastMatchedRuleId=_v0.ah,searchText=_v0.ak,fuzzyMatch=F2((function(search,text){return A2($elm$core$String$contains,$elm$core$String$toLower(search),$elm$core$String$toLower(text))})),displayWorldModel=A2($elm$core$List$map,(function(_v3){var id=_v3.a,tags=_v3.b.a8,stats=_v3.b.a5,links=_v3.b.aN;return A2($elm$core$String$join,".",A2($elm$core$List$filter,A2($elm$core$Basics$composeL,$elm$core$Basics$not,$elm$core$String$isEmpty),A2($elm$core$List$map,$elm$core$String$join("."),_List_fromArray([_List_fromArray([id]),$elm$core$Set$toList(tags),A2($elm$core$List$map,(function(_v1){return A2($elm$core$String$join,"=",_List_fromArray([_v1.a,$elm$core$String$fromInt(_v1.b)]))}),$elm$core$Dict$toList(stats)),A2($elm$core$List$map,(function(_v2){return A2($elm$core$String$join,"=",_List_fromArray([_v2.a,_v2.b]))}),$elm$core$Dict$toList(links))]))))}),$elm$core$Dict$toList(worldModel)),filteredDisplayWorldModel=$elm$core$String$isEmpty(searchText)?_List_Nil:A2($elm$core$List$sortBy,(function(text){return A2($elm$core$String$startsWith,$elm$core$String$toLower(searchText),$elm$core$String$toLower(text))?-1:0}),A2($elm$core$List$filter,fuzzyMatch(searchText),displayWorldModel));return A2($elm$html$Html$div,_List_fromArray([A2($elm$html$Html$Attributes$style,"color","yellow"),A2($elm$html$Html$Attributes$style,"font-family","Courier"),A2($elm$html$Html$Attributes$style,"background","black"),A2($elm$html$Html$Attributes$style,"opacity","0.9"),A2($elm$html$Html$Attributes$style,"lineHeight","1.5em")]),_List_fromArray([$elm$html$Html$text("Debug mode"),A2($elm$html$Html$input,_List_fromArray([$elm$html$Html$Events$onInput(msg),$elm$html$Html$Attributes$value(searchText),$elm$html$Html$Attributes$placeholder("Search world model"),A2($elm$html$Html$Attributes$style,"margin","0 10px")]),_List_Nil),A2($elm$html$Html$span,_List_Nil,_List_fromArray([$elm$html$Html$text("Last triggered rule: "+lastInteractionId+" - "+lastMatchedRuleId)])),A2($elm$html$Html$ul,_List_fromArray([A2($elm$html$Html$Attributes$style,"borderTop","1px solid #333")]),A2($elm$core$List$map,(function(e){return A2($elm$html$Html$li,_List_Nil,_List_fromArray([$elm$html$Html$text(e)]))}),filteredDisplayWorldModel))]))})),$elm$html$Html$Attributes$id=$elm$html$Html$Attributes$stringProperty("id"),$elm$html$Html$Events$on=F2((function(event,decoder){return A2($elm$virtual_dom$VirtualDom$on,event,{$:0,a:decoder})})),$elm$html$Html$Events$onClick=function(msg){return A2($elm$html$Html$Events$on,"click",$elm$json$Json$Decode$succeed(msg))},$elm_explorations$markdown$Markdown$defaultOptions={av:$elm$core$Maybe$Nothing,bz:$elm$core$Maybe$Just({bl:!1,ca:!1}),b_:!0,b5:!1},$elm$core$Maybe$isJust=function(maybe){return!maybe.$},$elm_explorations$markdown$Markdown$toHtml=_Markdown_toHtml($elm_explorations$markdown$Markdown$defaultOptions),$author$project$Main$endView=A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Scene MainTitleScene")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("MainTitleContent")]),_List_fromArray([A2($elm_explorations$markdown$Markdown$toHtml,_List_Nil,"![title](img/title.jpg)\n\nThe end of Part 1 - Thank you for playing!")]))])),$author$project$Subway$lineInfo=function(line){switch(line){case 0:return{aH:"RED_LINE",bM:"Red Line",J:1,G:_List_fromArray(["WEST_MULBERRY","EAST_MULBERRY","CHURCH_STREET","BROADWAY_STREET","CONVENTION_CENTER","SPRING_HILL","TWIN_BROOKS"])};case 1:return{aH:"YELLOW_LINE",bM:"Yellow Line",J:2,G:_List_fromArray(["RIVERSIDE","ST_MARKS","BROADWAY_STREET","CONVENTION_CENTER","CAPITOL_HEIGHTS","MACARTHURS_PARK"])};case 2:return{aH:"GREEN_LINE",bM:"Green Line",J:3,G:_List_fromArray(["BURLINGTON","SAMUAL_STREET","CAPITOL_HEIGHTS","CONVENTION_CENTER"])};case 3:return{aH:"ORANGE_LINE",bM:"Orange Line",J:4,G:_List_fromArray(["IRIS_LAKE","NORWOOD","ST_MARKS","UNIVERSITY","SPRING_HILL","CAPITOL_HEIGHTS","SEVENTY_THIRD_STREET","ONE_HUNDRED_FORTH_STREET"])};case 4:return{aH:"BLUE_LINE",bM:"Blue Line",J:5,G:_List_fromArray(["ONE_HUNDRED_FORTH_STREET","SEVENTY_THIRD_STREET","FORTY_SECOND_STREET","MUSEUM","BROADWAY_STREET","ST_MARKS","PARK_AVE","WESTGATE"])};default:return{aH:"PURPLE_LINE",bM:"Purple Line",J:6,G:_List_fromArray(["HIGHLAND","FAIRVIEW","EAST_MULBERRY","CHURCH_STREET","MUSEUM","CONVENTION_CENTER","UNIVERSITY","WALTER_HILL"])}}},$author$project$Subway$fullMap=A2($elm$core$List$map,(function(line){return _Utils_Tuple2(line,$author$project$Subway$lineInfo(line).G)}),_List_fromArray([0,2,1,3,4,5])),$elm$html$Html$img=_VirtualDom_node("img"),$elm$html$Html$Attributes$src=function(url){return A2($elm$html$Html$Attributes$stringProperty,"src",/^\s*(javascript:|data:text\/html)/i.test(value=url)?"":value);var value},$elm$html$Html$Keyed$node=function(tag){return _VirtualDom_keyedNode(function(tag){return"script"==tag?"p":tag}(tag))},$author$project$LocalTypes$Delete=function(a){return{$:3,a:a}},$author$project$LocalTypes$Distractions={$:1},$author$project$LocalTypes$PersistKeyUpdate=function(a){return{$:5,a:a}},$author$project$LocalTypes$Save=F2((function(a,b){return{$:1,a:a,b:b}})),$author$project$LocalTypes$ToggleNotebookPage=function(a){return{$:16,a:a}},$elm$html$Html$Attributes$classList=function(classes){return $elm$html$Html$Attributes$class(A2($elm$core$String$join," ",A2($elm$core$List$map,$elm$core$Tuple$first,A2($elm$core$List$filter,$elm$core$Tuple$second,classes))))},$elm$html$Html$Events$custom=F2((function(event,decoder){return A2($elm$virtual_dom$VirtualDom$on,event,{$:3,a:decoder})})),$author$project$Views$NoteBook$distractions=_List_fromArray([_Utils_Tuple3("GIRL_IN_YELLOW.who_was_girl_in_yellow_quest","Who was that girl in yellow?",_List_fromArray(["","",""])),_Utils_Tuple3("MOTHER.screaming_child_quest","Stop the kid from screaming.",_List_fromArray(["Find a soda for the kid",""])),_Utils_Tuple3("DISTRESSED_WOMAN.missing_dog_posters_quest","Hang up the missing dog posters.",_List_fromArray(["","","","","",""])),_Utils_Tuple3("MAN_IN_HOT_DOG_SUIT.job_hunt_quest_1","Help the hot dog mascot work at Fort Frank",_List_fromArray(["","",""]))]),$author$project$Views$NoteBook$goals=_List_fromArray([_Utils_Tuple3("PLAYER.present_proposal","Present proposal",_List_fromArray(["Get to work by 6:30am","Get to work by 6:45am","Get to work by 7:00am",""])),_Utils_Tuple3("PLAYER.find_briefcase","Find stolen briefcase!",_List_fromArray(["Report it stolen?","Talk to Mark @ Capitol Heights?","Broom closet @ 73rd",""])),_Utils_Tuple3("PLAYER.call_boss","Call Mr. Harris",_List_fromArray(["",""]))]),$elm$html$Html$h3=_VirtualDom_node("h3"),$elm$html$Html$p=_VirtualDom_node("p"),$elm$core$List$takeReverse=F3((function(n,list,kept){takeReverse:for(;;){if(n>0){if(list.b){var x=list.a;n=n-1,list=list.b,kept=A2($elm$core$List$cons,x,kept);continue takeReverse}return kept}return kept}})),$elm$core$List$takeTailRec=F2((function(n,list){return $elm$core$List$reverse(A3($elm$core$List$takeReverse,n,list,_List_Nil))})),$elm$core$List$takeFast=F3((function(ctr,n,list){if(n>0){var _v0=_Utils_Tuple2(n,list);_v0$1:for(;;){_v0$5:for(;;){if(!_v0.b.b)return list;if(!_v0.b.b.b){if(1===_v0.a)break _v0$1;break _v0$5}switch(_v0.a){case 1:break _v0$1;case 2:var _v2=_v0.b;return _List_fromArray([_v2.a,_v2.b.a]);case 3:if(_v0.b.b.b.b){var _v4=_v0.b,_v5=_v4.b;return _List_fromArray([_v4.a,_v5.a,_v5.b.a])}break _v0$5;default:if(_v0.b.b.b.b&&_v0.b.b.b.b.b){var _v7=_v0.b,_v8=_v7.b,_v9=_v8.b,_v10=_v9.b,w=_v10.a,tl=_v10.b;return A2($elm$core$List$cons,_v7.a,A2($elm$core$List$cons,_v8.a,A2($elm$core$List$cons,_v9.a,A2($elm$core$List$cons,w,ctr>1e3?A2($elm$core$List$takeTailRec,n-4,tl):A3($elm$core$List$takeFast,ctr+1,n-4,tl)))))}break _v0$5}}return list}return _List_fromArray([_v0.b.a])}return _List_Nil})),$elm$core$List$take=F2((function(n,list){return A3($elm$core$List$takeFast,0,n,list)})),$author$project$Views$NoteBook$view=function(_v0){var worldModel=_v0.cf,noteBookPage=_v0.bN,persistKey=_v0.bS,history=_v0.bC,goalListItemView=F3((function(title,subGoals,level){return A2($elm$html$Html$li,_List_fromArray([$elm$html$Html$Attributes$classList(_List_fromArray([_Utils_Tuple2("Notebook__item",!0),_Utils_Tuple2("done",_Utils_cmp(level,$elm$core$List$length(subGoals))>-1)]))]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__subheading")]),_List_fromArray([$elm$html$Html$text(title)])),A2($elm$html$Html$ul,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__sublist")]),A2($elm$core$List$map,(function(t){return A2($elm$html$Html$li,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__subitem")]),_List_fromArray([$elm$html$Html$text(t)]))}),A2($elm$core$List$take,level,subGoals)))]))})),goalListView=function(goals_){return A2($elm$html$Html$ul,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__content")]),$elm$core$List$reverse(A3($elm$core$List$foldl,F2((function(_v2,acc){var title=_v2.b,subGoals=_v2.c,_v3=function(goalId){var _v4=A2($elm$core$String$split,".",goalId);return _v4.b&&_v4.b.b&&!_v4.b.b.b?A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$getStat,_v4.a,_v4.b.a,worldModel):$elm$core$Maybe$Nothing}(_v2.a);if(_v3.$)return acc;var level=_v3.a;return level>0?A2($elm$core$List$cons,A3(goalListItemView,title,subGoals,level),acc):acc})),_List_Nil,goals_)))},click=function(msg){return A2($elm$html$Html$Events$custom,"click",$elm$json$Json$Decode$succeed({bK:msg,bV:!0,b7:!0}))},saveItemView=function(s){return A2($elm$html$Html$li,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__item")]),_List_fromArray([A2($elm$html$Html$span,_List_fromArray([click($author$project$LocalTypes$Persist((a=s,{$:2,a:a}))),$elm$html$Html$Attributes$class("Notebook__item--savedGame")]),_List_fromArray([$elm$html$Html$text(s)])),A2($elm$html$Html$span,_List_fromArray([click($author$project$LocalTypes$Persist($author$project$LocalTypes$Delete(s))),$elm$html$Html$Attributes$class("Notebook__item-delete")]),_List_fromArray([$elm$html$Html$text("(delete)")]))]));var a},savesView=function(saves){return A2($elm$html$Html$ul,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__content")]),A2($elm$core$List$map,saveItemView,A2($elm$core$List$sortBy,$elm$core$Basics$identity,saves)))};return A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Notebook")]),_Utils_ap(_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__tabs")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__tab Notebook__tab--goals"),click($author$project$LocalTypes$ToggleNotebookPage($author$project$LocalTypes$Goals))]),_List_fromArray([$elm$html$Html$text("Goals")])),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__tab Notebook__tab--distractions"),click($author$project$LocalTypes$ToggleNotebookPage($author$project$LocalTypes$Distractions))]),_List_fromArray([$elm$html$Html$text("Distractions")])),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__tab Notebook__tab--savedGames"),click($author$project$LocalTypes$Persist($author$project$LocalTypes$ListSaves))]),_List_fromArray([$elm$html$Html$text("Saved games")]))]))]),function(){switch(noteBookPage.$){case 0:return _List_fromArray([A2($elm$html$Html$h3,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__header")]),_List_fromArray([$elm$html$Html$text("Goals")])),goalListView($author$project$Views$NoteBook$goals)]);case 1:return _List_fromArray([A2($elm$html$Html$h3,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__header")]),_List_fromArray([$elm$html$Html$text("Distractions")])),goalListView($author$project$Views$NoteBook$distractions)]);default:var saves=noteBookPage.a;return _List_fromArray([A2($elm$html$Html$h3,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__header")]),_List_fromArray([$elm$html$Html$text("Saved games")])),A2($elm$html$Html$input,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__persistKeyInput"),$elm$html$Html$Attributes$id("persistKeyInput"),click($author$project$LocalTypes$NoOp),$elm$html$Html$Events$onInput(A2($elm$core$Basics$composeL,$author$project$LocalTypes$Persist,$author$project$LocalTypes$PersistKeyUpdate)),$elm$html$Html$Attributes$value(persistKey)]),_List_Nil),A2($elm$html$Html$p,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__save-new"),click($author$project$LocalTypes$Persist(A2($author$project$LocalTypes$Save,persistKey,history)))]),_List_fromArray([$elm$html$Html$text("Save new")])),savesView(saves)])}}()))},$author$project$Main$notebookView=function(model){return A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Notebook__scrim"),$elm$html$Html$Events$onClick($author$project$LocalTypes$ToggleNotebook)]),_List_fromArray([$author$project$Views$NoteBook$view(model)]))},$author$project$LocalTypes$UpdatePrompt=function(a){return{$:11,a:a}},$elm$html$Html$Events$keyCode=A2($elm$json$Json$Decode$field,"keyCode",_Json_decodeInt),$elm$html$Html$Events$preventDefaultOn=F2((function(event,decoder){return A2($elm$virtual_dom$VirtualDom$on,event,{$:2,a:decoder})})),$elm$html$Html$textarea=_VirtualDom_node("textarea"),$author$project$Main$splashView=A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Scene Splash")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("MainTitleContent")]),_List_fromArray([A2($elm_explorations$markdown$Markdown$toHtml,_List_Nil,"![title](img/title.jpg)"),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("StoryLine__actions")]),_List_fromArray([A2($elm$html$Html$span,_List_fromArray([$elm$html$Html$Attributes$class("StoryLine__action"),$elm$html$Html$Events$onClick($author$project$LocalTypes$Continue)]),_List_fromArray([$elm$html$Html$text("Continue...")]))]))]))])),$author$project$Main$storyView=F3((function(story,isFinal,allowFreeChat){var nextText=isFinal?"Done":"Continue...",linkParser=A2($elm$json$Json$Decode$map,(function(path){return _Utils_Tuple2($author$project$LocalTypes$Interact(A2($elm$core$Maybe$withDefault,p=path,$elm$core$List$head($elm$core$List$reverse(A2($elm$core$String$split,"/",p))))),!0);var p}),A2($elm$json$Json$Decode$at,_List_fromArray(["target","pathname"]),$elm$json$Json$Decode$string)),catchLinkClicks=A2($elm$html$Html$Events$preventDefaultOn,"click",A2($elm$json$Json$Decode$map,$elm$core$Basics$identity,linkParser));return _Utils_Tuple2(story,A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("StoryLine__content")]),_List_fromArray([A2($elm_explorations$markdown$Markdown$toHtml,_List_fromArray([catchLinkClicks]),story),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("StoryLine__actions")]),A2($elm$core$List$cons,A2($elm$html$Html$span,_List_fromArray([$elm$html$Html$Attributes$class("StoryLine__action"),$elm$html$Html$Events$onClick($author$project$LocalTypes$Continue)]),_List_fromArray([$elm$html$Html$text(nextText)])),isFinal&&allowFreeChat?_List_fromArray([A2($elm$html$Html$span,_List_fromArray([$elm$html$Html$Attributes$class("StoryLine__action"),$elm$html$Html$Events$onClick($author$project$LocalTypes$StartPrompt)]),_List_fromArray([$elm$html$Html$text("Talk more...")]))]):_List_Nil))])))})),$author$project$Main$storyWrapperView=function(viewFn){return A3($elm$html$Html$Keyed$node,"div",_List_fromArray([$elm$html$Html$Attributes$class("StoryLine")]),_List_fromArray([viewFn]))},$author$project$Views$Shared$inventoryView=function(worldModel){var inventory=A2($author$project$Rules$unsafeQuery,"*.item.location=PLAYER",worldModel),groupedEntityTags=_List_fromArray(["pass","missing_dog_poster"]),groupInventory=A2($elm$core$Basics$composeR,A2($elm$core$List$foldr,F2((function(e,_v1){var _v3,updatedGroups,id=e.a,entities=_v1.a,existingGroups=_v1.b;return _v3=A3($elm$core$List$foldl,F2((function(groupTag,_v2){var keep=_v2.a,groups=_v2.b;return A2($author$project$Rules$unsafeAssert,id+"."+groupTag,worldModel)?A2($elm$core$Set$member,groupTag,groups)?_Utils_Tuple2(keep&&!1,groups):_Utils_Tuple2(keep&&!0,A2($elm$core$Set$insert,groupTag,groups)):_Utils_Tuple2(keep&&!0,groups)})),_Utils_Tuple2(!0,existingGroups),groupedEntityTags),updatedGroups=_v3.b,_Utils_Tuple2(_v3.a?A2($elm$core$List$cons,e,entities):entities,updatedGroups)})),_Utils_Tuple2(_List_Nil,$elm$core$Set$empty)),$elm$core$Tuple$first),getIcon=function(id){return"img/icons/"+$elm$core$String$toLower(A2($elm$core$Maybe$withDefault,id,A3($elm$core$List$foldl,F2((function(groupTag,acc){return _Utils_eq(acc,$elm$core$Maybe$Nothing)&&A2($author$project$Rules$unsafeAssert,id+"."+groupTag,worldModel)?$elm$core$Maybe$Just(groupTag):acc})),$elm$core$Maybe$Nothing,groupedEntityTags)))+".svg"},inventoryItemView=function(_v0){var id=_v0.a;return A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$classList(_List_fromArray([_Utils_Tuple2("Inventory__item",!0),_Utils_Tuple2("Inventory__item--new",A2($author$project$Rules$unsafeAssert,id+".new",worldModel))])),$elm$html$Html$Events$onClick($author$project$LocalTypes$Interact(id))]),_List_fromArray([A2($elm$html$Html$img,_List_fromArray([$elm$html$Html$Attributes$src(getIcon(id))]),_List_Nil)]))};return A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Sign Sign--inventory")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Inventory")]),A2($elm$core$List$map,inventoryItemView,groupInventory(inventory)))]))},$elm$core$List$maybeCons=F3((function(f,mx,xs){var _v0=f(mx);return _v0.$?xs:A2($elm$core$List$cons,_v0.a,xs)})),$elm$core$List$filterMap=F2((function(f,xs){return A3($elm$core$List$foldr,$elm$core$List$maybeCons(f),_List_Nil,xs)})),$author$project$Views$Station$Connections$byLine=F2((function(clickable,line){var lineInfo=$author$project$Subway$lineInfo(line);return A2($elm$html$Html$div,A2($elm$core$List$filterMap,$elm$core$Basics$identity,_List_fromArray([$elm$core$Maybe$Just($elm$html$Html$Attributes$class("Connection "+lineInfo.aH)),clickable?$elm$core$Maybe$Just($elm$html$Html$Events$onClick($author$project$LocalTypes$Interact(lineInfo.aH))):$elm$core$Maybe$Nothing])),_List_fromArray([$elm$html$Html$text($elm$core$String$fromInt(lineInfo.J))]))})),$author$project$Subway$connectingLines=F2((function(map,currentStation){return A3($elm$core$List$foldl,F2((function(_v0,acc){var line=_v0.a;return A2($elm$core$List$member,currentStation,_v0.b)?A2($elm$core$List$cons,line,acc):acc})),_List_Nil,map)})),$author$project$Views$Station$Connections$forStation=F2((function(map,currentStation){return A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Connections")]),A2($elm$core$List$map,$author$project$Views$Station$Connections$byLine(!0),A2($elm$core$List$sortBy,A2($elm$core$Basics$composeR,$author$project$Subway$lineInfo,(function($){return $.J})),A2($author$project$Subway$connectingLines,map,currentStation))))})),$author$project$Views$Station$Lobby$view=F3((function(map,worldModel,currentStation){var stationName=A2($elm$core$Maybe$withDefault,"ERRORR getting station: "+currentStation,A2($elm$core$Maybe$map,(function(s){return s.bM+" Station"}),A2($elm$core$Dict$get,currentStation,worldModel))),items=A2($author$project$Rules$unsafeQuery,"*.item.!hidden.location="+currentStation,worldModel),config={bq:0,bW:$elm$core$Dict$empty,cc:"",cf:worldModel},interactableItemView=F2((function(wm,_v0){var id=_v0.a,name=_v0.b.bM,inworldID=_v0.b.ad;return A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Sign__item Sign__item--interactable"),$elm$html$Html$Events$onClick($author$project$LocalTypes$Interact(id))]),_List_fromArray([$elm$html$Html$text(A2($elm$core$Maybe$withDefault,name,$elm$core$List$head(A2($jschomay$elm_narrative_engine$NarrativeEngine$Syntax$NarrativeParser$parse,config,name)))),_Utils_eq(inworldID,$elm$core$Maybe$Nothing)?$elm$html$Html$text(""):A2($elm$html$Html$img,_List_fromArray([$elm$html$Html$Attributes$src("img/icons/chat.svg"),$elm$html$Html$Attributes$class("Sign__chat-icon")]),_List_Nil)]))})),characters=A2($author$project$Rules$unsafeQuery,"*.character.!hidden.location="+currentStation,worldModel),stationInfoView=A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Sign Sign--station")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Sign__header1")]),_List_fromArray([$elm$html$Html$text(stationName)])),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Sign__split")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Sign__left")]),_List_fromArray([A2($author$project$Views$Station$Connections$forStation,map,currentStation)])),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Sign__right")]),A2($elm$core$List$map,interactableItemView(worldModel),_Utils_ap(characters,items)))]))]));return A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Scene Lobby")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Lobby__scene")]),_List_fromArray([stationInfoView,$author$project$Views$Shared$inventoryView(worldModel)]))]))})),$author$project$Views$Station$Passageway$view=A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Scene Passageway")]),_List_Nil),$author$project$LocalTypes$BoardTrain=F2((function(a,b){return{$:6,a:a,b:b}})),$author$project$Views$Station$Platform$view=F4((function(map,currentStation,line,worldModel){var msg,stationName=function(station){return A2($elm$core$Maybe$withDefault,"ERRORR getting station: "+currentStation,A2($elm$core$Maybe$map,(function(s){return s.bM+" Station"}),A2($elm$core$Dict$get,station,worldModel)))},stationIsOutOfService=function(station){return A2($author$project$Rules$unsafeAssert,station+".out_of_service",worldModel)},restrictDestination=A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$getLink,"PLAYER","destination",worldModel),lineInfo=$author$project$Subway$lineInfo(line),lineInfoView=A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Line_map__info")]),_List_fromArray([A2($author$project$Views$Station$Connections$byLine,!1,line),$elm$html$Html$text(lineInfo.bM)])),connections=function(station){return A2($elm$core$List$sortBy,A2($elm$core$Basics$composeR,$author$project$Subway$lineInfo,(function($){return $.J})),A2($author$project$Subway$connectingLines,map,station))},stopView=F2((function(transferLine,station){return A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Stop"),$elm$html$Html$Events$onClick(_Utils_eq(station,currentStation)?$author$project$LocalTypes$NoOp:stationIsOutOfService(station)?$author$project$LocalTypes$Interact(station):_Utils_eq(restrictDestination,$elm$core$Maybe$Nothing)||_Utils_eq(restrictDestination,$elm$core$Maybe$Just(station))?A2($author$project$LocalTypes$BoardTrain,line,station):$author$project$LocalTypes$Interact(station))]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Stop__connections")]),A2($elm$core$List$map,$author$project$Views$Station$Connections$byLine(!1),A2($elm$core$List$filter,$elm$core$Basics$neq(transferLine),connections(station)))),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$classList(_List_fromArray([_Utils_Tuple2("Stop__dot",!0),_Utils_Tuple2($author$project$Subway$lineInfo(line).aH,!0),_Utils_Tuple2("Stop__dot--current",_Utils_eq(station,currentStation))]))]),_List_Nil),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$classList(_List_fromArray([_Utils_Tuple2("Stop__name",!0),_Utils_Tuple2("Stop__name--current",_Utils_eq(station,currentStation))]))]),_List_fromArray([$elm$html$Html$text(stationName(station))]))]))}));return A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Scene Platform")]),_List_fromArray([(msg=$author$project$LocalTypes$Interact("LOBBY"),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Exit"),$elm$html$Html$Events$onClick(msg)]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Arrow")]),_List_fromArray([$elm$html$Html$text(" ")])),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Exit__text")]),_List_fromArray([$elm$html$Html$text("Exit")]))]))),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Line_map")]),_List_fromArray([lineInfoView,A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Line_map__stops")]),_Utils_ap(_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Line_map__line "+lineInfo.aH)]),_List_Nil)]),A2($elm$core$List$map,stopView(line),lineInfo.G)))]))]))})),$author$project$Views$Station$Turnstile$view=F2((function(worldModel,line){var lineInfo=$author$project$Subway$lineInfo(line),canEnter=!$elm$core$List$isEmpty(A2($author$project$Rules$unsafeQuery,"*.valid_on="+lineInfo.aH+".location=PLAYER",worldModel));return A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Scene Turnstile")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Turnstile__dialog")]),_List_fromArray(canEnter?[A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Turnstile__status")]),_List_fromArray([A2($elm$html$Html$img,_List_fromArray([$elm$html$Html$Attributes$class("Turnstile__icon"),$elm$html$Html$Attributes$src("img/icons/enter.svg")]),_List_Nil),A2($elm$html$Html$div,_List_Nil,_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Turnstile__status_text")]),_List_fromArray([$elm$html$Html$text("Ticket valid")])),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Turnstile__status_sub_text")]),_List_fromArray([$elm$html$Html$text("Please proceed")]))]))])),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Turnstile__buttons")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Turnstile__button"),$elm$html$Html$Events$onClick($author$project$LocalTypes$Interact(lineInfo.aH))]),_List_fromArray([$elm$html$Html$text("Continue")]))]))]:[A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Turnstile__status")]),_List_fromArray([A2($elm$html$Html$img,_List_fromArray([$elm$html$Html$Attributes$class("Turnstile__icon"),$elm$html$Html$Attributes$src("img/icons/no_entry.svg")]),_List_Nil),A2($elm$html$Html$div,_List_Nil,_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Turnstile__status_text")]),_List_fromArray([$elm$html$Html$text("Invalid ticket")])),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Turnstile__status_sub_text")]),_List_fromArray([$elm$html$Html$text("Do not enter")]))]))])),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Turnstile__buttons")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Turnstile__button"),$elm$html$Html$Events$onClick($author$project$LocalTypes$Interact("LOBBY"))]),_List_fromArray([$elm$html$Html$text("Go back")])),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Turnstile__button"),$elm$html$Html$Events$onClick($author$project$LocalTypes$Interact(lineInfo.aH))]),_List_fromArray([$elm$html$Html$text("Jump turnstile")]))]))]))]))})),$author$project$Views$Train$view=function(_v0){var arrivingAtStation=_v0.bi,worldModel=_v0.cf,display=A2($elm$core$Maybe$withDefault,$author$project$Subway$lineInfo(_v0.bI).bM,A2($elm$core$Maybe$map,(function(station){return"Arriving at: "+function(station){return A2($elm$core$Maybe$withDefault,"ERRORR getting station: "+station,A2($elm$core$Maybe$map,(function(s){return s.bM+" Station"}),A2($elm$core$Dict$get,station,worldModel)))}(station)}),arrivingAtStation)),displayView=A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("train__ticker")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("train__info")]),_List_fromArray([$elm$html$Html$text(display)]))]));_List_fromArray([$elm$html$Html$Attributes$class("train__foreground")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("train__top")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("train__ticker")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("train__info")]),_List_fromArray([$elm$html$Html$text(display)]))]))])),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("train__doors")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("train__door train__door--left")]),_List_Nil),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("train__door train__door--right")]),_List_Nil)]))]),_List_fromArray([$elm$html$Html$Attributes$class("train__background")]);return A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Scene train")]),_List_fromArray([displayView]))},$author$project$Main$mainView=function(model){var worldModel,prompt,n,_v1,scene=A2($author$project$Rules$unsafeAssert,"PLAYER.caught",model.cf)?$author$project$LocalTypes$CentralGuardOffice:model.b0,map=$author$project$Subway$fullMap,currentStation=$author$project$Main$getCurrentStation(model.cf);return A3($elm$html$Html$Keyed$node,"div",_List_fromArray([$elm$html$Html$Attributes$class("game")]),_List_fromArray([function(){switch(scene.$){case 1:return _Utils_Tuple2("mainTitle",$elm$html$Html$text(""));case 2:return _Utils_Tuple2("splash",$author$project$Main$splashView);case 0:return _Utils_Tuple2("title",function(title){return A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Scene TitleScene")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("TitleContent")]),_List_fromArray([A2($elm$html$Html$h1,_List_fromArray([$elm$html$Html$Attributes$class("Title")]),_List_fromArray([$elm$html$Html$text(title)])),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("StoryLine__actions")]),_List_fromArray([A2($elm$html$Html$span,_List_fromArray([$elm$html$Html$Attributes$class("StoryLine__action"),$elm$html$Html$Events$onClick($author$project$LocalTypes$Interact("next_day"))]),_List_fromArray([$elm$html$Html$text("Continue...")]))]))]))]))}(scene.a));case 3:return _Utils_Tuple2("end",$author$project$Main$endView);case 9:return _Utils_Tuple2("centralGuardOffice",(items=A2($author$project$Rules$unsafeQuery,"*.item.location=CENTRAL_GUARD_OFFICE",worldModel=model.cf),interactableItemView=function(_v0){var id=_v0.a,name=_v0.b;return A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Sign__item Sign__item--interactable"),$elm$html$Html$Events$onClick($author$project$LocalTypes$Interact(id))]),_List_fromArray([$elm$html$Html$text(name)]))},characters=A2($author$project$Rules$unsafeQuery,"*.character.location=CENTRAL_GUARD_OFFICE",worldModel),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Scene CentralGuardOffice")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("CentralGuardOffice--content Sign__right")]),A2($elm$core$List$map,A2($elm$core$Basics$composeR,$elm$core$Tuple$mapSecond((function($){return $.bM})),interactableItemView),_Utils_ap(characters,items))),$author$project$Views$Shared$inventoryView(worldModel)]))));case 4:return _Utils_Tuple2("lobby",A3($author$project$Views$Station$Lobby$view,map,model.cf,currentStation));case 6:return _Utils_Tuple2("platform",A4($author$project$Views$Station$Platform$view,map,currentStation,line=scene.a,model.cf));case 8:return _Utils_Tuple2("passageway",$author$project$Views$Station$Passageway$view);case 5:return _Utils_Tuple2("turnstile",A2($author$project$Views$Station$Turnstile$view,model.cf,line=scene.a));default:var line=scene.a.bI;return _Utils_Tuple2("train",$author$project$Views$Train$view({bi:1===scene.a.b6?$elm$core$Maybe$Just(currentStation):$elm$core$Maybe$Nothing,bI:line,cf:model.cf}))}var worldModel,items,interactableItemView,characters}(),_Utils_Tuple2("story",(_v1=_Utils_Tuple2($elm$core$List$head(model.b8),model.bU),_v1.a.$?_v1.b.$?$elm$html$Html$text(""):$author$project$Main$storyWrapperView((prompt=_v1.b.a,_Utils_Tuple2("prompt",A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("StoryLine__content")]),_List_fromArray([A2($elm$html$Html$textarea,_List_fromArray([$elm$html$Html$Attributes$id("player-prompt"),$elm$html$Html$Attributes$class("StoryLine__prompt"),(n=4,A2(_VirtualDom_attribute,"rows",$elm$core$String$fromInt(n))),$elm$html$Html$Attributes$placeholder("What do you want to say?"),$elm$html$Html$Attributes$value(prompt),$elm$html$Html$Events$onInput($author$project$LocalTypes$UpdatePrompt),A2($elm$html$Html$Events$preventDefaultOn,"keydown",A2($elm$json$Json$Decode$map,(function(k){return _Utils_Tuple2($author$project$LocalTypes$NoOp,13===k)}),$elm$html$Html$Events$keyCode))]),_List_Nil),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("StoryLine__actions")]),_List_fromArray([A2($elm$html$Html$span,_List_fromArray([$elm$html$Html$Attributes$class("StoryLine__action"),$elm$html$Html$Events$onClick($author$project$LocalTypes$SendPrompt)]),_List_fromArray([$elm$html$Html$text("Continue...")]))]))]))))):$author$project$Main$storyWrapperView(A3($author$project$Main$storyView,_v1.a.a,1===$elm$core$List$length(model.b8),!_Utils_eq(model.bx,$elm$core$Maybe$Nothing))))),_Utils_Tuple2("notebook",model.b2?$author$project$Main$notebookView(model):$elm$html$Html$text("")),_Utils_Tuple2("map",model.b1?(worldModel=model.cf,A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Events$onClick($author$project$LocalTypes$ToggleMap),$elm$html$Html$Attributes$class("map")]),_Utils_ap(_List_fromArray([A2($elm$html$Html$img,_List_fromArray([$elm$html$Html$Attributes$class("map__image"),$elm$html$Html$Attributes$src("img/subway-map-full.jpg")]),_List_Nil)]),A2($elm$core$List$map,(function(i){return A2($elm$html$Html$img,_List_fromArray([$elm$html$Html$Attributes$class("map__image"),$elm$html$Html$Attributes$src("img/map-passage-"+$elm$core$String$fromInt(i)+".png")]),_List_Nil)}),A2($elm$core$List$range,1,A2($elm$core$Maybe$withDefault,0,A3($jschomay$elm_narrative_engine$NarrativeEngine$Core$WorldModel$getStat,"PLAYER","mapLevel",worldModel))))))):$elm$html$Html$text(""))]))},$elm$html$Html$progress=_VirtualDom_node("progress"),$author$project$Main$selectSceneView=(skeleton=_List_fromArray(["LOBBY","CELL_PHONE","RED_LINE","RED_LINE","BROADWAY_STREET","LOBBY","CELL_PHONE","RED_LINE","RED_LINE","BROADWAY_STREET","LOBBY","CELL_PHONE","RED_LINE","RED_LINE","BROADWAY_STREET","LOBBY","CELL_PHONE","RED_LINE","RED_LINE","BROADWAY_STREET","LOBBY","CELL_PHONE","RED_LINE","RED_LINE","BROADWAY_STREET","LOBBY","MAP_POSTER","RED_LINE","RED_LINE","BROADWAY_STREET","LOBBY","SECURITY_OFFICERS","RED_LINE","SECURITY_OFFICERS","RED_LINE","RED_LINE","SPRING_HILL","LOBBY","SECURITY_DEPOT_SPRING_HILL_STATION","SKATER_DUDE","ORANGE_LINE","ORANGE_LINE","CAPITOL_HEIGHTS","MARK","ORANGE_LINE","ORANGE_LINE","SEVENTY_THIRD_STREET","TICKET_INSPECTOR","INFRACTIONS_GREEN_BUTTON","INFRACTIONS_ROOM_DOOR","GRIZZLED_SECURITY_GUARD","ORANGE_LINE","ORANGE_LINE","SEVENTY_THIRD_STREET","BROOM_CLOSET","PAYPHONE_SEVENTY_THIRD_STREET","ORANGE_LINE","ORANGE_LINE","SPRING_HILL","RED_LINE","RED_LINE","TWIN_BROOKS","MAN_IN_HOT_DOG_SUIT","RED_LINE","RED_LINE","SPRING_HILL","ORANGE_LINE","ORANGE_LINE","UNIVERSITY","FRANKS_FRANKS","MAN_IN_HOT_DOG_SUIT","ORANGE_LINE","ORANGE_LINE","SEVENTY_THIRD_STREET","PAYPHONE_SEVENTY_THIRD_STREET","MAINTENANCE_DOOR_SEVENTY_THIRD_STREET_TO_FORTY_SECOND_STREET","confront_repairman","BLUE_LINE"]),skip=function(i){return A2($elm$core$List$take,i,skeleton)},finalPlayThrough=_List_fromArray(["LOBBY","BRIEFCASE","CELL_PHONE","CELL_PHONE","RED_LINE_PASS","RED_LINE","RED_LINE","WEST_MULBERRY","CHURCH_STREET","WEST_MULBERRY","WEST_MULBERRY","LOBBY","COFFEE_CART","COFFEE","COFFEE","COFFEE_CART","LOUD_PAYPHONE_LADY","LOUD_PAYPHONE_LADY","SODA_MACHINE","SODA_MACHINE","COMMUTER_1","COMMUTER_1","COMMUTER_1","GRAFFITI_EAST_MULBERRY","GRAFFITI_EAST_MULBERRY","PURPLE_LINE","PURPLE_LINE","LOBBY","RED_LINE","RED_LINE","BROADWAY_STREET","LOBBY","COFFEE_CART","COFFEE","CELL_PHONE","GRAFFITI_EAST_MULBERRY","COFFEE_CART","TRASH_DIGGER","TRASH_DIGGER","SODA_MACHINE","PURPLE_LINE","PURPLE_LINE","LOBBY","RED_LINE","RED_LINE","TWIN_BROOKS","BROADWAY_STREET","LOBBY","SKATER_DUDE","COFFEE_CART","COFFEE","SODA_MACHINE","CELL_PHONE","COFFEE","PURPLE_LINE","PURPLE_LINE","LOBBY","RED_LINE","RED_LINE","CONVENTION_CENTER","BROADWAY_STREET","LOBBY","BENCH_BUM","BENCH_BUM","BENCH_BUM","BENCH_BUM","TRASH_DIGGER","COFFEE_CART","COFFEE_CART","COFFEE","COFFEE","GRAFFITI_EAST_MULBERRY","SODA_MACHINE","CELL_PHONE","RED_LINE","RED_LINE","BROADWAY_STREET","LOBBY","NOTEBOOK","NOTEBOOK","COFFEE_CART","COFFEE_CART","COFFEE_CART","COFFEE_CART","COFFEE_CART","SODA_MACHINE","GRAFFITI_EAST_MULBERRY","CELL_PHONE","SODA_MACHINE","SODA_MACHINE","SODA_MACHINE","BRIEFCASE","PURPLE_LINE","LOBBY","RED_LINE","RED_LINE","BROADWAY_STREET","RED_LINE","RED_LINE","WEST_MULBERRY","LOBBY","NOTEBOOK","MAINTENANCE_MAN","MAINTENANCE_MAN","MAP_POSTER","MAP","MAP","MAP","RED_LINE_PASS","RED_LINE","RED_LINE","BROADWAY_STREET","YELLOW_LINE","YELLOW_LINE","RED_LINE","NOTEBOOK","EXIT","EXIT","COMMUTER_1","COMMUTER_1","GIRL_IN_YELLOW","NOTEBOOK","EXIT","ANGRY_CROWD","ANGRY_CROWD","EXIT","SECURITY_OFFICERS","SECURITY_OFFICERS","ANGRY_CROWD","COMMUTER_1","NOTEBOOK","CELL_PHONE","YELLOW_LINE","SECURITY_OFFICERS","MAP","SECURITY_OFFICERS","SECURITY_OFFICERS","MAP","YELLOW_LINE","YELLOW_LINE","LOBBY","BLUE_LINE","BLUE_LINE","LOBBY","RED_LINE","RED_LINE","WEST_MULBERRY","BULLETIN_BOARD","BULLETIN_BOARD","BULLETIN_BOARD","BULLETIN_BOARD","SOGGY_JACKET","SOGGY_JACKET","DRINKING_FOUNTAIN","CELL_PHONE","BULLETIN_BOARD","TRASH_CAN_WEST_MULBERRY","RED_LINE","RED_LINE","EAST_MULBERRY","COFFEE_CART","SODA_MACHINE","PURPLE_LINE","PURPLE_LINE","LOBBY","RED_LINE","RED_LINE","CHURCH_STREET","MISSIONARIES","MISSIONARIES","SCHOOL_CHILDREN","SCHOOL_CHILDREN","WOMAN_IN_ODD_HAT","WOMAN_IN_ODD_HAT","MOTHER","NOTEBOOK","MOTHER","CHANGE","MOTHER","MOTHER","MOTHER","RED_LINE","RED_LINE","BROADWAY_STREET","CONVENTION_CENTER","BUSTLING_CROWD","MUSICIAN","MUSICIAN","musicians_change","CHANGE","MUSICIAN","MUSICIAN","MUSICIAN","musicians_change","CHANGE","MARCYS_PIZZA","MAN_IN_RATTY_HAT","NOTEBOOK","PURPLE_LINE","PURPLE_LINE","LOBBY","RED_LINE","RED_LINE","WEST_MULBERRY","BULLETIN_BOARD","RED_LINE","RED_LINE","EAST_MULBERRY","RED_LINE","RED_LINE","CHURCH_STREET","RED_LINE","RED_LINE","EAST_MULBERRY","SODA_MACHINE","SODA","SODA_MACHINE","RED_LINE","RED_LINE","TWIN_BROOKS","MAINTENANCE_MAN","MAP_POSTER","MAN_IN_RATTY_HAT","MAP_POSTER","RED_LINE","RED_LINE","EAST_MULBERRY","RED_LINE","RED_LINE","WEST_MULBERRY","RED_LINE","RED_LINE","SPRING_HILL","RED_LINE","RED_LINE","LOBBY","CUSTODIAN","CUSTODIAN","CUSTODIAN","CUSTODIAN","OVERTURNED_TRASHCAN","MISSING_DOG_POSTER_0","MISSING_DOG_POSTER_0","MISSING_DOG_POSTER_0","MISSING_DOG_POSTER_0","MISSING_DOG_POSTER_0","MISSING_DOG_POSTER_0","NEWSPAPER_VENDING_MACHINE","OVERTURNED_TRASHCAN","OVERTURNED_TRASHCAN","CUSTODIAN","NEWSPAPER_VENDING_MACHINE","SECURITY_DEPOT_SPRING_HILL_STATION","ORANGE_LINE","ORANGE_LINE","LOBBY","SODA","CHANGE","SKATER_DUDE","SKATER_DUDE","SKATER_DUDE","ORANGE_LINE","LOBBY","SKATER_DUDE","ORANGE_LINE","ORANGE_LINE","LOBBY","ORANGE_LINE","ORANGE_LINE","NORWOOD","CAPITOL_HEIGHTS","GREEN_SUIT_MAN","GREEN_SUIT_MAN","ORANGE_LINE","ORANGE_LINE","LOBBY","SHIFTY_MAN","SHIFTY_MAN","SHIFTY_MAN","GREEN_SUIT_MAN","TROPICAL_T_SHIRT_MAN","TROPICAL_T_SHIRT_MAN","TRASH_CAN_CAPITOL_HEIGHTS","ODD_KEY","ODD_KEY","SPIKY_HAIR_GUY","SPIKY_HAIR_GUY","SPIKY_HAIR_GUY","MARK","MARK","ORANGE_LINE","ORANGE_LINE","LOBBY","YELLOW_LINE","YELLOW_LINE","LOBBY","GREEN_LINE","GREEN_LINE","LOBBY","ORANGE_LINE","ORANGE_LINE","IRIS_LAKE","SODA","ODD_KEY","NOTEBOOK","MAP","CHANGE","TICKET_INSPECTOR","SODA","INFRACTIONS_INSTRUCTIONS_POSTER","INFRACTIONS_ROOM_DOOR","INFRACTIONS_COMPUTER","INFRACTIONS_CARD_READER","INFRACTIONS_COMPUTER","INFRACTIONS_CARD_READER","INFRACTIONS_COMPUTER","INFRACTIONS_ROOM_DOOR","INFRACTIONS_PRINTER","INFRACTIONS_PRINTER","INFRACTIONS_COMPUTER","INFRACTIONS_CARD_READER","INFRACTIONS_COMPUTER","INFRACTIONS_INSTRUCTIONS_POSTER","INFRACTIONS_ROOM_DOOR","SODA","GRIZZLED_SECURITY_GUARD","RED_LINE_PASS","CHANGE","SODA","MURAL","MURAL","BIRD","BIRD","CENTRAL_GUARD_OFFICE_ENTRANCE","COMMUTERS_ST_MARKS","BROKEN_PAYPHONE","BLUE_LINE","BLUE_LINE","LOBBY","ORANGE_LINE","ORANGE_LINE","IRIS_LAKE","GIRL_IN_YELLOW","NOTEBOOK","NOTEBOOK","CONCERT_POSTER","MAINTENANCE_DOOR_IRIS_LAKE_TO_WEST_MULBERRY","ODD_KEY","MAINTENANCE_DOOR_IRIS_LAKE_TO_WEST_MULBERRY","GRAFFITI_IRIS_LAKE","TRASHED_NEWSPAPERS","TRASHED_NEWSPAPERS","TRASHED_NEWSPAPERS","TRASHED_NEWSPAPERS","TRASHED_NEWSPAPERS","TRASHED_NEWSPAPERS","ORANGE_LINE","ORANGE_LINE","NORWOOD","LIVING_STATUE","CHANGE","LIVING_STATUE","CHANGE","OLD_LADIES","OLD_LADIES","OLD_LADIES","OLD_LADIES","TRASH_CAN_NORWOOD","MAN_IN_RATTY_HAT","NOTEBOOK","SLEEPING_MAN","CHANGE","SLEEPING_MAN","help_a_guy_out","CHANGE","SLEEPING_MAN","SLEEPING_MAN","SLEEPING_MAN","ORANGE_LINE","ORANGE_LINE","ST_MARKS","ORANGE_LINE","ORANGE_LINE","UNIVERSITY","FAKE_COP","FAKE_COP","SODA","ADVERTISEMENT","ADVERTISEMENT","MAGAZINE_STAND","MAGAZINE_STAND","MAGAZINE_STAND","MAGAZINE_STAND","MAGAZINE_STAND","SECRET_SERVICE_TYPE_GUY","SECRET_SERVICE_TYPE_GUY","SECRET_SERVICE_TYPE_GUY","FRANKS_FRANKS","FRANKS_FRANKS","ORANGE_LINE","ORANGE_LINE","SPRING_HILL","NEWSPAPER_VENDING_MACHINE","ORANGE_LINE","ORANGE_LINE","CAPITOL_HEIGHTS","MARK","TRASH_CAN_CAPITOL_HEIGHTS","ORANGE_LINE","ORANGE_LINE","SEVENTY_THIRD_STREET","DISTRESSED_WOMAN","MISSING_DOG_POSTER_5","PAYPHONE_SEVENTY_THIRD_STREET","ABANDONED_JACKET","ABANDONED_JACKET","TRASH_CAN_SEVENTY_THIRD_STREET","BUSINESS_MAN","BUSINESS_MAN","BROOM_CLOSET","PAYPHONE_SEVENTY_THIRD_STREET","CHANGE","SODA","ABANDONED_JACKET","BUSINESS_MAN","NOTEBOOK","ORANGE_LINE","ORANGE_LINE","ONE_HUNDRED_FORTH_STREET","MAINTENANCE_MAN","MAINTENANCE_MAN","FLUORESCENT_LIGHTS","FLUORESCENT_LIGHTS","FLUORESCENT_LIGHTS","FLUORESCENT_LIGHTS","VENDING_MACHINE","CHANGE","CONSTRUCTION_AREA","TRASH_CAN_ONE_HUNDRED_FOURTH_STREET","ORANGE_LINE","ORANGE_LINE","SPRING_HILL","MISSING_DOG_POSTER_0","MISSING_DOG_POSTER_5","RED_LINE","RED_LINE","TWIN_BROOKS","MISSING_DOG_POSTER_5","MISSING_DOG_POSTER_4","MISSING_DOG_POSTER_5","SAFETY_WARNING_POSTER","MAN_IN_HOT_DOG_SUIT","MASCOT_PAPERS","MASCOT_PAPERS","MAN_IN_HOT_DOG_SUIT","MAN_IN_HOT_DOG_SUIT","RED_LINE","RED_LINE","CONVENTION_CENTER","MISSING_DOG_POSTER_4","MUSICIAN","MUSICIAN","musicians_change","CHANGE","MARCYS_PIZZA","YELLOW_LINE","YELLOW_LINE","LOBBY","RED_LINE","RED_LINE","BROADWAY_STREET","CHURCH_STREET","RED_LINE","RED_LINE","EAST_MULBERRY","MISSING_DOG_POSTER_3","COFFEE_CART","RED_LINE","RED_LINE","WEST_MULBERRY","BULLETIN_BOARD","TRASH_CAN_WEST_MULBERRY","throw_away_mascot_papers","MISSING_DOG_POSTER_2","MISSING_DOG_POSTER_1","RED_LINE","RED_LINE","CHURCH_STREET","SODA","MISSING_DOG_POSTER_1","RED_LINE","RED_LINE","SPRING_HILL","ORANGE_LINE","ORANGE_LINE","LOBBY","RED_LINE","RED_LINE","TWIN_BROOKS","MAN_IN_HOT_DOG_SUIT","MAN_IN_HOT_DOG_SUIT","MAN_IN_HOT_DOG_SUIT","MAN_IN_HOT_DOG_SUIT","RED_LINE","RED_LINE","SPRING_HILL","ORANGE_LINE","ORANGE_LINE","SEVENTY_THIRD_STREET","TRASH_CAN_SEVENTY_THIRD_STREET","BROOM_CLOSET","BROOM_CLOSET","BROOM_CLOSET","BROOM_CLOSET","ODD_KEY","SODA","PAYPHONE_SEVENTY_THIRD_STREET","CHANGE","PAYPHONE_SEVENTY_THIRD_STREET","MAINTENANCE_DOOR_SEVENTY_THIRD_STREET_TO_FORTY_SECOND_STREET","MAINTENANCE_DOOR_FORTY_SECOND_STREET_TO_SEVENTY_THIRD_STREET","BLUE_LINE","BLUE_LINE","LOBBY","SECURITY_CAMERA_FORTY_SECOND_STREET","GRIZZLED_REPAIRMAN","confront_repairman","ELECTRIC_PANEL","BLUE_LINE","BLUE_LINE","just_do_it"]),chatper2=_List_fromArray(["ORANGE_LINE","ORANGE_LINE","SEVENTY_THIRD_STREET","BROOM_CLOSET","PAYPHONE_SEVENTY_THIRD_STREET","DISTRESSED_WOMAN","MISSING_DOG_POSTER_5","BUSINESS_MAN","ORANGE_LINE","ORANGE_LINE","SPRING_HILL","MISSING_DOG_POSTER_0","MISSING_DOG_POSTER_5","RED_LINE","RED_LINE","CONVENTION_CENTER","MISSING_DOG_POSTER_5","MISSING_DOG_POSTER_4","MISSING_DOG_POSTER_5","RED_LINE","RED_LINE","BROADWAY_STREET","CHURCH_STREET","MISSING_DOG_POSTER_4","MISSING_DOG_POSTER_4","RED_LINE","RED_LINE","EAST_MULBERRY","MISSING_DOG_POSTER_3","RED_LINE","RED_LINE","WEST_MULBERRY","MISSING_DOG_POSTER_2","RED_LINE","RED_LINE","TWIN_BROOKS","MISSING_DOG_POSTER_1","MISSING_DOG_POSTER_1","MAN_IN_HOT_DOG_SUIT","MASCOT_PAPERS","MAN_IN_HOT_DOG_SUIT","RED_LINE","RED_LINE","SPRING_HILL","ORANGE_LINE","ORANGE_LINE","UNIVERSITY","FRANKS_FRANKS","FRANKS_FRANKS","MAN_IN_HOT_DOG_SUIT","CHANGE","MAN_IN_HOT_DOG_SUIT","ORANGE_LINE","ORANGE_LINE","ST_MARKS","BROKEN_PAYPHONE","ORANGE_LINE","ORANGE_LINE","SEVENTY_THIRD_STREET","PAYPHONE_SEVENTY_THIRD_STREET","MAINTENANCE_DOOR_SEVENTY_THIRD_STREET_TO_FORTY_SECOND_STREET","MAINTENANCE_DOOR_FORTY_SECOND_STREET_TO_SEVENTY_THIRD_STREET","BLUE_LINE","BLUE_LINE","LOBBY","SECURITY_CAMERA_FORTY_SECOND_STREET","GRIZZLED_REPAIRMAN","confront_repairman","ELECTRIC_PANEL","BLUE_LINE"]),fullPlay=_Utils_ap(_List_fromArray(["LOBBY","BRIEFCASE","RED_LINE_PASS","RED_LINE_PASS","RED_LINE","CELL_PHONE","CELL_PHONE","CELL_PHONE","COFFEE_CART","COFFEE","COFFEE_CART","COMMUTER_1","COMMUTER_1","LOUD_PAYPHONE_LADY","COFFEE_CART","LOUD_PAYPHONE_LADY","GRAFFITI_EAST_MULBERRY","RED_LINE","RED_LINE","BROADWAY_STREET","LOBBY","RED_LINE_PASS","COFFEE_CART","COFFEE_CART","TRASH_DIGGER","TRASH_DIGGER","GRAFFITI_EAST_MULBERRY","COFFEE","CELL_PHONE","CELL_PHONE","RED_LINE","RED_LINE","CONVENTION_CENTER","BROADWAY_STREET","LOBBY","RED_LINE","SKATER_DUDE","COFFEE_CART","COFFEE_CART","COFFEE","CELL_PHONE","CELL_PHONE","COFFEE","RED_LINE","RED_LINE","BROADWAY_STREET","LOBBY","CELL_PHONE","COFFEE_CART","COFFEE_CART","COFFEE_CART","COFFEE","RED_LINE","RED_LINE","CHURCH_STREET","BROADWAY_STREET","LOBBY","CELL_PHONE","COFFEE_CART","RED_LINE","RED_LINE","LOBBY","RED_LINE","RED_LINE","BROADWAY_STREET","MAP_POSTER","MAP","SAFETY_WARNING_POSTER","CONVENTION_CENTER","BROADWAY_STREET","LOBBY","EXIT","ANGRY_CROWD","YELLOW_LINE","RED_LINE","COMMUTER_1","COMMUTER_1","GIRL_IN_YELLOW","NOTEBOOK","SECURITY_OFFICERS","RED_LINE","ANGRY_CROWD","COMMUTER_1","SECURITY_OFFICERS","RED_LINE","RED_LINE","SPRING_HILL","LOBBY","SECURITY_DEPOT_SPRING_HILL_STATION","RED_LINE","RED_LINE","CHURCH_STREET","MOTHER","MOTHER","RED_LINE","RED_LINE","EAST_MULBERRY","SODA_MACHINE","RED_LINE","RED_LINE","CHURCH_STREET","MOTHER","RED_LINE","RED_LINE","SPRING_HILL","SECURITY_DEPOT_SPRING_HILL_STATION","SKATER_DUDE","SKATER_DUDE","RED_LINE","ORANGE_LINE","ORANGE_LINE","UNIVERSITY","ST_MARKS","CAPITOL_HEIGHTS","GREEN_SUIT_MAN","SHIFTY_MAN","TRASH_CAN_CAPITOL_HEIGHTS","ODD_KEY","SPIKY_HAIR_GUY","MARK","MARK","YELLOW_LINE","YELLOW_LINE","LOBBY","ORANGE_LINE","ORANGE_LINE","SEVENTY_THIRD_STREET","TICKET_INSPECTOR","INFRACTIONS_INSTRUCTIONS_POSTER","INFRACTIONS_ROOM_DOOR","INFRACTIONS_PRINTER","INFRACTIONS_COMPUTER","INFRACTIONS_CARD_READER","INFRACTIONS_CARD_READER","INFRACTIONS_PRINTER","INFRACTIONS_COMPUTER","INFRACTIONS_CARD_READER","INFRACTIONS_COMPUTER","INFRACTIONS_PRINTER","INFRACTIONS_CARD_READER","INFRACTIONS_COMPUTER","INFRACTIONS_PRINTER","INFRACTIONS_ROOM_DOOR","GRIZZLED_SECURITY_GUARD","RED_LINE_PASS"]),chatper2),scenes=_List_fromArray([_Utils_Tuple2("(Full playthrough)",finalPlayThrough),_Utils_Tuple2("(Interact with everything)",fullPlay),_Utils_Tuple2("End",skip(79)),_Utils_Tuple2("Call boss",skip(75)),_Utils_Tuple2("Empty broom closet",skip(55)),_Utils_Tuple2("Recieved orange line pass",skip(51)),_Utils_Tuple2("Caught",skip(47)),_Utils_Tuple2("Orange line",skip(43)),_Utils_Tuple2("Run into skater dude again",skip(39)),_Utils_Tuple2("Briefcase stolen",skip(33)),_Utils_Tuple2("Arrive at Twin Brooks",skip(26)),_Utils_Tuple2("Friday",skip(20)),_Utils_Tuple2("Thursday",skip(15)),_Utils_Tuple2("Wednesday",skip(10)),_Utils_Tuple2("Tuesday",skip(5)),_Utils_Tuple2("Beginning",_List_Nil)]),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("SelectScene")]),_List_fromArray([A2($elm$html$Html$h1,_List_Nil,_List_fromArray([$elm$html$Html$text("Select a scene to jump to:")])),A2($elm$html$Html$ul,_List_Nil,A2($elm$core$List$map,(function(_v0){var k=_v0.a;return A2($elm$html$Html$li,_List_fromArray([$elm$html$Html$Events$onClick($author$project$LocalTypes$LoadScene(_v0.b))]),_List_fromArray([$elm$html$Html$text(k)]))}),scenes))]))),$author$project$LocalTypes$ToggleTranscript={$:15},$elm$json$Json$Encode$bool=_Json_wrap,$elm$html$Html$Attributes$readonly=F2((function(key,bool){return A2(_VirtualDom_property,key,$elm$json$Json$Encode$bool(bool))}))("readOnly"),$author$project$Main$transcriptView=function(model){return A2($elm$html$Html$div,_List_Nil,_List_fromArray([A2($elm$html$Html$div,_List_fromArray([A2($elm$html$Html$Attributes$style,"color","green"),A2($elm$html$Html$Attributes$style,"display","block"),A2($elm$html$Html$Attributes$style,"position","absolute"),A2($elm$html$Html$Attributes$style,"z-index","99"),A2($elm$html$Html$Attributes$style,"padding","2px"),A2($elm$html$Html$Attributes$style,"bottom","0"),A2($elm$html$Html$Attributes$style,"left","1em"),A2($elm$html$Html$Attributes$style,"cursor","pointer"),$elm$html$Html$Events$onClick($author$project$LocalTypes$ToggleTranscript)]),_List_fromArray([$elm$html$Html$text("transcript")])),model.b4?A2($elm$html$Html$textarea,_List_fromArray([A2($elm$html$Html$Attributes$style,"color","green"),A2($elm$html$Html$Attributes$style,"position","absolute"),A2($elm$html$Html$Attributes$style,"z-index","99"),A2($elm$html$Html$Attributes$style,"width","50%"),A2($elm$html$Html$Attributes$style,"height","70%"),A2($elm$html$Html$Attributes$style,"top","3em"),A2($elm$html$Html$Attributes$style,"left","1em"),$elm$html$Html$Attributes$readonly(!0)]),_List_fromArray([$elm$html$Html$text(A2($elm$core$String$join,"\n",model.cb))])):$elm$html$Html$text("")]))},$author$project$Main$view=function(model){return!model.bj||model.bJ?A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Scene train")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("loading-info")]),_List_fromArray([A2($elm$html$Html$p,_List_Nil,_List_fromArray([$elm$html$Html$text("Loading...")])),A2($elm$html$Html$progress,_List_fromArray([$elm$html$Html$Attributes$id("loading-progress"),$elm$html$Html$Attributes$value("0")]),_List_fromArray([$elm$html$Html$text("0")]))]))])):model.b3?$author$project$Main$selectSceneView:A2($elm$html$Html$div,_List_Nil,_List_fromArray([_Utils_eq(model.b0,$author$project$LocalTypes$MainTitle)?(story=A2($elm$core$Maybe$withDefault,"ERROR: No story to show",$elm$core$List$head(model.b8)),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Scene MainTitleScene")]),_List_fromArray([A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("MainTitleContent")]),_List_fromArray([A2($elm_explorations$markdown$Markdown$toHtml,_List_Nil,story),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("StoryLine__actions")]),_List_fromArray([A2($elm$html$Html$span,_List_fromArray([$elm$html$Html$Attributes$class("StoryLine__action"),$elm$html$Html$Events$onClick($author$project$LocalTypes$Continue)]),_List_fromArray([$elm$html$Html$text("Continue...")]))]))]))]))):$author$project$Main$mainView(model),A2($elm$html$Html$div,_List_fromArray([$elm$html$Html$Attributes$class("Debug"),A2($elm$html$Html$Events$stopPropagationOn,"keydown",$elm$json$Json$Decode$succeed(_Utils_Tuple2($author$project$LocalTypes$NoOp,!0)))]),_List_fromArray([A2($elm$core$Maybe$withDefault,$elm$html$Html$text(""),A2($elm$core$Maybe$map,A2($jschomay$elm_narrative_engine$NarrativeEngine$Debug$debugBar,$author$project$LocalTypes$DebugSeachWorldModel,model.cf),model.br))])),_Utils_eq(model.br,$elm$core$Maybe$Nothing)?$elm$html$Html$text(""):$author$project$Main$transcriptView(model)]));var story};!function(exports){scope.Elm?_Platform_mergeExportsProd(scope.Elm,exports):scope.Elm=exports}({Main:{init:$elm$browser$Browser$document({bF:$author$project$Main$init(A2($elm$core$Result$withDefault,$elm$core$Dict$empty,A2($elm$core$Result$map,$elm$core$Tuple$first,parsedData=A4($elm$core$Result$map3,F3((function(initialWorldModel,narrative,rules){return _Utils_Tuple2(initialWorldModel,rules)})),$author$project$Manifest$initialWorldModel,$author$project$NarrativeContent$parseAll,$author$project$Rules$rules)))),b9:$author$project$Main$subscriptions,cd:$author$project$Main$update(A2($elm$core$Result$withDefault,$elm$core$Dict$empty,A2($elm$core$Result$map,$elm$core$Tuple$second,parsedData))),ce:function(model){return parsedData.$?{aq:_List_fromArray([$jschomay$elm_narrative_engine$NarrativeEngine$Syntax$Helpers$parseErrorsView(parsedData.a)]),a9:"Errors found"}:{aq:_List_fromArray([$author$project$Main$view(model)]),a9:"Deadline"}}})(A2($elm$json$Json$Decode$andThen,(function(debug){return $elm$json$Json$Decode$succeed({Q:debug})}),A2($elm$json$Json$Decode$field,"debug",$elm$json$Json$Decode$bool)))(0)}})}(this)}).call(this,__webpack_require__(13))},function(module){var g;g=function(){return this}();try{g=g||Function("return this")()}catch(e){"object"==typeof window&&(g=window)}module.exports=g},function(module,exports,__webpack_require__){var map={"./gurad-office.jpg":15,"./icons/briefcase.svg":16,"./icons/cell_phone.svg":17,"./icons/change.svg":18,"./icons/chat.svg":19,"./icons/coffee.svg":20,"./icons/dollar_bill.svg":21,"./icons/enter.svg":22,"./icons/map.svg":23,"./icons/mascot_papers.svg":24,"./icons/missing_dog_poster.svg":25,"./icons/no_entry.svg":26,"./icons/notebook.svg":27,"./icons/odd_key.svg":28,"./icons/orange_line_pass.svg":29,"./icons/pass.svg":30,"./icons/soda.svg":31,"./map-passage-1.png":32,"./map-red-yellow-green.jpg":33,"./notebook.jpg":34,"./riding-train.jpg":35,"./subway-lobby.jpg":36,"./subway-map-full.jpg":37,"./subway-passageway.jpg":38,"./subway-turnstile.jpg":39,"./title.jpg":40,"./train.jpg":41};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=14},function(module){module.exports="../../img/gurad-office.jpg"},function(module){module.exports="../../img/briefcase.svg"},function(module){module.exports="../../img/cell_phone.svg"},function(module){module.exports="../../img/change.svg"},function(module){module.exports="../../img/chat.svg"},function(module){module.exports="../../img/coffee.svg"},function(module){module.exports="../../img/dollar_bill.svg"},function(module){module.exports="../../img/enter.svg"},function(module){module.exports="../../img/map.svg"},function(module){module.exports="../../img/mascot_papers.svg"},function(module){module.exports="../../img/missing_dog_poster.svg"},function(module){module.exports="../../img/no_entry.svg"},function(module){module.exports="../../img/notebook.svg"},function(module){module.exports="../../img/odd_key.svg"},function(module){module.exports="../../img/orange_line_pass.svg"},function(module){module.exports="../../img/pass.svg"},function(module){module.exports="../../img/soda.svg"},function(module){module.exports="../../img/map-passage-1.png"},function(module){module.exports="../../img/map-red-yellow-green.jpg"},function(module){module.exports="../../img/notebook.jpg"},function(module){module.exports="../../img/riding-train.jpg"},function(module){module.exports="../../img/subway-lobby.jpg"},function(module){module.exports="../../img/subway-map-full.jpg"},function(module){module.exports="../../img/subway-passageway.jpg"},function(module){module.exports="../../img/subway-turnstile.jpg"},function(module){module.exports="../../img/title.jpg"},function(module){module.exports="../../img/train.jpg"},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);for(var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i=0;64>i;i++)lookup[chars.charCodeAt(i)]=i;var ConnectionState,decode=function(base64){var i,encoded1,encoded2,encoded3,encoded4,bufferLength=.75*base64.length,len=base64.length,p=0;"="===base64[base64.length-1]&&(bufferLength--,"="===base64[base64.length-2]&&bufferLength--);var arraybuffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(arraybuffer);for(i=0;len>i;i+=4)encoded1=lookup[base64.charCodeAt(i)],encoded2=lookup[base64.charCodeAt(i+1)],encoded3=lookup[base64.charCodeAt(i+2)],encoded4=lookup[base64.charCodeAt(i+3)],bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(15&encoded2)<<4|encoded3>>2,bytes[p++]=(3&encoded3)<<6|63&encoded4;return arraybuffer},__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&t[3]>op[1])){_.label=op[1];break}if(6===op[0]&&t[1]>_.label){_.label=t[1],t=op;break}if(t&&t[2]>_.label){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},__spreadArray=function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;l>i;i++)!ar&&i in from||(ar||(ar=Array.prototype.slice.call(from,0,i)),ar[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},phonemeCallback=null,phonemeListener_execute=function(phonemeData){null==phonemeCallback||phonemeCallback(phonemeData)},grpc_audio_playback_GrpcAudioPlayback=function(){function GrpcAudioPlayback(props){var _this=this;this.audioQueue=[],this.isPlaying=!1,this.playbackAudioContext=new AudioContext({sampleRate:16e3}),this.destinationNode=this.playbackAudioContext.createMediaStreamDestination(),this.playQueue=function(){return __awaiter(_this,void 0,void 0,(function(){var audioBuffer,packet,_a,_b,_c,_d;return __generator(this,(function(_e){switch(_e.label){case 0:return this.audioQueue.length?(this.currentItem=this.audioQueue.shift(),this.isPlaying=!0,(null==(packet=(this.currentItem||{}).packet)?void 0:packet.isSilence())&&packet.silence.durationMs?(audioBuffer=this.playbackAudioContext.createBuffer(2,this.playbackAudioContext.sampleRate*(packet.silence.durationMs/1e3),this.playbackAudioContext.sampleRate),[3,3]):[3,1]):(this.getSourceNode().buffer=null,this.isPlaying=!1,null===(_a=this.onStopPlaying)||void 0===_a||_a.call(this),[2]);case 1:return[4,this.playbackAudioContext.decodeAudioData(decode(packet.audio.chunk))];case 2:audioBuffer=_e.sent(),_e.label=3;case 3:return this.stop(),this.getSourceNode().buffer=audioBuffer,packet.isAudio()&&packet.audio.additionalPhonemeInfo&&phonemeListener_execute(packet.audio.additionalPhonemeInfo),this.getSourceNode().start(),null===(_b=this.onBeforePlaying)||void 0===_b||_b.call(this,packet),null===(_d=(_c=this.currentItem).onBeforePlaying)||void 0===_d||_d.call(_c,packet),[2]}}))}))},this.onAfterPlaying=null==props?void 0:props.onAfterPlaying,this.onBeforePlaying=null==props?void 0:props.onBeforePlaying,this.onStopPlaying=null==props?void 0:props.onStopPlaying}return GrpcAudioPlayback.prototype.getIsActive=function(){return this.isPlaying},GrpcAudioPlayback.prototype.addToQueue=function(item){this.audioQueue.push(item),this.isPlaying||this.playQueue()},GrpcAudioPlayback.prototype.clearQueue=function(){this.isPlaying=!1,this.audioQueue=[]},GrpcAudioPlayback.prototype.excludeCurrentInteractionPackets=function(exceptInteractionId){var _this=this,toExlcude=this.audioQueue.filter((function(item){var _a,_b;return item.packet.packetId.interactionId!==exceptInteractionId&&item.packet.packetId.interactionId===(null===(_b=null===(_a=_this.currentItem)||void 0===_a?void 0:_a.packet)||void 0===_b?void 0:_b.packetId.interactionId)}));toExlcude.length&&(this.audioQueue=this.audioQueue.filter((function(item){var _a,_b;return item.packet.packetId.interactionId!==(null===(_b=null===(_a=_this.currentItem)||void 0===_a?void 0:_a.packet)||void 0===_b?void 0:_b.packetId.interactionId)})));var result=__spreadArray([],toExlcude,!0);return this.currentItem&&this.currentItem.packet.packetId.interactionId!==exceptInteractionId&&result.unshift(this.currentItem),result.map((function(item){return item.packet}))},GrpcAudioPlayback.prototype.hasPacketInQueue=function(props){var interactionId=props.interactionId,utteranceId=props.utteranceId;return!!this.audioQueue.find((function(item){var result=!0,packetId=item.packet.packetId;return interactionId&&packetId.interactionId!==interactionId&&(result=!1),utteranceId&&packetId.utteranceId!==utteranceId&&(result=!1),result}))},GrpcAudioPlayback.prototype.isCurrentPacket=function(props){var _a,interactionId=props.interactionId,utteranceId=props.utteranceId,packetId=((null===(_a=this.currentItem)||void 0===_a?void 0:_a.packet)||{}).packetId,result=!0;return interactionId&&(null==packetId?void 0:packetId.interactionId)!==interactionId&&(result=!1),utteranceId&&packetId.utteranceId!==utteranceId&&(result=!1),result},GrpcAudioPlayback.prototype.getPlaybackStream=function(){return this.destinationNode.stream},GrpcAudioPlayback.prototype.stop=function(){this.getSourceNode().disconnect(),delete this.audioBufferSourceNode},GrpcAudioPlayback.prototype.init=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,this.playbackAudioContext.resume().catch(console.error)];case 1:return _a.sent(),[2]}}))}))},GrpcAudioPlayback.prototype.getSourceNode=function(){var _this=this;return this.audioBufferSourceNode||(this.audioBufferSourceNode=new AudioBufferSourceNode(this.playbackAudioContext),this.audioBufferSourceNode.connect(this.destinationNode),this.audioBufferSourceNode.onended=function(){var _a,_b,_c;null===(_a=_this.onAfterPlaying)||void 0===_a||_a.call(_this,_this.currentItem.packet),null===(_c=(_b=_this.currentItem).onAfterPlaying)||void 0===_c||_c.call(_b,_this.currentItem.packet),_this.currentItem=void 0,_this.playQueue()}),this.audioBufferSourceNode},GrpcAudioPlayback}(),grpc_audio_recorder_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},grpc_audio_recorder_generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&t[3]>op[1])){_.label=op[1];break}if(6===op[0]&&t[1]>_.label){_.label=t[1],t=op;break}if(t&&t[2]>_.label){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},GrpcAudioRecorder=function(){function GrpcAudioRecorder(){var _this=this;this.currentMediaStream=null,this.processor=null,this.leftChannel=[],this.recordingLength=0,this.interval=null,this.listener=null,this.onAudioProcess=function(e){var samples=e.inputBuffer.getChannelData(0);_this.leftChannel.push(new Float32Array(samples)),_this.recordingLength+=GrpcAudioRecorder.BUFFER_SIZE_BYTES},this.intervalFunction=function(){var PCM32fSamples=_this.mergeBuffers(_this.leftChannel,_this.recordingLength);_this.leftChannel=[],_this.recordingLength=0;var PCM16iSamples=Int16Array.from(PCM32fSamples,(function(k){return 32767*Math.min(1,k)}));_this.listener&&_this.listener(_this.arrayBufferToBase64(PCM16iSamples.buffer))}}return GrpcAudioRecorder.prototype.stopConvertion=function(){var _a;this.currentMediaStream&&(this.currentMediaStream.getTracks().forEach((function(track){return track.stop()})),this.interval&&clearInterval(this.interval),null===(_a=this.processor)||void 0===_a||_a.disconnect(),this.leftChannel=[],this.recordingLength=0,this.interval=null)},GrpcAudioRecorder.prototype.isRecording=function(){return null!=this.interval},GrpcAudioRecorder.prototype.startConvertion=function(stream,listener){return grpc_audio_recorder_awaiter(this,void 0,void 0,(function(){var context,source;return grpc_audio_recorder_generator(this,(function(){return this.listener=listener,context=new AudioContext({sampleRate:GrpcAudioRecorder.SAMPLE_RATE_HZ}),source=context.createMediaStreamSource(stream),this.currentMediaStream=stream,this.processor=context.createScriptProcessor(GrpcAudioRecorder.BUFFER_SIZE_BYTES,1,1),source.connect(this.processor),this.processor.connect(context.destination),this.processor.onaudioprocess=this.onAudioProcess,this.interval=setInterval(this.intervalFunction,GrpcAudioRecorder.INTERVAL_TIMEOUT_MS),[2]}))}))},GrpcAudioRecorder.prototype.mergeBuffers=function(channelBuffer,recordingLength){for(var result=new Float32Array(recordingLength),offset=0,i=0;channelBuffer.length>i;i++)result.set(channelBuffer[i],offset),offset+=channelBuffer[i].length;return Array.prototype.slice.call(result)},GrpcAudioRecorder.prototype.arrayBufferToBase64=function(buffer){for(var binary="",bytes=new Uint8Array(buffer),length=bytes.byteLength,i=0;length>i;i++)binary+=String.fromCharCode(bytes[i]);return window.btoa(binary)},GrpcAudioRecorder.SAMPLE_RATE_HZ=16e3,GrpcAudioRecorder.BUFFER_SIZE_BYTES=2048,GrpcAudioRecorder.INTERVAL_TIMEOUT_MS=200,GrpcAudioRecorder}(),grpc_web_rtc_loopback_bidi_session_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},grpc_web_rtc_loopback_bidi_session_generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&t[3]>op[1])){_.label=op[1];break}if(6===op[0]&&t[1]>_.label){_.label=t[1],t=op;break}if(t&&t[2]>_.label){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},GrpcWebRtcLoopbackBiDiSession=function(){function GrpcWebRtcLoopbackBiDiSession(){}return GrpcWebRtcLoopbackBiDiSession.prototype.startSession=function(inputStream,outputStream){return grpc_web_rtc_loopback_bidi_session_awaiter(this,void 0,void 0,(function(){var offer,answer,_this=this;return grpc_web_rtc_loopback_bidi_session_generator(this,(function(_a){switch(_a.label){case 0:return this.loopbackRecordStream=new MediaStream,this.loopbackPlaybackStream=new MediaStream,this.rtcServerConnection=new RTCPeerConnection,this.rtcClientConnection=new RTCPeerConnection,this.rtcServerConnection.onicecandidate=function(e){e.candidate&&_this.rtcClientConnection&&_this.rtcClientConnection.addIceCandidate(new RTCIceCandidate(e.candidate))},this.rtcClientConnection.onicecandidate=function(e){e.candidate&&_this.rtcServerConnection&&_this.rtcServerConnection.addIceCandidate(new RTCIceCandidate(e.candidate))},this.rtcClientConnection.ontrack=function(e){var _a;null===(_a=_this.loopbackPlaybackStream)||void 0===_a||_a.addTrack(e.track)},this.rtcServerConnection.ontrack=function(e){var _a;null===(_a=_this.loopbackRecordStream)||void 0===_a||_a.addTrack(e.track)},inputStream.getTracks().forEach((function(track){var _a;null===(_a=_this.rtcClientConnection)||void 0===_a||_a.addTrack(track)})),outputStream.getTracks().forEach((function(track){var _a;null===(_a=_this.rtcServerConnection)||void 0===_a||_a.addTrack(track)})),[4,this.rtcServerConnection.createOffer(GrpcWebRtcLoopbackBiDiSession.OFFER_OPTIONS)];case 1:return offer=_a.sent(),[4,this.rtcServerConnection.setLocalDescription(offer)];case 2:return _a.sent(),[4,this.rtcClientConnection.setRemoteDescription(offer)];case 3:return _a.sent(),[4,this.rtcClientConnection.createAnswer()];case 4:return answer=_a.sent(),[4,this.rtcClientConnection.setLocalDescription(answer)];case 5:return _a.sent(),[4,this.rtcServerConnection.setRemoteDescription(answer)];case 6:return _a.sent(),[2,this]}}))}))},GrpcWebRtcLoopbackBiDiSession.prototype.getRecorderLoopBackStream=function(){if(!this.loopbackRecordStream)throw Error("No loopbackRecordStream available");return this.loopbackRecordStream},GrpcWebRtcLoopbackBiDiSession.prototype.getPlaybackLoopbackStream=function(){if(!this.loopbackPlaybackStream)throw Error("No loopbackPlaybackStream available");return this.loopbackPlaybackStream},GrpcWebRtcLoopbackBiDiSession.OFFER_OPTIONS={offerVideo:!1,offerAudio:!0,offerToReceiveVideo:!1,offerToReceiveAudio:!0},GrpcWebRtcLoopbackBiDiSession}();!function(ConnectionState){ConnectionState.ACTIVE="ACTIVE",ConnectionState.ACTIVATING="ACTIVATING",ConnectionState.LOADED="LOADED",ConnectionState.LOADING="LOADING",ConnectionState.INACTIVE="INACTIVE"}(ConnectionState||(ConnectionState={}));var esm_browser_native={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const byteToHex=[];for(let i=0;256>i;++i)byteToHex.push((i+256).toString(16).slice(1));function unsafeStringify(arr,offset=0){return(byteToHex[arr[offset+0]]+byteToHex[arr[offset+1]]+byteToHex[arr[offset+2]]+byteToHex[arr[offset+3]]+"-"+byteToHex[arr[offset+4]]+byteToHex[arr[offset+5]]+"-"+byteToHex[arr[offset+6]]+byteToHex[arr[offset+7]]+"-"+byteToHex[arr[offset+8]]+byteToHex[arr[offset+9]]+"-"+byteToHex[arr[offset+10]]+byteToHex[arr[offset+11]]+byteToHex[arr[offset+12]]+byteToHex[arr[offset+13]]+byteToHex[arr[offset+14]]+byteToHex[arr[offset+15]]).toLowerCase()}var CHAT_HISTORY_TYPE,esm_browser_v4=function(options,buf,offset){if(esm_browser_native.randomUUID&&!buf&&!options)return esm_browser_native.randomUUID();const rnds=(options=options||{}).random||(options.rng||rng)();if(rnds[6]=15&rnds[6]|64,rnds[8]=63&rnds[8]|128,buf){offset=offset||0;for(let i=0;16>i;++i)buf[offset+i]=rnds[i];return buf}return unsafeStringify(rnds)},__assign=function(){return __assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;n>i;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},__assign.apply(this,arguments)},history_spreadArray=function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;l>i;i++)!ar&&i in from||(ar||(ar=Array.prototype.slice.call(from,0,i)),ar[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))};!function(CHAT_HISTORY_TYPE){CHAT_HISTORY_TYPE.ACTOR="actor",CHAT_HISTORY_TYPE.TRIGGER_EVENT="trigger_event",CHAT_HISTORY_TYPE.INTERACTION_END="interaction_end"}(CHAT_HISTORY_TYPE||(CHAT_HISTORY_TYPE={}));var Playback,ActorType,TextEventSourceType,ControlEventAction,GestureEventType,EmotionEventSpaffCode,EmotionEventStrength,DataChunkDataType,history_InworldHistory=function(){function InworldHistory(){this.history=[],this.queue=[]}return InworldHistory.prototype.addOrUpdate=function(_a){var _b,_c,_d,_e,_f,_g,_h,_j,chatItem,characters=_a.characters,grpcAudioPlayer=_a.grpcAudioPlayer,packet=_a.packet,outgoing=_a.outgoing,utteranceId=null===(_b=packet.packetId)||void 0===_b?void 0:_b.utteranceId,interactionId=null===(_c=packet.packetId)||void 0===_c?void 0:_c.interactionId;if(packet.isText()){var id_1=(null===(_e=null===(_d=packet.routing)||void 0===_d?void 0:_d.source)||void 0===_e?void 0:_e.isCharacter)?null===(_g=null===(_f=packet.routing)||void 0===_f?void 0:_f.source)||void 0===_g?void 0:_g.name:null===(_j=null===(_h=packet.routing)||void 0===_h?void 0:_h.target)||void 0===_j?void 0:_j.name,character=characters.find((function(x){return x.getId()===id_1})),actorItem=__assign(__assign({},this.combineTextItem(packet)),{character:character});grpcAudioPlayer.hasPacketInQueue({utteranceId:utteranceId})?this.queue=history_spreadArray(history_spreadArray([],this.queue,!0),[actorItem],!1):chatItem=actorItem}else if(packet.isTrigger())chatItem=this.combineTriggerItem(packet,outgoing);else if(packet.isInteractionEnd()){var controlItem=this.combineInteractionEndItem(packet);grpcAudioPlayer.hasPacketInQueue({interactionId:interactionId})?this.queue=history_spreadArray(history_spreadArray([],this.queue,!0),[controlItem],!1):chatItem=controlItem}if(chatItem){var currentHistoryIndex=this.history.findIndex((function(item){return item.id===(null==chatItem?void 0:chatItem.id)}));currentHistoryIndex>=0&&chatItem?this.history[currentHistoryIndex]=chatItem:this.history=history_spreadArray(history_spreadArray([],this.history,!0),[chatItem],!1)}return!!chatItem},InworldHistory.prototype.update=function(packet){if(packet.isText()){var currentHistoryIndex=this.history.findIndex((function(item){var _a;return item.id===(null===(_a=packet.packetId)||void 0===_a?void 0:_a.utteranceId)}));if(currentHistoryIndex>=0)return this.history[currentHistoryIndex]=__assign(__assign({},this.history[currentHistoryIndex]),this.combineTextItem(packet)),!0}return!1},InworldHistory.prototype.display=function(packet,type){switch(type){case CHAT_HISTORY_TYPE.ACTOR:var foundActor_1=this.queue.find((function(item){return item.type===CHAT_HISTORY_TYPE.ACTOR&&item.id===packet.packetId.utteranceId}));return foundActor_1&&(this.history=history_spreadArray(history_spreadArray([],this.history,!0),[foundActor_1],!1),this.queue=history_spreadArray([],this.queue,!0).filter((function(item){return item.id!==foundActor_1.id}))),foundActor_1;case CHAT_HISTORY_TYPE.INTERACTION_END:var inCurrentInteraction_1=this.queue.filter((function(item){return item.interactionId===packet.packetId.interactionId})),onlyInteractionEnd=1===inCurrentInteraction_1.length&&inCurrentInteraction_1[0].type===CHAT_HISTORY_TYPE.INTERACTION_END;return onlyInteractionEnd&&(this.history=history_spreadArray(history_spreadArray([],this.history,!0),[inCurrentInteraction_1[0]],!1),this.queue=history_spreadArray([],this.queue,!0).filter((function(item){return item.id!==inCurrentInteraction_1[0].id}))),onlyInteractionEnd}},InworldHistory.prototype.get=function(){return this.history},InworldHistory.prototype.filter=function(props){var interactionId=props.interactionId,utteranceId=props.utteranceId;this.history=this.history.filter((function(item){return!utteranceId.includes(item.id)})),this.queue=this.queue.filter((function(item){return item.interactionId!==interactionId&&!utteranceId.includes(item.id)}))},InworldHistory.prototype.clear=function(){this.queue=[],this.history=[]},InworldHistory.prototype.combineTextItem=function(packet){var _a,_b,_c,source=null===(_a=packet.routing)||void 0===_a?void 0:_a.source,utteranceId=null===(_b=packet.packetId)||void 0===_b?void 0:_b.utteranceId,interactionId=null===(_c=packet.packetId)||void 0===_c?void 0:_c.interactionId;return{id:utteranceId,isRecognizing:!packet.text.final,type:CHAT_HISTORY_TYPE.ACTOR,text:packet.text.text,date:new Date(packet.date),interactionId:interactionId,source:source}},InworldHistory.prototype.combineTriggerItem=function(packet,outgoing){var _a,_b,_c,source=null===(_a=packet.routing)||void 0===_a?void 0:_a.source,utteranceId=null===(_b=packet.packetId)||void 0===_b?void 0:_b.utteranceId,interactionId=null===(_c=packet.packetId)||void 0===_c?void 0:_c.interactionId;return{id:utteranceId,type:CHAT_HISTORY_TYPE.TRIGGER_EVENT,name:packet.trigger.name,date:new Date(packet.date),interactionId:interactionId,outgoing:outgoing,source:source}},InworldHistory.prototype.combineInteractionEndItem=function(packet){var _a,date=new Date(packet.date),interactionId=null===(_a=packet.packetId)||void 0===_a?void 0:_a.interactionId;return{id:esm_browser_v4(),date:date,interactionId:interactionId,type:CHAT_HISTORY_TYPE.INTERACTION_END}},InworldHistory}(),Player=function(){function Player(){this.mediaStream=new MediaStream,this.audioElement=document.createElement("audio"),this.mediaStream=new MediaStream,document.body.append(this.audioElement)}return Player.getInstance=function(){return this.instance||(this.instance=new Player),Player.instance},Player.prototype.setMute=function(mute){this.audioElement&&(this.audioElement.muted=mute)},Player.prototype.getMute=function(){return!!this.audioElement&&this.audioElement.muted},Player.prototype.setStream=function(stream){this.mediaStream=stream,this.audioElement.srcObject=stream,this.audioElement.autoplay=!0,this.audioElement.play()},Player.prototype.setTrack=function(track){this.audioElement.srcObject||(this.audioElement.srcObject=this.mediaStream),this.mediaStream.addTrack(track),this.audioElement.autoplay=!0},Player.prototype.playWorkaroundSound=function(){this.audioElement.play()},Player}(),web_socket_connection_assign=function(){return web_socket_connection_assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;n>i;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},web_socket_connection_assign.apply(this,arguments)},web_socket_connection_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},web_socket_connection_generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&t[3]>op[1])){_.label=op[1];break}if(6===op[0]&&t[1]>_.label){_.label=t[1],t=op;break}if(t&&t[2]>_.label){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},WebSocketConnection=function(){function WebSocketConnection(props){this.packetQueue=[],this.connectionProps=props}return WebSocketConnection.prototype.isActive=function(){var _a;return(null===(_a=this.ws)||void 0===_a?void 0:_a.readyState)===WebSocket.OPEN},WebSocketConnection.prototype.open=function(_a){var session=_a.session;return web_socket_connection_awaiter(this,void 0,void 0,(function(){var _b,onMessage,onReady;return web_socket_connection_generator(this,(function(){return onMessage=(_b=this.connectionProps).onMessage,this.ws=this.createWebSocket(web_socket_connection_assign(web_socket_connection_assign({config:_b.config,session:session,onError:_b.onError,onDisconnect:_b.onDisconnect},(onReady=_b.onReady)&&{onReady:onReady}),onMessage&&{onMessage:onMessage})),[2]}))}))},WebSocketConnection.prototype.close=function(){var _a,_b,_c,_d,_e,_f,_g;this.connectionProps.onReady&&(null===(_a=this.ws)||void 0===_a||_a.removeEventListener("open",this.onReady)),this.connectionProps.onError&&(null===(_b=this.ws)||void 0===_b||_b.removeEventListener("error",this.connectionProps.onError)),this.connectionProps.onDisconnect&&(null===(_c=this.ws)||void 0===_c||_c.removeEventListener("close",this.connectionProps.onDisconnect)),null===(_d=this.ws)||void 0===_d||_d.removeEventListener("message",this.onMessage),this.isActive()&&(null===(_e=this.ws)||void 0===_e||_e.close(),null===(_g=(_f=this.connectionProps).onDisconnect)||void 0===_g||_g.call(_f)),this.ws=null},WebSocketConnection.prototype.write=function(item){var _a,_b;if(this.isActive()){var packet=item.getPacket();null===(_a=this.ws)||void 0===_a||_a.send(JSON.stringify(packet)),null===(_b=item.afterWriting)||void 0===_b||_b.call(item,packet)}else this.packetQueue.push(item)},WebSocketConnection.prototype.createWebSocket=function(props){var session=props.session,onDisconnect=props.onDisconnect,onError=props.onError,_a=props.config.connection.gateway,hostname=_a.hostname,url="".concat(_a.ssl?"wss":"ws","://").concat(hostname).concat("/v1/session/default","?session_id=").concat(session.sessionId),ws=new WebSocket(url,[session.type,session.token]);return ws.addEventListener("open",this.onReady.bind(this)),ws.addEventListener("message",this.onMessage.bind(this)),onDisconnect&&ws.addEventListener("close",onDisconnect),onError&&ws.addEventListener("error",onError),ws},WebSocketConnection.prototype.onMessage=function(event){var _a=this.connectionProps,onError=_a.onError,onMessage=_a.onMessage,payload=JSON.parse(event.data);payload.error&&onError&&onError(payload.error),!payload.error&&onMessage&&onMessage(payload.result)},WebSocketConnection.prototype.onReady=function(){var _this=this;setTimeout((function(){_this.packetQueue.forEach((function(item){return _this.write(item)})),_this.packetQueue=[],_this.connectionProps.onReady&&_this.connectionProps.onReady()}),0)},WebSocketConnection}(),Character=function(){function Character(props){this.id=props.id,this.resourceName=props.resourceName,this.displayName=props.displayName,this.assets=props.assets}return Character.prototype.getId=function(){return this.id},Character.prototype.getResourceName=function(){return this.resourceName},Character.prototype.getDisplayName=function(){return this.displayName},Character.prototype.getAssets=function(){return this.assets},Character}();!function(Playback){Playback.UNSPECIFIED="UNSPECIFIED",Playback.INTERACTION="INTERACTION",Playback.INTERACTION_END="INTERACTION_END",Playback.UTTERANCE="UTTERANCE"}(Playback||(Playback={})),function(ActorType){ActorType.UNKNOWN="UNKNOWN",ActorType.PLAYER="PLAYER",ActorType.AGENT="AGENT"}(ActorType||(ActorType={})),function(TextEventSourceType){TextEventSourceType.UNKNOWN="UNKNOWN",TextEventSourceType.SPEECH_TO_TEXT="SPEECH_TO_TEXT",TextEventSourceType.TYPED_IN="TYPED_IN",TextEventSourceType.GENERATED="GENERATED",TextEventSourceType.FILLER="FILLER"}(TextEventSourceType||(TextEventSourceType={})),function(ControlEventAction){ControlEventAction.UNKNOWN="UNKNOWN",ControlEventAction.AUDIO_SESSION_START="AUDIO_SESSION_START",ControlEventAction.AUDIO_SESSION_END="AUDIO_SESSION_END",ControlEventAction.INTERACTION_END="INTERACTION_END",ControlEventAction.TTS_PLAYBACK_START="TTS_PLAYBACK_START",ControlEventAction.TTS_PLAYBACK_END="TTS_PLAYBACK_END",ControlEventAction.TTS_PLAYBACK_MUTE="TTS_PLAYBACK_MUTE",ControlEventAction.TTS_PLAYBACK_UNMUTE="TTS_PLAYBACK_UNMUTE",ControlEventAction.WARNING="WARNING",ControlEventAction.SESSION_END="SESSION_END"}(ControlEventAction||(ControlEventAction={})),function(GestureEventType){GestureEventType.GREETING="GREETING",GestureEventType.FAREWELL="FAREWELL",GestureEventType.AGREEMENT="AGREEMENT",GestureEventType.DISAGREEMENT="DISAGREEMENT",GestureEventType.GRATITUDE="GRATITUDE",GestureEventType.CELEBRATION="CELEBRATION",GestureEventType.BOREDOM="BOREDOM",GestureEventType.UNCERTAINTY="UNCERTAINTY"}(GestureEventType||(GestureEventType={})),function(EmotionEventSpaffCode){EmotionEventSpaffCode.NEUTRAL="NEUTRAL",EmotionEventSpaffCode.DISGUST="DISGUST",EmotionEventSpaffCode.CONTEMPT="CONTEMPT",EmotionEventSpaffCode.BELLIGERENCE="BELLIGERENCE",EmotionEventSpaffCode.DOMINEERING="DOMINEERING",EmotionEventSpaffCode.CRITICISM="CRITICISM",EmotionEventSpaffCode.ANGER="ANGER",EmotionEventSpaffCode.TENSION="TENSION",EmotionEventSpaffCode.TENSE_HUMOR="TENSE_HUMOR",EmotionEventSpaffCode.DEFENSIVENESS="DEFENSIVENESS",EmotionEventSpaffCode.WHINING="WHINING",EmotionEventSpaffCode.SADNESS="SADNESS",EmotionEventSpaffCode.STONEWALLING="STONEWALLING",EmotionEventSpaffCode.INTEREST="INTEREST",EmotionEventSpaffCode.VALIDATION="VALIDATION",EmotionEventSpaffCode.AFFECTION="AFFECTION",EmotionEventSpaffCode.HUMOR="HUMOR",EmotionEventSpaffCode.SURPRISE="SURPRISE",EmotionEventSpaffCode.JOY="JOY"}(EmotionEventSpaffCode||(EmotionEventSpaffCode={})),function(EmotionEventStrength){EmotionEventStrength.UNSPECIFIED="UNSPECIFIED",EmotionEventStrength.WEAK="WEAK",EmotionEventStrength.STRONG="STRONG",EmotionEventStrength.NORMAL="NORMAL"}(EmotionEventStrength||(EmotionEventStrength={})),function(DataChunkDataType){DataChunkDataType.UNSPECIFIED="UNSPECIFIED",DataChunkDataType.AUDIO="AUDIO",DataChunkDataType.ANIMATION="ANIMATION",DataChunkDataType.SILENCE="SILENCE",DataChunkDataType.STATE="STATE"}(DataChunkDataType||(DataChunkDataType={}));var InworldPacketType,InworlControlType,emotion_behavior_entity_EmotionBehavior=function(){function EmotionBehavior(behavior){this.behavior=behavior}return EmotionBehavior.prototype.isNeutral=function(){return this.behavior===EmotionEventSpaffCode.NEUTRAL},EmotionBehavior.prototype.isDisgust=function(){return this.behavior===EmotionEventSpaffCode.DISGUST},EmotionBehavior.prototype.isContempt=function(){return this.behavior===EmotionEventSpaffCode.CONTEMPT},EmotionBehavior.prototype.isBelligerence=function(){return this.behavior===EmotionEventSpaffCode.BELLIGERENCE},EmotionBehavior.prototype.isDomineering=function(){return this.behavior===EmotionEventSpaffCode.DOMINEERING},EmotionBehavior.prototype.isCriticism=function(){return this.behavior===EmotionEventSpaffCode.CRITICISM},EmotionBehavior.prototype.isAnger=function(){return this.behavior===EmotionEventSpaffCode.ANGER},EmotionBehavior.prototype.isTension=function(){return this.behavior===EmotionEventSpaffCode.TENSION},EmotionBehavior.prototype.isTenseHumor=function(){return this.behavior===EmotionEventSpaffCode.TENSE_HUMOR},EmotionBehavior.prototype.isDefensiveness=function(){return this.behavior===EmotionEventSpaffCode.DEFENSIVENESS},EmotionBehavior.prototype.isWhining=function(){return this.behavior===EmotionEventSpaffCode.WHINING},EmotionBehavior.prototype.isSadness=function(){return this.behavior===EmotionEventSpaffCode.SADNESS},EmotionBehavior.prototype.isStonewalling=function(){return this.behavior===EmotionEventSpaffCode.STONEWALLING},EmotionBehavior.prototype.isInterest=function(){return this.behavior===EmotionEventSpaffCode.INTEREST},EmotionBehavior.prototype.isValidation=function(){return this.behavior===EmotionEventSpaffCode.VALIDATION},EmotionBehavior.prototype.isAffection=function(){return this.behavior===EmotionEventSpaffCode.AFFECTION},EmotionBehavior.prototype.isHumor=function(){return this.behavior===EmotionEventSpaffCode.HUMOR},EmotionBehavior.prototype.isSurprise=function(){return this.behavior===EmotionEventSpaffCode.SURPRISE},EmotionBehavior.prototype.isJoy=function(){return this.behavior===EmotionEventSpaffCode.JOY},EmotionBehavior}(),emotion_strength_entity_EmotionStrength=function(){function EmotionStrength(strength){this.strength=strength}return EmotionStrength.prototype.isWeak=function(){return this.strength===EmotionEventStrength.WEAK},EmotionStrength.prototype.isStrong=function(){return this.strength===EmotionEventStrength.STRONG},EmotionStrength}();!function(InworldPacketType){InworldPacketType.UNKNOWN="UNKNOWN",InworldPacketType.TEXT="TEXT",InworldPacketType.AUDIO="AUDIO",InworldPacketType.TRIGGER="TRIGGER",InworldPacketType.EMOTION="EMOTION",InworldPacketType.CONTROL="CONTROL",InworldPacketType.SILENCE="SILENCE",InworldPacketType.CANCEL_RESPONSE="CANCEL_RESPONSE"}(InworldPacketType||(InworldPacketType={})),function(InworlControlType){InworlControlType.UNKNOWN="UNKNOWN",InworlControlType.INTERACTION_END="INTERACTION_END",InworlControlType.TTS_PLAYBACK_START="TTS_PLAYBACK_START",InworlControlType.TTS_PLAYBACK_END="TTS_PLAYBACK_END"}(InworlControlType||(InworlControlType={}));for(var InworldPacket=function(){function InworldPacket(props){this.packetId=props.packetId,this.routing=props.routing,this.date=props.date,this.type=props.type,this.isText()&&(this.text=props.text),this.isAudio()&&(this.audio=props.audio),this.isControl()&&(this.control=props.control),this.isEmotion()&&(this.emotions=props.emotions),this.isTrigger()&&(this.trigger=props.trigger),this.isSilence()&&(this.silence=props.silence),this.isCancelResponse()&&(this.cancelResponses=props.cancelResponses)}return InworldPacket.prototype.isText=function(){return this.type===InworldPacketType.TEXT},InworldPacket.prototype.isAudio=function(){return this.type===InworldPacketType.AUDIO},InworldPacket.prototype.isControl=function(){return this.type===InworldPacketType.CONTROL},InworldPacket.prototype.isTrigger=function(){return this.type===InworldPacketType.TRIGGER},InworldPacket.prototype.isEmotion=function(){return this.type===InworldPacketType.EMOTION},InworldPacket.prototype.isInteractionEnd=function(){return this.isControl()&&this.control.type===InworlControlType.INTERACTION_END},InworldPacket.prototype.isTTSPlaybackStart=function(){return this.isControl()&&this.control.type===InworlControlType.TTS_PLAYBACK_START},InworldPacket.prototype.isTTSPlaybackEnd=function(){return this.isControl()&&this.control.type===InworlControlType.TTS_PLAYBACK_END},InworldPacket.prototype.isSilence=function(){return this.type===InworldPacketType.SILENCE},InworldPacket.prototype.isCancelResponse=function(){return this.type===InworldPacketType.CANCEL_RESPONSE},InworldPacket}(),event_assign=function(){return event_assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;n>i;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},event_assign.apply(this,arguments)},event_EventFactory=function(){function EventFactory(){this.character=null,this.protoTimestampNow=function(){return(new Date).toISOString()}}return EventFactory.prototype.getCurrentCharacter=function(){return this.character},EventFactory.prototype.setCurrentCharacter=function(character){this.character=character},EventFactory.prototype.dataChunk=function(chunk,type){return{packetId:{packetId:esm_browser_v4()},timestamp:this.protoTimestampNow(),routing:this.routing(),dataChunk:{chunk:chunk,type:type}}},EventFactory.prototype.audioSessionStart=function(){return{packetId:{packetId:esm_browser_v4()},timestamp:this.protoTimestampNow(),routing:this.routing(),control:{action:ControlEventAction.AUDIO_SESSION_START}}},EventFactory.prototype.audioSessionEnd=function(){return{packetId:{packetId:esm_browser_v4()},timestamp:this.protoTimestampNow(),routing:this.routing(),control:{action:ControlEventAction.AUDIO_SESSION_END}}},EventFactory.prototype.ttsPlaybackStart=function(){return{packetId:{packetId:esm_browser_v4()},timestamp:this.protoTimestampNow(),routing:this.routing(),control:{action:ControlEventAction.TTS_PLAYBACK_START}}},EventFactory.prototype.ttsPlaybackEnd=function(){return{packetId:{packetId:esm_browser_v4()},timestamp:this.protoTimestampNow(),routing:this.routing(),control:{action:ControlEventAction.TTS_PLAYBACK_END}}},EventFactory.prototype.text=function(text){return{packetId:{packetId:esm_browser_v4(),utteranceId:esm_browser_v4(),interactionId:esm_browser_v4()},timestamp:this.protoTimestampNow(),routing:this.routing(),text:{sourceType:TextEventSourceType.TYPED_IN,text:text,final:!0}}},EventFactory.prototype.trigger=function(name){return{packetId:{packetId:esm_browser_v4(),utteranceId:esm_browser_v4(),interactionId:esm_browser_v4()},timestamp:this.protoTimestampNow(),routing:this.routing(),custom:{name:name}}},EventFactory.prototype.cancelResponse=function(cancelResponses){return{packetId:{packetId:esm_browser_v4()},timestamp:this.protoTimestampNow(),routing:this.routing(),cancelResponses:cancelResponses}},EventFactory.prototype.convertToInworldPacket=function(packet){var _a,_b,packetId=packet.packetId,routing=packet.routing,source=routing.source,target=routing.target,type=this.getType(packet),additionalPhonemeInfo=null!==(_b=null===(_a=packet.dataChunk)||void 0===_a?void 0:_a.additionalPhonemeInfo)&&void 0!==_b?_b:[];return new InworldPacket(event_assign(event_assign(event_assign(event_assign(event_assign(event_assign(event_assign({type:type,date:packet.timestamp,packetId:{packetId:packetId.packetId,utteranceId:packetId.utteranceId,interactionId:packetId.interactionId},routing:{source:{name:source.name,isPlayer:source.type===ActorType.PLAYER,isCharacter:source.type===ActorType.AGENT},target:{name:target.name,isPlayer:target.type===ActorType.PLAYER,isCharacter:target.type===ActorType.AGENT}}},type===InworldPacketType.TRIGGER&&{trigger:{name:packet.custom.name}}),type===InworldPacketType.TEXT&&{text:{text:packet.text.text,final:packet.text.final}}),type===InworldPacketType.AUDIO&&{audio:{chunk:packet.dataChunk.chunk,additionalPhonemeInfo:(null!=additionalPhonemeInfo?additionalPhonemeInfo:[]).map((function(info){return{phoneme:info.phoneme,startOffset:info.startOffset}}))}}),type===InworldPacketType.CONTROL&&{control:{type:this.getControlType(packet)}}),type===InworldPacketType.SILENCE&&{silence:{durationMs:parseInt(packet.dataChunk.durationMs,10)}}),type===InworldPacketType.EMOTION&&{emotions:{joy:packet.emotion.joy,fear:packet.emotion.fear,trust:packet.emotion.trust,surprise:packet.emotion.surprise,behavior:new emotion_behavior_entity_EmotionBehavior(packet.emotion.behavior),strength:new emotion_strength_entity_EmotionStrength(packet.emotion.strength)}}),type===InworldPacketType.CANCEL_RESPONSE&&{cancelResponses:{interactionId:packet.cancelResponses.interactionId,utteranceId:packet.cancelResponses.utteranceId}}))},EventFactory.prototype.routing=function(){var _a;return{source:{type:ActorType.PLAYER},target:{type:ActorType.AGENT,name:null===(_a=this.character)||void 0===_a?void 0:_a.getId()}}},EventFactory.prototype.getType=function(packet){return packet.text?InworldPacketType.TEXT:packet.dataChunk&&packet.dataChunk.type===DataChunkDataType.AUDIO?InworldPacketType.AUDIO:packet.dataChunk&&packet.dataChunk.type===DataChunkDataType.SILENCE?InworldPacketType.SILENCE:packet.custom?InworldPacketType.TRIGGER:packet.control?InworldPacketType.CONTROL:packet.emotion?InworldPacketType.EMOTION:packet.cancelResponses?InworldPacketType.CANCEL_RESPONSE:InworldPacketType.UNKNOWN},EventFactory.prototype.getControlType=function(packet){switch(packet.control.action){case ControlEventAction.INTERACTION_END:return InworlControlType.INTERACTION_END;case ControlEventAction.TTS_PLAYBACK_START:return InworlControlType.TTS_PLAYBACK_START;case ControlEventAction.TTS_PLAYBACK_END:return InworlControlType.TTS_PLAYBACK_END;default:return InworlControlType.UNKNOWN}},EventFactory}(),fetch_pb_assign=function(){return fetch_pb_assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;n>i;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},fetch_pb_assign.apply(this,arguments)},__rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&0>e.indexOf(p)&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);p.length>i;i++)0>e.indexOf(p[i])&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},fetch_pb_spreadArray=function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;l>i;i++)!ar&&i in from||(ar||(ar=Array.prototype.slice.call(from,0,i)),ar[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},b64=Array(64),s64=Array(123),fetch_pb_i=0;64>fetch_pb_i;)s64[b64[fetch_pb_i]=26>fetch_pb_i?fetch_pb_i+65:52>fetch_pb_i?fetch_pb_i+71:62>fetch_pb_i?fetch_pb_i-4:fetch_pb_i-59|43]=fetch_pb_i++;function replacer(key,value){return value&&value.constructor===Uint8Array?function(buffer,start,end){for(var t,parts=null,chunk=[],i=0,j=0;end>start;){var b=buffer[start++];switch(j){case 0:chunk[i++]=b64[b>>2],t=(3&b)<<4,j=1;break;case 1:chunk[i++]=b64[t|b>>4],t=(15&b)<<2,j=2;break;case 2:chunk[i++]=b64[t|b>>6],chunk[i++]=b64[63&b],j=0}i>8191&&((parts||(parts=[])).push(String.fromCharCode.apply(String,chunk)),i=0)}return j&&(chunk[i++]=b64[t],chunk[i++]=61,1===j&&(chunk[i++]=61)),parts?(i&&parts.push(String.fromCharCode.apply(String,chunk.slice(0,i))),parts.join("")):String.fromCharCode.apply(String,chunk.slice(0,i))}(value,0,value.length):value}function fetchReq(path,init){var _a=init||{},pathPrefix=_a.pathPrefix,req=__rest(_a,["pathPrefix"]),url=pathPrefix?"".concat(pathPrefix).concat(path):path;return fetch(url,req).then((function(r){return r.json().then((function(body){if(!r.ok)throw body;return body}))}))}function isPrimitive(value){return["string","number","boolean"].some((function(t){return typeof value===t}))}function flattenRequestPayload(requestPayload,path){return void 0===path&&(path=""),Object.keys(requestPayload).reduce((function(acc,key){var _a,value=requestPayload[key],newPath=path?[path,key].join("."):key,isNonEmptyPrimitiveArray=Array.isArray(value)&&value.every((function(v){return isPrimitive(v)}))&&value.length>0,isNonZeroValuePrimitive=isPrimitive(value)&&!function(value){return!1===value||0===value||""===value}(value),objectToMerge={};return!function(value){var isObject="Object"===Object.prototype.toString.call(value).slice(8,-1);if(null===value||!isObject||!isObject)return!1;var proto=Object.getPrototypeOf(value);return"object"==typeof proto&&proto.constructor===Object.prototype.constructor}(value)?(isNonZeroValuePrimitive||isNonEmptyPrimitiveArray)&&((_a={})[newPath]=value,objectToMerge=_a):objectToMerge=flattenRequestPayload(value,newPath),fetch_pb_assign(fetch_pb_assign({},acc),objectToMerge)}),{})}var VoicePreset,PreviousDialogDialogParticipant,world_engine_pb_assign=function(){return world_engine_pb_assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;n>i;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},world_engine_pb_assign.apply(this,arguments)};!function(VoicePreset){VoicePreset.VOICE_PRESET_UNSPECIFIED="VOICE_PRESET_UNSPECIFIED",VoicePreset.VOICE_PRESET_FEMALE_1="VOICE_PRESET_FEMALE_1",VoicePreset.VOICE_PRESET_FEMALE_2="VOICE_PRESET_FEMALE_2",VoicePreset.VOICE_PRESET_FEMALE_3="VOICE_PRESET_FEMALE_3",VoicePreset.VOICE_PRESET_FEMALE_4="VOICE_PRESET_FEMALE_4",VoicePreset.VOICE_PRESET_FEMALE_5="VOICE_PRESET_FEMALE_5",VoicePreset.VOICE_PRESET_MALE_1="VOICE_PRESET_MALE_1",VoicePreset.VOICE_PRESET_MALE_2="VOICE_PRESET_MALE_2",VoicePreset.VOICE_PRESET_MALE_3="VOICE_PRESET_MALE_3",VoicePreset.VOICE_PRESET_MALE_4="VOICE_PRESET_MALE_4",VoicePreset.VOICE_PRESET_MALE_5="VOICE_PRESET_MALE_5",VoicePreset.INWORLD_VOICE_PRESET_MALE_1="INWORLD_VOICE_PRESET_MALE_1",VoicePreset.INWORLD_VOICE_PRESET_MALE_2="INWORLD_VOICE_PRESET_MALE_2",VoicePreset.INWORLD_VOICE_PRESET_FEMALE_1="INWORLD_VOICE_PRESET_FEMALE_1",VoicePreset.INWORLD_VOICE_PRESET_FEMALE_2="INWORLD_VOICE_PRESET_FEMALE_2",VoicePreset.INWORLD_VOICE_PRESET_MALE_3="INWORLD_VOICE_PRESET_MALE_3",VoicePreset.INWORLD_VOICE_PRESET_MALE_4="INWORLD_VOICE_PRESET_MALE_4",VoicePreset.INWORLD_VOICE_PRESET_MALE_5="INWORLD_VOICE_PRESET_MALE_5",VoicePreset.INWORLD_VOICE_PRESET_FEMALE_3="INWORLD_VOICE_PRESET_FEMALE_3",VoicePreset.INWORLD_VOICE_PRESET_FEMALE_4="INWORLD_VOICE_PRESET_FEMALE_4",VoicePreset.INWORLD_VOICE_PRESET_ROBOT_MALE_1="INWORLD_VOICE_PRESET_ROBOT_MALE_1",VoicePreset.INWORLD_VOICE_PRESET_ROBOT_MALE_2="INWORLD_VOICE_PRESET_ROBOT_MALE_2",VoicePreset.INWORLD_VOICE_PRESET_ROBOT_MALE_3="INWORLD_VOICE_PRESET_ROBOT_MALE_3",VoicePreset.INWORLD_VOICE_PRESET_ROBOT_MALE_4="INWORLD_VOICE_PRESET_ROBOT_MALE_4",VoicePreset.INWORLD_VOICE_PRESET_ROBOT_MALE_5="INWORLD_VOICE_PRESET_ROBOT_MALE_5",VoicePreset.INWORLD_VOICE_PRESET_ROBOT_FEMALE_1="INWORLD_VOICE_PRESET_ROBOT_FEMALE_1",VoicePreset.INWORLD_VOICE_PRESET_ROBOT_FEMALE_2="INWORLD_VOICE_PRESET_ROBOT_FEMALE_2",VoicePreset.INWORLD_VOICE_PRESET_ROBOT_FEMALE_3="INWORLD_VOICE_PRESET_ROBOT_FEMALE_3",VoicePreset.INWORLD_VOICE_PRESET_ROBOT_FEMALE_4="INWORLD_VOICE_PRESET_ROBOT_FEMALE_4",VoicePreset.INWORLD_VOICE_PRESET_SPIKE="INWORLD_VOICE_PRESET_SPIKE",VoicePreset.INWORLD_VOICE_PRESET_TWILIGHT="INWORLD_VOICE_PRESET_TWILIGHT",VoicePreset.INWORLD_VOICE_PRESET_FLUTTERSHY="INWORLD_VOICE_PRESET_FLUTTERSHY",VoicePreset.INWORLD_VOICE_PRESET_ROBOT_SPIKE="INWORLD_VOICE_PRESET_ROBOT_SPIKE",VoicePreset.INWORLD_VOICE_PRESET_ROBOT_TWILIGHT="INWORLD_VOICE_PRESET_ROBOT_TWILIGHT",VoicePreset.INWORLD_VOICE_PRESET_ROBOT_FLUTTERSHY="INWORLD_VOICE_PRESET_ROBOT_FLUTTERSHY"}(VoicePreset||(VoicePreset={})),function(PreviousDialogDialogParticipant){PreviousDialogDialogParticipant.UNKNOWN="UNKNOWN",PreviousDialogDialogParticipant.PLAYER="PLAYER",PreviousDialogDialogParticipant.CHARACTER="CHARACTER"}(PreviousDialogDialogParticipant||(PreviousDialogDialogParticipant={}));var world_engine_pb_WorldEngine=function(){function WorldEngine(){}return WorldEngine.CreateWorld=function(req,initReq){return fetchReq("/v1/worlds/".concat(req.protoWorldName),world_engine_pb_assign(world_engine_pb_assign({},initReq),{method:"POST",body:JSON.stringify(req,replacer)}))},WorldEngine.LoadScene=function(req,initReq){return fetchReq("/v1/".concat(req.name,":load"),world_engine_pb_assign(world_engine_pb_assign({},initReq),{method:"POST",body:JSON.stringify(req,replacer)}))},WorldEngine.LogError=function(req,initReq){return fetchReq("/v1/log:error",world_engine_pb_assign(world_engine_pb_assign({},initReq),{method:"POST",body:JSON.stringify(req,replacer)}))},WorldEngine.VoicePreview=function(req,initReq){return fetchReq("/v1/voice:preview",world_engine_pb_assign(world_engine_pb_assign({},initReq),{method:"POST",body:JSON.stringify(req,replacer)}))},WorldEngine.ListBaseVoices=function(req,initReq){return fetchReq("/v1/voice:base?".concat(function(requestPayload,urlPathParams){void 0===urlPathParams&&(urlPathParams=[]);var flattenedRequestPayload=flattenRequestPayload(requestPayload),urlSearchParams=Object.keys(flattenedRequestPayload).reduce((function(acc,key){var value=flattenedRequestPayload[key];return urlPathParams.find((function(f){return f===key}))?acc:Array.isArray(value)?fetch_pb_spreadArray(fetch_pb_spreadArray([],acc,!0),value.map((function(m){return[key,""+m]})),!0):acc=fetch_pb_spreadArray(fetch_pb_spreadArray([],acc,!0),[[key,""+value]],!1)}),[]);return""+new URLSearchParams(urlSearchParams)}(req,[])),world_engine_pb_assign(world_engine_pb_assign({},initReq),{method:"GET"}))},WorldEngine.GenerateToken=function(req,initReq){return fetchReq("/auth/v1/tokens/token:generate",world_engine_pb_assign(world_engine_pb_assign({},initReq),{method:"POST",body:JSON.stringify(req,replacer)}))},WorldEngine.PingCharacter=function(req,initReq){return fetchReq("/auth/v1/character:ping",world_engine_pb_assign(world_engine_pb_assign({},initReq),{method:"POST",body:JSON.stringify(req,replacer)}))},WorldEngine}(),world_engine_service_assign=function(){return world_engine_service_assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;n>i;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},world_engine_service_assign.apply(this,arguments)},world_engine_service_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},world_engine_service_generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&t[3]>op[1])){_.label=op[1];break}if(6===op[0]&&t[1]>_.label){_.label=t[1],t=op;break}if(t&&t[2]>_.label){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},world_engine_service_WorldEngineService=function(){function WorldEngineService(){var _this=this;this.engineSessionRequest=function(pathPrefix,session,pb,req){return world_engine_service_awaiter(_this,void 0,void 0,(function(){var params;return world_engine_service_generator(this,(function(){return params={headers:world_engine_service_assign(world_engine_service_assign({},session.sessionId&&{"Grpc-Metadata-session-id":session.sessionId}),session.type&&session.token&&{Authorization:"".concat(session.type," ").concat(session.token)}),pathPrefix:pathPrefix},[2,pb(req,params)]}))}))}}return WorldEngineService.prototype.loadScene=function(props){return world_engine_service_awaiter(this,void 0,void 0,(function(){var client,config,name,session,user,_a,hostname,url;return world_engine_service_generator(this,(function(){return client=props.client,name=props.name,session=props.session,user=props.user,hostname=(_a=(config=props.config).connection.gateway).hostname,url="".concat(_a.ssl?"https":"http","://").concat(hostname),[2,this.engineSessionRequest(url,session,world_engine_pb_WorldEngine.LoadScene,{client:world_engine_service_assign({id:"web"},client),name:name,user:user,capabilities:config.capabilities})]}))}))},WorldEngineService}(),connection_service_assign=function(){return connection_service_assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;n>i;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},connection_service_assign.apply(this,arguments)},connection_service_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},connection_service_generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&t[3]>op[1])){_.label=op[1];break}if(6===op[0]&&t[1]>_.label){_.label=t[1],t=op;break}if(t&&t[2]>_.label){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},player=Player.getInstance(),connection_service_ConnectionService=function(){function ConnectionService(props){this.state=ConnectionState.INACTIVE,this.characters=[],this.eventFactory=new event_EventFactory,this.cancelReponses={},this.history=new history_InworldHistory,this.connectionProps=props||{},this.initializeHandlers(),this.initializeConnection()}return ConnectionService.prototype.isActive=function(){return this.state===ConnectionState.ACTIVE},ConnectionService.prototype.isAutoReconnected=function(){var _a,_b,_c;return null===(_c=null===(_b=null===(_a=this.connectionProps.config)||void 0===_a?void 0:_a.connection)||void 0===_b?void 0:_b.autoReconnect)||void 0===_c||_c},ConnectionService.prototype.openManually=function(){return connection_service_awaiter(this,void 0,void 0,(function(){return connection_service_generator(this,(function(){try{if(this.isAutoReconnected())throw Error("Impossible to open connection manually with `autoReconnect` enabled");if(this.state!==ConnectionState.INACTIVE)throw Error("Connection is already open");return[2,this.open()]}catch(err){this.onError(err)}return[2]}))}))},ConnectionService.prototype.close=function(){this.cancelScheduler(),this.state=ConnectionState.INACTIVE,this.connection.close()},ConnectionService.prototype.getHistory=function(){return this.history.get()},ConnectionService.prototype.clearHistory=function(){this.history.clear()},ConnectionService.prototype.getEventFactory=function(){return this.eventFactory},ConnectionService.prototype.getCharactersList=function(){return connection_service_awaiter(this,void 0,void 0,(function(){return connection_service_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.loadScene()];case 1:return _a.sent(),[2,this.characters]}}))}))},ConnectionService.prototype.open=function(){return connection_service_awaiter(this,void 0,void 0,(function(){var err_1;return connection_service_generator(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,4,,5]),[4,this.loadScene()];case 1:return _a.sent(),this.state!==ConnectionState.LOADED?[3,3]:(this.state=ConnectionState.ACTIVATING,[4,this.connection.open({characters:this.characters.map((function(c){return c.getId()})),session:this.session})]);case 2:_a.sent(),this.scheduleDisconnect(),_a.label=3;case 3:return[3,5];case 4:return err_1=_a.sent(),this.onError(err_1),[3,5];case 5:return[2]}}))}))},ConnectionService.prototype.send=function(getPacket){return connection_service_awaiter(this,void 0,void 0,(function(){var err_2;return connection_service_generator(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,4]),this.cancelScheduler(),this.isActive()?[2,this.write(getPacket)]:this.isAutoReconnected()?[4,this.open()]:[3,2];case 1:return _a.sent(),[2,this.write(getPacket)];case 2:throw Error("Unable to send data due inactive connection");case 3:return err_2=_a.sent(),this.onError(err_2),[3,4];case 4:return[2]}}))}))},ConnectionService.prototype.loadCharactersList=function(){var _a,_b;return connection_service_awaiter(this,void 0,void 0,(function(){return connection_service_generator(this,(function(_c){switch(_c.label){case 0:return this.scene?[3,2]:[4,this.loadScene()];case 1:_c.sent(),_c.label=2;case 2:return this.characters=null===(_b=(null===(_a=this.scene)||void 0===_a?void 0:_a.agents)||[])||void 0===_b?void 0:_b.map((function(agent){return new Character({id:agent.agentId,resourceName:agent.brainName,displayName:agent.givenName,assets:{rpmModelUri:agent.characterAssets.rpmModelUri,rpmImageUriPortrait:agent.characterAssets.rpmImageUriPortrait,rpmImageUriPosture:agent.characterAssets.rpmImageUriPosture}})})),!this.getEventFactory().getCurrentCharacter()&&this.characters[0]&&this.getEventFactory().setCurrentCharacter(this.characters[0]),[2]}}))}))},ConnectionService.prototype.write=function(getPacket){var _this=this,inworldPacket=this.getEventFactory().convertToInworldPacket(getPacket());return this.connection.write({getPacket:getPacket,afterWriting:function(packet){var inworldPacket=_this.getEventFactory().convertToInworldPacket(packet);_this.scheduleDisconnect(),inworldPacket.isText()&&_this.interrupt(inworldPacket.packetId.interactionId),_this.addPacketToHistory(inworldPacket)}}),inworldPacket},ConnectionService.prototype.loadScene=function(){return connection_service_awaiter(this,void 0,void 0,(function(){var _a,generateSessionToken,name,client,user,_b,sessionId,expirationTime,_c,engineService,_d,err_3;return connection_service_generator(this,(function(_e){switch(_e.label){case 0:if(this.state===ConnectionState.LOADING)return[2];generateSessionToken=(_a=this.connectionProps).generateSessionToken,name=_a.name,client=_a.client,user=_a.user,_e.label=1;case 1:return _e.trys.push([1,7,,8]),sessionId=(_b=this.session||{}).sessionId,(expirationTime=_b.expirationTime)&&new Date(expirationTime).getTime()-(new Date).getTime()>3e6?[3,3]:(this.state=ConnectionState.LOADING,_c=this,[4,generateSessionToken()]);case 2:_c.session=_e.sent(),sessionId&&(this.session=connection_service_assign(connection_service_assign({},this.session),{sessionId:sessionId})),_e.label=3;case 3:return engineService=new world_engine_service_WorldEngineService,this.scene?[3,6]:(_d=this,[4,engineService.loadScene({config:this.connectionProps.config,session:this.session,name:name,user:user,client:client})]);case 4:return _d.scene=_e.sent(),[4,this.loadCharactersList()];case 5:_e.sent(),_e.label=6;case 6:return[ConnectionState.LOADING,ConnectionState.INACTIVE].includes(this.state)&&(this.state=ConnectionState.LOADED),[3,8];case 7:return err_3=_e.sent(),this.onError(err_3),[3,8];case 8:return[2]}}))}))},ConnectionService.prototype.scheduleDisconnect=function(){var _a,_b,_this=this;(null===(_b=null===(_a=this.connectionProps.config)||void 0===_a?void 0:_a.connection)||void 0===_b?void 0:_b.disconnectTimeout)&&(this.cancelScheduler(),this.disconnectTimeoutId=setTimeout((function(){return _this.close()}),this.connectionProps.config.connection.disconnectTimeout))},ConnectionService.prototype.cancelScheduler=function(){this.disconnectTimeoutId&&clearTimeout(this.disconnectTimeoutId)},ConnectionService.prototype.initializeHandlers=function(){var _this=this,_a=this.connectionProps,onError=_a.onError,onReady=_a.onReady,onDisconnect=_a.onDisconnect,grpcAudioPlayer=_a.grpcAudioPlayer,webRtcLoopbackBiDiSession=_a.webRtcLoopbackBiDiSession;this.onReady=function(){return connection_service_awaiter(_this,void 0,void 0,(function(){return connection_service_generator(this,(function(_a){switch(_a.label){case 0:return[4,webRtcLoopbackBiDiSession.startSession(new MediaStream,grpcAudioPlayer.getPlaybackStream())];case 1:return _a.sent(),player.setStream(webRtcLoopbackBiDiSession.getPlaybackLoopbackStream()),this.state=ConnectionState.ACTIVE,null==onReady||onReady(),[2]}}))}))},this.onDisconnect=function(){_this.state=ConnectionState.INACTIVE,null==onDisconnect||onDisconnect()},this.onError=null!=onError?onError:function(event){return console.error(event)},this.onMessage=function(packet){return connection_service_awaiter(_this,void 0,void 0,(function(){var _a,onMessage,grpcAudioPlayer,inworldPacket,interactionId,_this=this;return connection_service_generator(this,(function(){return onMessage=(_a=this.connectionProps).onMessage,grpcAudioPlayer=_a.grpcAudioPlayer,inworldPacket=this.eventFactory.convertToInworldPacket(packet),interactionId=inworldPacket.packetId.interactionId,inworldPacket.isText()&&!inworldPacket.routing.source.isPlayer&&this.cancelReponses[interactionId]?(this.updatePacketInHistory(inworldPacket)?null==onMessage||onMessage(inworldPacket):this.sendCancelResponses({interactionId:interactionId,utteranceId:[packet.packetId.utteranceId]}),[2]):(inworldPacket.isText()&&inworldPacket.routing.source.isPlayer&&this.interrupt(inworldPacket.packetId.interactionId),(inworldPacket.isAudio()||inworldPacket.isSilence())&&(this.cancelReponses[interactionId]||grpcAudioPlayer.addToQueue({packet:inworldPacket,onBeforePlaying:function(packet){return _this.displayPlacketInHistory(packet,CHAT_HISTORY_TYPE.ACTOR)},onAfterPlaying:function(packet){_this.displayPlacketInHistory(packet,CHAT_HISTORY_TYPE.INTERACTION_END)}})),inworldPacket.isInteractionEnd()&&delete this.cancelReponses[interactionId],this.addPacketToHistory(inworldPacket),null==onMessage||onMessage(inworldPacket),[2])}))}))}},ConnectionService.prototype.initializeConnection=function(){this.connection=new WebSocketConnection({config:this.connectionProps.config,onDisconnect:this.onDisconnect,onReady:this.onReady,onError:this.onError,onMessage:this.onMessage})},ConnectionService.prototype.interrupt=function(interactionId){var _a=this.connectionProps,grpcAudioPlayer=_a.grpcAudioPlayer,config=_a.config;if(null==config?void 0:config.capabilities.interruptions){var packets=grpcAudioPlayer.excludeCurrentInteractionPackets(interactionId);if(grpcAudioPlayer.isCurrentPacket({interactionId:interactionId})||grpcAudioPlayer.stop(),packets.length)this.sendCancelResponses({interactionId:packets[0].packetId.interactionId,utteranceId:packets.map((function(packet){return packet.packetId.utteranceId}))})}},ConnectionService.prototype.sendCancelResponses=function(cancelReponses){var _a,_b,_this=this;cancelReponses.interactionId&&(this.send((function(){return _this.getEventFactory().cancelResponse(cancelReponses)})),this.cancelReponses=connection_service_assign(connection_service_assign({},this.cancelReponses),((_a={})[cancelReponses.interactionId]=!0,_a)),this.history.filter({utteranceId:null!==(_b=cancelReponses.utteranceId)&&void 0!==_b?_b:[],interactionId:cancelReponses.interactionId}))},ConnectionService.prototype.addPacketToHistory=function(packet){var _a,_b;this.history.addOrUpdate({grpcAudioPlayer:this.connectionProps.grpcAudioPlayer,characters:this.characters,packet:packet})&&(null===(_b=(_a=this.connectionProps).onHistoryChange)||void 0===_b||_b.call(_a,this.getHistory()))},ConnectionService.prototype.updatePacketInHistory=function(packet){var changed=this.history.update(packet);return changed&&this.connectionProps.onHistoryChange(this.getHistory()),changed},ConnectionService.prototype.displayPlacketInHistory=function(packet,type){this.history.display(packet,type)&&this.connectionProps.onHistoryChange(this.getHistory())},ConnectionService}(),inworld_player_player=Player.getInstance(),InworldPlayer=function(){function InworldPlayer(props){this.grpcAudioPlayer=props.grpcAudioPlayer}return InworldPlayer.prototype.getMute=function(){return inworld_player_player.getMute()},InworldPlayer.prototype.mute=function(mute){inworld_player_player.setMute(mute)},InworldPlayer.prototype.stop=function(){this.grpcAudioPlayer.stop()},InworldPlayer.prototype.clear=function(){this.grpcAudioPlayer.clearQueue()},InworldPlayer.prototype.playWorkaroundSound=function(){inworld_player_player.playWorkaroundSound()},InworldPlayer.prototype.isActive=function(){return this.grpcAudioPlayer.getIsActive()},InworldPlayer.prototype.hasPacket=function(props){return this.grpcAudioPlayer.hasPacketInQueue(props)},InworldPlayer}(),inworld_recorder_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},inworld_recorder_generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&t[3]>op[1])){_.label=op[1];break}if(6===op[0]&&t[1]>_.label){_.label=t[1],t=op;break}if(t&&t[2]>_.label){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},inworld_recorder_player=Player.getInstance(),InworldRecorder=function(){function InworldRecorder(props){this.isActive=!0,this.listener=props.listener,this.grpcAudioPlayer=props.grpcAudioPlayer,this.grpcAudioRecorder=props.grpcAudioRecorder,this.webRtcLoopbackBiDiSession=props.webRtcLoopbackBiDiSession}return InworldRecorder.prototype.start=function(){return inworld_recorder_awaiter(this,void 0,void 0,(function(){var _a,_this=this;return inworld_recorder_generator(this,(function(_b){switch(_b.label){case 0:return _a=this,[4,navigator.mediaDevices.getUserMedia({audio:{sampleRate:16e3,echoCancellation:{ideal:!0},suppressLocalAudioPlayback:{ideal:!0}},video:!1})];case 1:return _a.recordingStream=_b.sent(),[4,this.webRtcLoopbackBiDiSession.startSession(this.recordingStream,this.grpcAudioPlayer.getPlaybackStream())];case 2:return _b.sent(),inworld_recorder_player.setStream(this.webRtcLoopbackBiDiSession.getPlaybackLoopbackStream()),this.grpcAudioRecorder.startConvertion(this.webRtcLoopbackBiDiSession.getRecorderLoopBackStream(),(function(base64AudioChunk){_this.getIsActive()&&_this.listener(base64AudioChunk)})),[2]}}))}))},InworldRecorder.prototype.setIsActive=function(isActive){this.isActive=isActive},InworldRecorder.prototype.getIsActive=function(){return this.isActive},InworldRecorder.prototype.stop=function(){var _a;this.grpcAudioRecorder.stopConvertion(),null===(_a=this.recordingStream)||void 0===_a||_a.getTracks().forEach((function(track){track.stop()}))},InworldRecorder.prototype.initPlayback=function(){return inworld_recorder_awaiter(this,void 0,void 0,(function(){return inworld_recorder_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.grpcAudioPlayer.init()];case 1:return _a.sent(),[4,this.webRtcLoopbackBiDiSession.startSession(new MediaStream,this.grpcAudioPlayer.getPlaybackStream())];case 2:return _a.sent(),inworld_recorder_player.setStream(this.webRtcLoopbackBiDiSession.getPlaybackLoopbackStream()),[2]}}))}))},InworldRecorder.prototype.isRecording=function(){return this.grpcAudioRecorder.isRecording()},InworldRecorder.prototype.isSupported=function(){return-1===navigator.userAgent.indexOf("Firefox")},InworldRecorder}(),inworld_connection_service_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},inworld_connection_service_generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&t[3]>op[1])){_.label=op[1];break}if(6===op[0]&&t[1]>_.label){_.label=t[1],t=op;break}if(t&&t[2]>_.label){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},inworld_connection_service_InworldConnectionService=function(){function InworldConnectionService(props){var _this=this;this.connection=props.connection,this.grpcAudioPlayer=props.grpcAudioPlayer,this.player=new InworldPlayer({grpcAudioPlayer:this.grpcAudioPlayer}),this.recorder=new InworldRecorder({listener:function(base64AudioChunk){return inworld_connection_service_awaiter(_this,void 0,void 0,(function(){return inworld_connection_service_generator(this,(function(_a){switch(_a.label){case 0:return this.connection.isActive()?[3,2]:[4,this.sendAudioSessionStart()];case 1:_a.sent(),_a.label=2;case 2:return this.sendAudio(base64AudioChunk),[2]}}))}))},grpcAudioPlayer:this.grpcAudioPlayer,grpcAudioRecorder:props.grpcAudioRecorder,webRtcLoopbackBiDiSession:props.webRtcLoopbackBiDiSession})}return InworldConnectionService.prototype.open=function(){return inworld_connection_service_awaiter(this,void 0,void 0,(function(){return inworld_connection_service_generator(this,(function(){return[2,this.connection.openManually()]}))}))},InworldConnectionService.prototype.close=function(){this.connection.close()},InworldConnectionService.prototype.isActive=function(){return this.connection.isActive()},InworldConnectionService.prototype.getCharacters=function(){return inworld_connection_service_awaiter(this,void 0,void 0,(function(){return inworld_connection_service_generator(this,(function(){return[2,this.connection.getCharactersList()]}))}))},InworldConnectionService.prototype.getCurrentCharacter=function(){return inworld_connection_service_awaiter(this,void 0,void 0,(function(){return inworld_connection_service_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.connection.getCharactersList()];case 1:return _a.sent(),[2,this.connection.getEventFactory().getCurrentCharacter()]}}))}))},InworldConnectionService.prototype.getHistory=function(){return this.connection.getHistory()},InworldConnectionService.prototype.clearHistory=function(){return this.connection.clearHistory()},InworldConnectionService.prototype.setCurrentCharacter=function(character){return this.connection.getEventFactory().setCurrentCharacter(character)},InworldConnectionService.prototype.sendText=function(text){return inworld_connection_service_awaiter(this,void 0,void 0,(function(){var _this=this;return inworld_connection_service_generator(this,(function(){return[2,this.connection.send((function(){return _this.connection.getEventFactory().text(text)}))]}))}))},InworldConnectionService.prototype.sendAudio=function(chunk){return inworld_connection_service_awaiter(this,void 0,void 0,(function(){var _this=this;return inworld_connection_service_generator(this,(function(){return[2,this.connection.send((function(){return _this.connection.getEventFactory().dataChunk(chunk,DataChunkDataType.AUDIO)}))]}))}))},InworldConnectionService.prototype.sendTrigger=function(name){return inworld_connection_service_awaiter(this,void 0,void 0,(function(){var _this=this;return inworld_connection_service_generator(this,(function(){return[2,this.connection.send((function(){return _this.connection.getEventFactory().trigger(name)}))]}))}))},InworldConnectionService.prototype.sendAudioSessionStart=function(){return inworld_connection_service_awaiter(this,void 0,void 0,(function(){var _this=this;return inworld_connection_service_generator(this,(function(){return[2,this.connection.send((function(){return _this.connection.getEventFactory().audioSessionStart()}))]}))}))},InworldConnectionService.prototype.sendAudioSessionEnd=function(){return inworld_connection_service_awaiter(this,void 0,void 0,(function(){var _this=this;return inworld_connection_service_generator(this,(function(){return[2,this.connection.send((function(){return _this.connection.getEventFactory().audioSessionEnd()}))]}))}))},InworldConnectionService.prototype.sendTTSPlaybackStart=function(){return inworld_connection_service_awaiter(this,void 0,void 0,(function(){var _this=this;return inworld_connection_service_generator(this,(function(){return[2,this.connection.send((function(){return _this.connection.getEventFactory().ttsPlaybackStart()}))]}))}))},InworldConnectionService.prototype.sendTTSPlaybackEnd=function(){return inworld_connection_service_awaiter(this,void 0,void 0,(function(){var _this=this;return inworld_connection_service_generator(this,(function(){return[2,this.connection.send((function(){return _this.connection.getEventFactory().ttsPlaybackEnd()}))]}))}))},InworldConnectionService.prototype.sendCancelResponse=function(cancelResponses){return inworld_connection_service_awaiter(this,void 0,void 0,(function(){var _this=this;return inworld_connection_service_generator(this,(function(){return[2,this.connection.send((function(){return _this.connection.getEventFactory().cancelResponse(cancelResponses)}))]}))}))},InworldConnectionService}(),inworld_client_assign=function(){return inworld_client_assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;n>i;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},inworld_client_assign.apply(this,arguments)},inworld_client_InworldClient=function(){function InworldClient(){this.scene="",this.config={capabilities:this.ensureCapabilities()}}return InworldClient.prototype.setUser=function(user){return this.user={id:user.id,name:user.fullName},this},InworldClient.prototype.setClient=function(client){return this.client={id:client.id},this},InworldClient.prototype.setGenerateSessionToken=function(generateSessionToken){return this.generateSessionToken=generateSessionToken,this},InworldClient.prototype.setConfiguration=function(config){var _a=config.connection,connection=void 0===_a?{}:_a,_b=config.capabilities,capabilities=void 0===_b?{}:_b,gateway=connection.gateway;return this.config=inworld_client_assign(inworld_client_assign({},config),{connection:inworld_client_assign(inworld_client_assign({},connection),{gateway:this.ensureGateway("studio.inworld.ai",gateway)}),capabilities:this.ensureCapabilities(capabilities)}),this},InworldClient.prototype.setScene=function(name){return this.scene=name,this},InworldClient.prototype.setOnDisconnect=function(fn){return this.onDisconnect=fn,this},InworldClient.prototype.setOnError=function(fn){return this.onError=fn,this},InworldClient.prototype.setOnMessage=function(fn){return this.onMessage=fn,this},InworldClient.prototype.setOnReady=function(fn){return this.onReady=fn,this},InworldClient.prototype.setOnHistoryChange=function(fn){return this.onHistoryChange=fn,this},InworldClient.prototype.setOnAfterPlaying=function(fn){return this.onAfterPlaying=fn,this},InworldClient.prototype.setOnBeforePlaying=function(fn){return this.onBeforePlaying=fn,this},InworldClient.prototype.setOnStopPlaying=function(fn){return this.onStopPlaying=fn,this},InworldClient.prototype.build=function(){this.validate();var webRtcLoopbackBiDiSession=new GrpcWebRtcLoopbackBiDiSession,grpcAudioRecorder=new GrpcAudioRecorder,grpcAudioPlayer=new grpc_audio_playback_GrpcAudioPlayback({onAfterPlaying:this.onAfterPlaying,onBeforePlaying:this.onBeforePlaying,onStopPlaying:this.onStopPlaying}),connection=new connection_service_ConnectionService({grpcAudioPlayer:grpcAudioPlayer,webRtcLoopbackBiDiSession:webRtcLoopbackBiDiSession,name:this.scene,user:this.user,client:this.client,config:this.config,onError:this.onError,onReady:this.onReady,onMessage:this.onMessage,onHistoryChange:this.onHistoryChange,onDisconnect:this.onDisconnect,generateSessionToken:this.generateSessionToken});return new inworld_connection_service_InworldConnectionService({connection:connection,grpcAudioPlayer:grpcAudioPlayer,grpcAudioRecorder:grpcAudioRecorder,webRtcLoopbackBiDiSession:webRtcLoopbackBiDiSession})},InworldClient.prototype.ensureCapabilities=function(capabilities){var _a,_b,_c,_d,_e;return{audio:null===(_a=null==capabilities?void 0:capabilities.audio)||void 0===_a||_a,emotions:null!==(_b=null==capabilities?void 0:capabilities.emotions)&&void 0!==_b&&_b,interruptions:null!==(_c=null==capabilities?void 0:capabilities.interruptions)&&void 0!==_c&&_c,text:!0,silenceEvents:null!==(_d=null==capabilities?void 0:capabilities.silence)&&void 0!==_d&&_d,triggers:!0,turnBasedStt:null!==(_e=null==capabilities?void 0:capabilities.turnBasedStt)&&void 0!==_e&&_e}},InworldClient.prototype.ensureGateway=function(hostname,gateway){var _a,_b;return{hostname:null!==(_a=null==gateway?void 0:gateway.hostname)&&void 0!==_a?_a:hostname,ssl:null===(_b=null==gateway?void 0:gateway.ssl)||void 0===_b||_b}},InworldClient.prototype.validate=function(){if(!this.scene)throw Error("Scene name is required")},InworldClient}();__webpack_require__(1),__webpack_require__(2),__webpack_require__(3),__webpack_require__(4),__webpack_require__(5),__webpack_require__(6),__webpack_require__(7),__webpack_require__(8),__webpack_require__(9),__webpack_require__(10),__webpack_require__(11);const{Elm:Elm}=__webpack_require__(12),debug="#debug"===location.hash,app=Elm.Main.init({node:document.getElementById("main"),flags:{debug:debug}});(new Image).src="img/riding-train.jpg";app.ports.persistListReq.subscribe((()=>{let saves=Object.entries(localStorage).filter((([k,v])=>k.startsWith("persist-"))).sort((([k1,v1],[k2,v2])=>JSON.parse(v2).timestamp-JSON.parse(v1).timestamp)).map((([k,v])=>k.slice(8)));app.ports.persistListRes.send([(new Date).toUTCString(),saves])})),app.ports.persistLoadReq.subscribe((key=>{let{history:history}=JSON.parse(localStorage.getItem("persist-"+key))||{history:[]};history&&setTimeout((()=>app.ports.persistLoadRes.send(history)),100)})),app.ports.persistSaveReq.subscribe((([key,value])=>{localStorage.setItem("persist-"+key,JSON.stringify({timestamp:Date.now(),history:value})),app.ports.persistListChanged.send(null)})),app.ports.persistDeleteReq.subscribe((key=>{localStorage.removeItem("persist-"+key),app.ports.persistListChanged.send(null)})),app.ports.playSound.subscribe((key=>{loadedSounds[key].play()}));let loopStart,currentLoop,nextLoop,dramaVolume=0;const loopLengths={1:8e4,2:8e4,3:8e4,4:5e4};function checkLoop(){Date.now()>loopStart+loopLengths[currentLoop]?loop():requestAnimationFrame(checkLoop)}function loop(){currentLoop!==nextLoop&&(dramaVolume=0),currentLoop=nextLoop,loadedSounds[`music/${currentLoop}l`].play(),loadedSounds[`music/${currentLoop}d`].volume(dramaVolume),loadedSounds[`music/${currentLoop}d`].play(),loopStart=Date.now(),requestAnimationFrame(checkLoop)}app.ports.queueLoopReq.subscribe((key=>{nextLoop=key,currentLoop||loop()})),app.ports.stopSound.subscribe((key=>{let v=loadedSounds[key].volume();loadedSounds[key].fade(v,0,1e3).once("fade",(()=>loadedSounds[key].stop().volume(v)))})),app.ports.stopMusic.subscribe((()=>{currentLoop&&(loadedSounds[`music/${currentLoop}l`].stop(),loadedSounds[`music/${currentLoop}d`].stop(),loadedSounds[`music/${currentLoop}d`].volume(0),dramaVolume=0,currentLoop=null,nextLoop=null,loopStart=null)})),app.ports.addDramaReq.subscribe((()=>{currentLoop&&(dramaVolume=1,loadedSounds[`music/${currentLoop}d`].fade(0,1,1e3))})),app.ports.removeDramaReq.subscribe((()=>{currentLoop&&(dramaVolume=0,loadedSounds[`music/${currentLoop}d`].fade(1,0,1e3))}));var totalAssetsToLoad=0,numAssetsLoaded=0;const progressBarEl=document.getElementById("loading-progress");function assetLoaded(){numAssetsLoaded++,progressBarEl.value=numAssetsLoaded/totalAssetsToLoad,progressBarEl.innerText=numAssetsLoaded/totalAssetsToLoad,numAssetsLoaded===totalAssetsToLoad&&app.ports.assetsLoaded.send(!0)}__webpack_require__(14).keys().map((function(path){totalAssetsToLoad++;var img=new Image;return img.src="img/"+path,img.onload=assetLoaded,img}));const loadedSounds={},audoPrefix="audio/";Object.entries({"music/1d":{exts:["mp3","ogg"],waitForLoad:!0},"music/1l":{exts:["mp3","ogg"],waitForLoad:!0},"music/2d":{exts:["mp3","ogg"]},"music/2l":{exts:["mp3","ogg"]},"music/3d":{exts:["mp3","ogg"]},"music/3l":{exts:["mp3","ogg"]},"music/4d":{exts:["mp3"]},"music/4l":{exts:["mp3"]},"sfx/subway_ambient_loop":{exts:["wav"],waitForLoad:!0,loop:!0,volume:.4},"sfx/subway_arrival":{exts:["wav"],volume:.7},"sfx/subway_arrival2":{exts:["wav"]},"sfx/subway_departure":{exts:["wav"],waitForLoad:!0},"sfx/subway_whistle":{exts:["wav"],waitForLoad:!0,volume:.5},"sfx/ambience_crowd_loop":{exts:["ogg"],loop:!0,volume:.7}}).forEach((function([key,{waitForLoad:waitForLoad,exts:exts,loop:loop,volume:volume}]){waitForLoad&&totalAssetsToLoad++;let sound=new Howl({src:exts.map((ext=>audoPrefix+key+"."+ext)),loop:loop||!1,volume:volume||1});waitForLoad&&sound.once("load",assetLoaded.bind(null,{target:{src:key}}));loadedSounds[key]=sound}));const GENERATE_TOKEN_URL="/get_token",scenePrefix="workspaces/deadline/scenes/";let inworld,talkingTo="";async function src_generateSessionToken(){return(await fetch(GENERATE_TOKEN_URL)).json()}function startInworldScene(scene){const inworld_client=(new inworld_client_InworldClient).setConfiguration({capabilities:{audio:!1}}).setUser({fullName:"Steve"}).setScene(scenePrefix+scene).setGenerateSessionToken(src_generateSessionToken).setOnError((err=>{switch(err.code){case 10:case 1:break;default:console.error("inworld error",err)}})).setOnMessage((msg=>{msg.isText()?app.ports.promptResponse.send({id:talkingTo,response:msg.text.text}):msg.isInteractionEnd()||console.debug("Unknown inworld message",msg)}));inworld=inworld_client.build(),inworld.getCurrentCharacter(),window.inworld=inworld}app.ports.sendPrompt.subscribe((async([id,prompt])=>{if(talkingTo!==id){const character=(await inworld.getCharacters()).find((c=>c.getResourceName()==="workspaces/deadline/characters/"+id));character?(talkingTo=id,inworld.setCurrentCharacter(character)):console.error("could not find character","workspaces/deadline/characters/"+id)}inworld.sendText(prompt)})),app.ports.sendTrigger.subscribe((async id=>inworld.sendTrigger(id))),app.ports.changeScene.subscribe((async id=>{startInworldScene(id)})),startInworldScene("east_mulberry_subway_station"),document.addEventListener("keydown",(function(e){"INPUT"!=e.target.tagName&&app.ports.keyPress.send(e.key)," "!=e.key&&"Backspace"!==e.key||!e.target.tagName in["INPUT","TEXTAREA"]&&e.preventDefault()}));"1681948413916"!==localStorage.getItem("version")&&alert("Hi, thanks for playing Deadline!  Just to let you know, more content has been added since you last played.\n\nYou can use the Notebook to reload an earlier save point if you like."),localStorage.setItem("version","1681948413916"),app.ports.trackEvent.subscribe((async id=>{console.log("tracking",id),window.goatcounter.count({path:id,event:!0})}))}]);